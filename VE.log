
------- NEW MAP RUN STARTED -------

Date: 2026-01-24 12:06:03.547537

Elimination order heuristic used: Contained in fewest factors first

Non-MAP Elimination Order: ['Alarm', 'Leaving', 'Fire']

MAP Elimination ORder: ['Report', 'Tampering']

Elimination Order: ['Alarm', 'Leaving', 'Fire', 'Report', 'Tampering']

MAP Variables: ['Tampering', 'Report']

Observed Variables: {'Smoke': '1'}

Original Factors: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Factors with evidence applied: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

Result of multiplication: 

	   Alarm Fire Tampering Leaving      prob
	0      0    0         0       0  0.998900
	1      0    0         0       1  0.001000
	2      1    0         0       0  0.000012
	3      1    0         0       1  0.000088
	4      0    0         1       0  0.149850
	5      0    0         1       1  0.000150
	6      1    0         1       0  0.102000
	7      1    0         1       1  0.748000
	8      0    1         0       0  0.009990
	9      0    1         0       1  0.000010
	10     1    1         0       0  0.118800
	11     1    1         0       1  0.871200
	12     0    1         1       0  0.499500
	13     0    1         1       1  0.000500
	14     1    1         1       0  0.060000
	15     1    1         1       1  0.440000

Sum out Alarm

	  Fire Tampering Leaving      prob
	0    0         0       0  0.998912
	1    0         0       1  0.001088
	2    0         1       0  0.251850
	3    0         1       1  0.748150
	4    1         0       0  0.128790
	5    1         0       1  0.871210
	6    1         1       0  0.559500
	7    1         1       1  0.440500

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire Tampering Leaving      prob
	0    0         0       0  0.998912
	1    0         0       1  0.001088
	2    0         1       0  0.251850
	3    0         1       1  0.748150
	4    1         0       0  0.128790
	5    1         0       1  0.871210
	6    1         1       0  0.559500
	7    1         1       1  0.440500

Eliminate variable: Leaving

Factors to multiply containing variable: Leaving

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Fire Tampering Leaving      prob
	0    0         0       0  0.998912
	1    0         0       1  0.001088
	2    0         1       0  0.251850
	3    0         1       1  0.748150
	4    1         0       0  0.128790
	5    1         0       1  0.871210
	6    1         1       0  0.559500
	7    1         1       1  0.440500

Result of multiplication: 

	   Fire Report Tampering Leaving      prob
	0     0      0         0       0  0.988923
	1     0      0         1       0  0.249331
	2     1      0         0       0  0.127502
	3     1      0         1       0  0.553905
	4     0      1         0       0  0.009989
	5     0      1         1       0  0.002518
	6     1      1         0       0  0.001288
	7     1      1         1       0  0.005595
	8     0      0         0       1  0.000272
	9     0      0         1       1  0.187037
	10    1      0         0       1  0.217802
	11    1      0         1       1  0.110125
	12    0      1         0       1  0.000816
	13    0      1         1       1  0.561113
	14    1      1         0       1  0.653407
	15    1      1         1       1  0.330375

Sum out Leaving

	  Fire Report Tampering      prob
	0    0      0         0  0.989195
	1    0      0         1  0.436369
	2    0      1         0  0.010805
	3    0      1         1  0.563631
	4    1      0         0  0.345305
	5    1      0         1  0.664030
	6    1      1         0  0.654695
	7    1      1         1  0.335970

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire Report Tampering      prob
	0    0      0         0  0.989195
	1    0      0         1  0.436369
	2    0      1         0  0.010805
	3    0      1         1  0.563631
	4    1      0         0  0.345305
	5    1      0         1  0.664030
	6    1      1         0  0.654695
	7    1      1         1  0.335970

Eliminate variable: Fire

Factors to multiply containing variable: Fire

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Fire Report Tampering      prob
	0    0      0         0  0.989195
	1    0      0         1  0.436369
	2    0      1         0  0.010805
	3    0      1         1  0.563631
	4    1      0         0  0.345305
	5    1      0         1  0.664030
	6    1      1         0  0.654695
	7    1      1         1  0.335970

Result of multiplication: 

	  Fire Tampering Report      prob
	0    0         0      0  0.009793
	1    0         1      0  0.004320
	2    0         0      1  0.000107
	3    0         1      1  0.005580
	4    1         0      0  0.003108
	5    1         1      0  0.005976
	6    1         0      1  0.005892
	7    1         1      1  0.003024

Sum out Fire

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Eliminate variable: Report

Factors to multiply containing variable: Report

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Result of multiplication: 

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Storing factor for backtracking to find value of Report

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Maximise out Report

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

Eliminate variable: Tampering

Factors to multiply containing variable: Tampering

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

Result of multiplication: 

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Storing factor for backtracking to find value of Tampering

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

New List of Factors: 

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Finding MAP instantiation for Tampering

MAP assignment for variable Tampering is 0

Popped this factor from the backtracking stack:

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Finding MAP instantiation for Report

MAP assignment for variable Report is 0

Final Map Instantiation:

Tampering->0

Report->0

{'Network': 'Networks/alarm.bif', 'MAP Variables': ['Tampering', 'Report'], 'Evidence': {'Smoke': '1'}, 'Instantiation': {'Tampering': '0', 'Report': '0'}}

Elimination Order: ['Alarm', 'Leaving', 'Fire', 'Report', 'Tampering']

MAP Variables: ['Tampering', 'Report']

Observed Variables: {'Smoke': '1'}

Original Factors: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Factors with evidence applied: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

Result of multiplication: 

	   Fire Alarm Tampering Leaving      prob
	0     0     0         0       0  0.998900
	1     0     0         0       1  0.001000
	2     0     1         0       0  0.000012
	3     0     1         0       1  0.000088
	4     0     0         1       0  0.149850
	5     0     0         1       1  0.000150
	6     0     1         1       0  0.102000
	7     0     1         1       1  0.748000
	8     1     0         0       0  0.009990
	9     1     0         0       1  0.000010
	10    1     1         0       0  0.118800
	11    1     1         0       1  0.871200
	12    1     0         1       0  0.499500
	13    1     0         1       1  0.000500
	14    1     1         1       0  0.060000
	15    1     1         1       1  0.440000

Sum out Alarm

	  Fire Tampering Leaving      prob
	0    0         0       0  0.998912
	1    0         0       1  0.001088
	2    0         1       0  0.251850
	3    0         1       1  0.748150
	4    1         0       0  0.128790
	5    1         0       1  0.871210
	6    1         1       0  0.559500
	7    1         1       1  0.440500

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire Tampering Leaving      prob
	0    0         0       0  0.998912
	1    0         0       1  0.001088
	2    0         1       0  0.251850
	3    0         1       1  0.748150
	4    1         0       0  0.128790
	5    1         0       1  0.871210
	6    1         1       0  0.559500
	7    1         1       1  0.440500

Eliminate variable: Leaving

Factors to multiply containing variable: Leaving

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Fire Tampering Leaving      prob
	0    0         0       0  0.998912
	1    0         0       1  0.001088
	2    0         1       0  0.251850
	3    0         1       1  0.748150
	4    1         0       0  0.128790
	5    1         0       1  0.871210
	6    1         1       0  0.559500
	7    1         1       1  0.440500

Result of multiplication: 

	   Report Fire Tampering Leaving      prob
	0       0    0         0       0  0.988923
	1       0    0         1       0  0.249331
	2       0    1         0       0  0.127502
	3       0    1         1       0  0.553905
	4       1    0         0       0  0.009989
	5       1    0         1       0  0.002518
	6       1    1         0       0  0.001288
	7       1    1         1       0  0.005595
	8       0    0         0       1  0.000272
	9       0    0         1       1  0.187037
	10      0    1         0       1  0.217802
	11      0    1         1       1  0.110125
	12      1    0         0       1  0.000816
	13      1    0         1       1  0.561113
	14      1    1         0       1  0.653407
	15      1    1         1       1  0.330375

Sum out Leaving

	  Report Fire Tampering      prob
	0      0    0         0  0.989195
	1      0    0         1  0.436369
	2      0    1         0  0.345305
	3      0    1         1  0.664030
	4      1    0         0  0.010805
	5      1    0         1  0.563631
	6      1    1         0  0.654695
	7      1    1         1  0.335970

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Report Fire Tampering      prob
	0      0    0         0  0.989195
	1      0    0         1  0.436369
	2      0    1         0  0.345305
	3      0    1         1  0.664030
	4      1    0         0  0.010805
	5      1    0         1  0.563631
	6      1    1         0  0.654695
	7      1    1         1  0.335970

Eliminate variable: Fire

Factors to multiply containing variable: Fire

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Report Fire Tampering      prob
	0      0    0         0  0.989195
	1      0    0         1  0.436369
	2      0    1         0  0.345305
	3      0    1         1  0.664030
	4      1    0         0  0.010805
	5      1    0         1  0.563631
	6      1    1         0  0.654695
	7      1    1         1  0.335970

Result of multiplication: 

	  Report Fire Tampering      prob
	0      0    0         0  0.009793
	1      0    0         1  0.004320
	2      1    0         0  0.000107
	3      1    0         1  0.005580
	4      0    1         0  0.003108
	5      0    1         1  0.005976
	6      1    1         0  0.005892
	7      1    1         1  0.003024

Sum out Fire

	  Report Tampering      prob
	0      0         0  0.012901
	1      0         1  0.010296
	2      1         0  0.005999
	3      1         1  0.008604

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Report Tampering      prob
	0      0         0  0.012901
	1      0         1  0.010296
	2      1         0  0.005999
	3      1         1  0.008604

Eliminate variable: Report

Factors to multiply containing variable: Report

	  Report Tampering      prob
	0      0         0  0.012901
	1      0         1  0.010296
	2      1         0  0.005999
	3      1         1  0.008604

Result of multiplication: 

	  Report Tampering      prob
	0      0         0  0.012901
	1      0         1  0.010296
	2      1         0  0.005999
	3      1         1  0.008604

Storing factor for backtracking to find value of Report

	  Report Tampering      prob
	0      0         0  0.012901
	1      0         1  0.010296
	2      1         0  0.005999
	3      1         1  0.008604

Maximise out Report

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

Eliminate variable: Tampering

Factors to multiply containing variable: Tampering

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

Result of multiplication: 

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Storing factor for backtracking to find value of Tampering

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

New List of Factors: 

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Finding MAP instantiation for Tampering

MAP assignment for variable Tampering is 0

Popped this factor from the backtracking stack:

	  Report Tampering      prob
	0      0         0  0.012901
	1      0         1  0.010296
	2      1         0  0.005999
	3      1         1  0.008604

Finding MAP instantiation for Report

MAP assignment for variable Report is 0

Final Map Instantiation:

Tampering->0

Report->0

Elimination Order: ['Smoke', 'Alarm', 'Leaving', 'Fire', 'Report', 'Tampering']

MAP Variables: ['Tampering', 'Report']

Observed Variables: {}

Original Factors: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Factors with evidence applied: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Eliminate variable: Smoke

Factors to multiply containing variable: Smoke

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

Result of multiplication: 

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

Sum out Smoke

	  Fire  prob
	0    0   1.0
	1    1   1.0

New List of Factors: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire  prob
	0    0   1.0
	1    1   1.0

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

Result of multiplication: 

	   Fire Alarm Tampering Leaving      prob
	0     0     0         0       0  0.998900
	1     0     0         0       1  0.001000
	2     0     1         0       0  0.000012
	3     0     1         0       1  0.000088
	4     0     0         1       0  0.149850
	5     0     0         1       1  0.000150
	6     0     1         1       0  0.102000
	7     0     1         1       1  0.748000
	8     1     0         0       0  0.009990
	9     1     0         0       1  0.000010
	10    1     1         0       0  0.118800
	11    1     1         0       1  0.871200
	12    1     0         1       0  0.499500
	13    1     0         1       1  0.000500
	14    1     1         1       0  0.060000
	15    1     1         1       1  0.440000

Sum out Alarm

	  Fire Tampering Leaving      prob
	0    0         0       0  0.998912
	1    0         0       1  0.001088
	2    0         1       0  0.251850
	3    0         1       1  0.748150
	4    1         0       0  0.128790
	5    1         0       1  0.871210
	6    1         1       0  0.559500
	7    1         1       1  0.440500

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire  prob
	0    0   1.0
	1    1   1.0

	  Fire Tampering Leaving      prob
	0    0         0       0  0.998912
	1    0         0       1  0.001088
	2    0         1       0  0.251850
	3    0         1       1  0.748150
	4    1         0       0  0.128790
	5    1         0       1  0.871210
	6    1         1       0  0.559500
	7    1         1       1  0.440500

Eliminate variable: Leaving

Factors to multiply containing variable: Leaving

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Fire Tampering Leaving      prob
	0    0         0       0  0.998912
	1    0         0       1  0.001088
	2    0         1       0  0.251850
	3    0         1       1  0.748150
	4    1         0       0  0.128790
	5    1         0       1  0.871210
	6    1         1       0  0.559500
	7    1         1       1  0.440500

Result of multiplication: 

	   Report Fire Tampering Leaving      prob
	0       0    0         0       0  0.988923
	1       0    0         1       0  0.249331
	2       0    1         0       0  0.127502
	3       0    1         1       0  0.553905
	4       1    0         0       0  0.009989
	5       1    0         1       0  0.002518
	6       1    1         0       0  0.001288
	7       1    1         1       0  0.005595
	8       0    0         0       1  0.000272
	9       0    0         1       1  0.187037
	10      0    1         0       1  0.217802
	11      0    1         1       1  0.110125
	12      1    0         0       1  0.000816
	13      1    0         1       1  0.561113
	14      1    1         0       1  0.653407
	15      1    1         1       1  0.330375

Sum out Leaving

	  Report Fire Tampering      prob
	0      0    0         0  0.989195
	1      0    0         1  0.436369
	2      0    1         0  0.345305
	3      0    1         1  0.664030
	4      1    0         0  0.010805
	5      1    0         1  0.563631
	6      1    1         0  0.654695
	7      1    1         1  0.335970

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire  prob
	0    0   1.0
	1    1   1.0

	  Report Fire Tampering      prob
	0      0    0         0  0.989195
	1      0    0         1  0.436369
	2      0    1         0  0.345305
	3      0    1         1  0.664030
	4      1    0         0  0.010805
	5      1    0         1  0.563631
	6      1    1         0  0.654695
	7      1    1         1  0.335970

Eliminate variable: Fire

Factors to multiply containing variable: Fire

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	0    0   1.0
	1    1   1.0

	  Report Fire Tampering      prob
	0      0    0         0  0.989195
	1      0    0         1  0.436369
	2      0    1         0  0.345305
	3      0    1         1  0.664030
	4      1    0         0  0.010805
	5      1    0         1  0.563631
	6      1    1         0  0.654695
	7      1    1         1  0.335970

Result of multiplication: 

	  Report Fire Tampering      prob
	0      0    0         0  0.979303
	1      0    0         1  0.432005
	2      1    0         0  0.010697
	3      1    0         1  0.557995
	4      0    1         0  0.003453
	5      0    1         1  0.006640
	6      1    1         0  0.006547
	7      1    1         1  0.003360

Sum out Fire

	  Report Tampering      prob
	0      0         0  0.982756
	1      0         1  0.438646
	2      1         0  0.017244
	3      1         1  0.561354

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Report Tampering      prob
	0      0         0  0.982756
	1      0         1  0.438646
	2      1         0  0.017244
	3      1         1  0.561354

Eliminate variable: Report

Factors to multiply containing variable: Report

	  Report Tampering      prob
	0      0         0  0.982756
	1      0         1  0.438646
	2      1         0  0.017244
	3      1         1  0.561354

Result of multiplication: 

	  Report Tampering      prob
	0      0         0  0.982756
	1      0         1  0.438646
	2      1         0  0.017244
	3      1         1  0.561354

Storing factor for backtracking to find value of Report

	  Report Tampering      prob
	0      0         0  0.982756
	1      0         1  0.438646
	2      1         0  0.017244
	3      1         1  0.561354

Maximise out Report

	  Tampering      prob
	0         0  0.982756
	1         1  0.561354

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.982756
	1         1  0.561354

Eliminate variable: Tampering

Factors to multiply containing variable: Tampering

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.982756
	1         1  0.561354

Result of multiplication: 

	  Tampering      prob
	0         0  0.963101
	1         1  0.011227

Storing factor for backtracking to find value of Tampering

	  Tampering      prob
	0         0  0.963101
	1         1  0.011227

New List of Factors: 

	  Tampering      prob
	0         0  0.963101
	1         1  0.011227

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	  Tampering      prob
	0         0  0.963101
	1         1  0.011227

Finding MAP instantiation for Tampering

MAP assignment for variable Tampering is 0

Popped this factor from the backtracking stack:

	  Report Tampering      prob
	0      0         0  0.982756
	1      0         1  0.438646
	2      1         0  0.017244
	3      1         1  0.561354

Finding MAP instantiation for Report

MAP assignment for variable Report is 0

Final Map Instantiation:

Tampering->0

Report->0

Elimination Order: ['Report', 'Smoke', 'Tampering', 'JohnCalls', 'MaryCalls', 'Fire', 'Leaving', 'Earthquake', 'Alarm']

MAP Variables: ['Alarm']

Observed Variables: {'Burglary': 'True'}

Original Factors: 

	   Alarm Burglary Earthquake   prob
	0   True     True       True  0.950
	1  False     True       True  0.050
	2   True    False       True  0.290
	3  False    False       True  0.710
	4   True     True      False  0.940
	5  False     True      False  0.060
	6   True    False      False  0.001
	7  False    False      False  0.999

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Burglary  prob
	0     True  0.01
	1    False  0.99

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Factors with evidence applied: 

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Eliminate variable: Report

Factors to multiply containing variable: Report

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

Result of multiplication: 

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

Sum out Report

	  Leaving  prob
	0       0   1.0
	1       1   1.0

New List of Factors: 

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

	  Leaving  prob
	0       0   1.0
	1       1   1.0

Eliminate variable: Smoke

Factors to multiply containing variable: Smoke

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

Result of multiplication: 

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

Sum out Smoke

	  Fire  prob
	0    0   1.0
	1    1   1.0

New List of Factors: 

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

	  Leaving  prob
	0       0   1.0
	1       1   1.0

	  Fire  prob
	0    0   1.0
	1    1   1.0

Eliminate variable: Tampering

Factors to multiply containing variable: Tampering

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Result of multiplication: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Elimination Order: ['Report', 'Smoke', 'Tampering', 'JohnCalls', 'MaryCalls', 'Fire', 'Leaving', 'Earthquake', 'Alarm']

MAP Variables: ['Alarm']

Observed Variables: {'Burglary': 'False'}

Original Factors: 

	   Alarm Burglary Earthquake   prob
	0   True     True       True  0.950
	1  False     True       True  0.050
	2   True    False       True  0.290
	3  False    False       True  0.710
	4   True     True      False  0.940
	5  False     True      False  0.060
	6   True    False      False  0.001
	7  False    False      False  0.999

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Burglary  prob
	0     True  0.01
	1    False  0.99

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Factors with evidence applied: 

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Eliminate variable: Report

Factors to multiply containing variable: Report

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

Result of multiplication: 

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

Sum out Report

	  Leaving  prob
	0       0   1.0
	1       1   1.0

New List of Factors: 

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

	  Leaving  prob
	0       0   1.0
	1       1   1.0

Eliminate variable: Smoke

Factors to multiply containing variable: Smoke

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

Result of multiplication: 

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

Sum out Smoke

	  Fire  prob
	0    0   1.0
	1    1   1.0

New List of Factors: 

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

	  Leaving  prob
	0       0   1.0
	1       1   1.0

	  Fire  prob
	0    0   1.0
	1    1   1.0

Eliminate variable: Tampering

Factors to multiply containing variable: Tampering

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Result of multiplication: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Elimination Order: ['Alarm', 'Leaving', 'Fire', 'Report', 'Tampering']

MAP Variables: ['Tampering', 'Report']

Observed Variables: {'Smoke': '1'}

Original Factors: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Factors with evidence applied: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

Result of multiplication: 

	   Leaving Alarm Tampering Fire      prob
	0        0     0         0    0  0.998900
	1        1     0         0    0  0.001000
	2        0     1         0    0  0.000012
	3        1     1         0    0  0.000088
	4        0     0         1    0  0.149850
	5        1     0         1    0  0.000150
	6        0     1         1    0  0.102000
	7        1     1         1    0  0.748000
	8        0     0         0    1  0.009990
	9        1     0         0    1  0.000010
	10       0     1         0    1  0.118800
	11       1     1         0    1  0.871200
	12       0     0         1    1  0.499500
	13       1     0         1    1  0.000500
	14       0     1         1    1  0.060000
	15       1     1         1    1  0.440000

Sum out Alarm

	  Leaving Tampering Fire      prob
	0       0         0    0  0.998912
	1       0         0    1  0.128790
	2       0         1    0  0.251850
	3       0         1    1  0.559500
	4       1         0    0  0.001088
	5       1         0    1  0.871210
	6       1         1    0  0.748150
	7       1         1    1  0.440500

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Leaving Tampering Fire      prob
	0       0         0    0  0.998912
	1       0         0    1  0.128790
	2       0         1    0  0.251850
	3       0         1    1  0.559500
	4       1         0    0  0.001088
	5       1         0    1  0.871210
	6       1         1    0  0.748150
	7       1         1    1  0.440500

Eliminate variable: Leaving

Factors to multiply containing variable: Leaving

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Leaving Tampering Fire      prob
	0       0         0    0  0.998912
	1       0         0    1  0.128790
	2       0         1    0  0.251850
	3       0         1    1  0.559500
	4       1         0    0  0.001088
	5       1         0    1  0.871210
	6       1         1    0  0.748150
	7       1         1    1  0.440500

Result of multiplication: 

	   Report Tampering Leaving Fire      prob
	0       0         0       0    0  0.988923
	1       0         0       0    1  0.127502
	2       0         1       0    0  0.249331
	3       0         1       0    1  0.553905
	4       1         0       0    0  0.009989
	5       1         0       0    1  0.001288
	6       1         1       0    0  0.002518
	7       1         1       0    1  0.005595
	8       0         0       1    0  0.000272
	9       0         0       1    1  0.217802
	10      0         1       1    0  0.187037
	11      0         1       1    1  0.110125
	12      1         0       1    0  0.000816
	13      1         0       1    1  0.653407
	14      1         1       1    0  0.561113
	15      1         1       1    1  0.330375

Sum out Leaving

	  Report Tampering Fire      prob
	0      0         0    0  0.989195
	1      0         0    1  0.345305
	2      0         1    0  0.436369
	3      0         1    1  0.664030
	4      1         0    0  0.010805
	5      1         0    1  0.654695
	6      1         1    0  0.563631
	7      1         1    1  0.335970

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Report Tampering Fire      prob
	0      0         0    0  0.989195
	1      0         0    1  0.345305
	2      0         1    0  0.436369
	3      0         1    1  0.664030
	4      1         0    0  0.010805
	5      1         0    1  0.654695
	6      1         1    0  0.563631
	7      1         1    1  0.335970

Eliminate variable: Fire

Factors to multiply containing variable: Fire

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Report Tampering Fire      prob
	0      0         0    0  0.989195
	1      0         0    1  0.345305
	2      0         1    0  0.436369
	3      0         1    1  0.664030
	4      1         0    0  0.010805
	5      1         0    1  0.654695
	6      1         1    0  0.563631
	7      1         1    1  0.335970

Result of multiplication: 

	  Report Tampering Fire      prob
	0      0         0    0  0.009793
	1      0         1    0  0.004320
	2      1         0    0  0.000107
	3      1         1    0  0.005580
	4      0         0    1  0.003108
	5      0         1    1  0.005976
	6      1         0    1  0.005892
	7      1         1    1  0.003024

Sum out Fire

	  Report Tampering      prob
	0      0         0  0.012901
	1      0         1  0.010296
	2      1         0  0.005999
	3      1         1  0.008604

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Report Tampering      prob
	0      0         0  0.012901
	1      0         1  0.010296
	2      1         0  0.005999
	3      1         1  0.008604

Eliminate variable: Report

Factors to multiply containing variable: Report

	  Report Tampering      prob
	0      0         0  0.012901
	1      0         1  0.010296
	2      1         0  0.005999
	3      1         1  0.008604

Result of multiplication: 

	  Report Tampering      prob
	0      0         0  0.012901
	1      0         1  0.010296
	2      1         0  0.005999
	3      1         1  0.008604

Storing factor for backtracking to find value of Report

	  Report Tampering      prob
	0      0         0  0.012901
	1      0         1  0.010296
	2      1         0  0.005999
	3      1         1  0.008604

Maximise out Report

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

Eliminate variable: Tampering

Factors to multiply containing variable: Tampering

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

Result of multiplication: 

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Storing factor for backtracking to find value of Tampering

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

New List of Factors: 

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Finding MAP instantiation for Tampering

MAP assignment for variable Tampering is 0

Popped this factor from the backtracking stack:

	  Report Tampering      prob
	0      0         0  0.012901
	1      0         1  0.010296
	2      1         0  0.005999
	3      1         1  0.008604

Finding MAP instantiation for Report

MAP assignment for variable Report is 0

Final Map Instantiation:

Tampering->0

Report->0

Elimination Order: ['Smoke', 'Alarm', 'Leaving', 'Fire', 'Report', 'Tampering']

MAP Variables: ['Tampering', 'Report']

Observed Variables: {}

Original Factors: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Factors with evidence applied: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Eliminate variable: Smoke

Factors to multiply containing variable: Smoke

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

Result of multiplication: 

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

Sum out Smoke

	  Fire  prob
	0    0   1.0
	1    1   1.0

New List of Factors: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire  prob
	0    0   1.0
	1    1   1.0

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

Result of multiplication: 

	   Leaving Alarm Tampering Fire      prob
	0        0     0         0    0  0.998900
	1        1     0         0    0  0.001000
	2        0     1         0    0  0.000012
	3        1     1         0    0  0.000088
	4        0     0         1    0  0.149850
	5        1     0         1    0  0.000150
	6        0     1         1    0  0.102000
	7        1     1         1    0  0.748000
	8        0     0         0    1  0.009990
	9        1     0         0    1  0.000010
	10       0     1         0    1  0.118800
	11       1     1         0    1  0.871200
	12       0     0         1    1  0.499500
	13       1     0         1    1  0.000500
	14       0     1         1    1  0.060000
	15       1     1         1    1  0.440000

Sum out Alarm

	  Leaving Tampering Fire      prob
	0       0         0    0  0.998912
	1       0         0    1  0.128790
	2       0         1    0  0.251850
	3       0         1    1  0.559500
	4       1         0    0  0.001088
	5       1         0    1  0.871210
	6       1         1    0  0.748150
	7       1         1    1  0.440500

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire  prob
	0    0   1.0
	1    1   1.0

	  Leaving Tampering Fire      prob
	0       0         0    0  0.998912
	1       0         0    1  0.128790
	2       0         1    0  0.251850
	3       0         1    1  0.559500
	4       1         0    0  0.001088
	5       1         0    1  0.871210
	6       1         1    0  0.748150
	7       1         1    1  0.440500

Eliminate variable: Leaving

Factors to multiply containing variable: Leaving

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Leaving Tampering Fire      prob
	0       0         0    0  0.998912
	1       0         0    1  0.128790
	2       0         1    0  0.251850
	3       0         1    1  0.559500
	4       1         0    0  0.001088
	5       1         0    1  0.871210
	6       1         1    0  0.748150
	7       1         1    1  0.440500

Result of multiplication: 

	   Report Tampering Leaving Fire      prob
	0       0         0       0    0  0.988923
	1       0         0       0    1  0.127502
	2       0         1       0    0  0.249331
	3       0         1       0    1  0.553905
	4       1         0       0    0  0.009989
	5       1         0       0    1  0.001288
	6       1         1       0    0  0.002518
	7       1         1       0    1  0.005595
	8       0         0       1    0  0.000272
	9       0         0       1    1  0.217802
	10      0         1       1    0  0.187037
	11      0         1       1    1  0.110125
	12      1         0       1    0  0.000816
	13      1         0       1    1  0.653407
	14      1         1       1    0  0.561113
	15      1         1       1    1  0.330375

Sum out Leaving

	  Report Tampering Fire      prob
	0      0         0    0  0.989195
	1      0         0    1  0.345305
	2      0         1    0  0.436369
	3      0         1    1  0.664030
	4      1         0    0  0.010805
	5      1         0    1  0.654695
	6      1         1    0  0.563631
	7      1         1    1  0.335970

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire  prob
	0    0   1.0
	1    1   1.0

	  Report Tampering Fire      prob
	0      0         0    0  0.989195
	1      0         0    1  0.345305
	2      0         1    0  0.436369
	3      0         1    1  0.664030
	4      1         0    0  0.010805
	5      1         0    1  0.654695
	6      1         1    0  0.563631
	7      1         1    1  0.335970

Eliminate variable: Fire

Factors to multiply containing variable: Fire

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	0    0   1.0
	1    1   1.0

	  Report Tampering Fire      prob
	0      0         0    0  0.989195
	1      0         0    1  0.345305
	2      0         1    0  0.436369
	3      0         1    1  0.664030
	4      1         0    0  0.010805
	5      1         0    1  0.654695
	6      1         1    0  0.563631
	7      1         1    1  0.335970

Result of multiplication: 

	  Report Tampering Fire      prob
	0      0         0    0  0.979303
	1      0         1    0  0.432005
	2      1         0    0  0.010697
	3      1         1    0  0.557995
	4      0         0    1  0.003453
	5      0         1    1  0.006640
	6      1         0    1  0.006547
	7      1         1    1  0.003360

Sum out Fire

	  Report Tampering      prob
	0      0         0  0.982756
	1      0         1  0.438646
	2      1         0  0.017244
	3      1         1  0.561354

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Report Tampering      prob
	0      0         0  0.982756
	1      0         1  0.438646
	2      1         0  0.017244
	3      1         1  0.561354

Eliminate variable: Report

Factors to multiply containing variable: Report

	  Report Tampering      prob
	0      0         0  0.982756
	1      0         1  0.438646
	2      1         0  0.017244
	3      1         1  0.561354

Result of multiplication: 

	  Report Tampering      prob
	0      0         0  0.982756
	1      0         1  0.438646
	2      1         0  0.017244
	3      1         1  0.561354

Storing factor for backtracking to find value of Report

	  Report Tampering      prob
	0      0         0  0.982756
	1      0         1  0.438646
	2      1         0  0.017244
	3      1         1  0.561354

Maximise out Report

	  Tampering      prob
	0         0  0.982756
	1         1  0.561354

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.982756
	1         1  0.561354

Eliminate variable: Tampering

Factors to multiply containing variable: Tampering

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.982756
	1         1  0.561354

Result of multiplication: 

	  Tampering      prob
	0         0  0.963101
	1         1  0.011227

Storing factor for backtracking to find value of Tampering

	  Tampering      prob
	0         0  0.963101
	1         1  0.011227

New List of Factors: 

	  Tampering      prob
	0         0  0.963101
	1         1  0.011227

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	  Tampering      prob
	0         0  0.963101
	1         1  0.011227

Finding MAP instantiation for Tampering

MAP assignment for variable Tampering is 0

Popped this factor from the backtracking stack:

	  Report Tampering      prob
	0      0         0  0.982756
	1      0         1  0.438646
	2      1         0  0.017244
	3      1         1  0.561354

Finding MAP instantiation for Report

MAP assignment for variable Report is 0

Final Map Instantiation:

Tampering->0

Report->0

Elimination Order: ['Report', 'Smoke', 'Tampering', 'JohnCalls', 'MaryCalls', 'Fire', 'Leaving', 'Earthquake', 'Alarm']

MAP Variables: ['Alarm']

Observed Variables: {'Burglary': 'True'}

Original Factors: 

	   Alarm Burglary Earthquake   prob
	0   True     True       True  0.950
	1  False     True       True  0.050
	2   True    False       True  0.290
	3  False    False       True  0.710
	4   True     True      False  0.940
	5  False     True      False  0.060
	6   True    False      False  0.001
	7  False    False      False  0.999

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Burglary  prob
	0     True  0.01
	1    False  0.99

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Factors with evidence applied: 

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Eliminate variable: Report

Factors to multiply containing variable: Report

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

Result of multiplication: 

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

Sum out Report

	  Leaving  prob
	0       0   1.0
	1       1   1.0

New List of Factors: 

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

	  Leaving  prob
	0       0   1.0
	1       1   1.0

Eliminate variable: Smoke

Factors to multiply containing variable: Smoke

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

Result of multiplication: 

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

Sum out Smoke

	  Fire  prob
	0    0   1.0
	1    1   1.0

New List of Factors: 

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

	  Leaving  prob
	0       0   1.0
	1       1   1.0

	  Fire  prob
	0    0   1.0
	1    1   1.0

Eliminate variable: Tampering

Factors to multiply containing variable: Tampering

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Result of multiplication: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Elimination Order: ['Report', 'Smoke', 'Tampering', 'JohnCalls', 'MaryCalls', 'Fire', 'Leaving', 'Earthquake', 'Alarm']

MAP Variables: ['Alarm']

Observed Variables: {'Burglary': 'False'}

Original Factors: 

	   Alarm Burglary Earthquake   prob
	0   True     True       True  0.950
	1  False     True       True  0.050
	2   True    False       True  0.290
	3  False    False       True  0.710
	4   True     True      False  0.940
	5  False     True      False  0.060
	6   True    False      False  0.001
	7  False    False      False  0.999

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Burglary  prob
	0     True  0.01
	1    False  0.99

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Factors with evidence applied: 

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Eliminate variable: Report

Factors to multiply containing variable: Report

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

Result of multiplication: 

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

Sum out Report

	  Leaving  prob
	0       0   1.0
	1       1   1.0

New List of Factors: 

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

	  Leaving  prob
	0       0   1.0
	1       1   1.0

Eliminate variable: Smoke

Factors to multiply containing variable: Smoke

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

Result of multiplication: 

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

Sum out Smoke

	  Fire  prob
	0    0   1.0
	1    1   1.0

New List of Factors: 

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

	  Leaving  prob
	0       0   1.0
	1       1   1.0

	  Fire  prob
	0    0   1.0
	1    1   1.0

Eliminate variable: Tampering

Factors to multiply containing variable: Tampering

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Result of multiplication: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Elimination Order: ['Alarm', 'Leaving', 'Fire', 'Report', 'Tampering']

MAP Variables: ['Tampering', 'Report']

Observed Variables: {'Smoke': '1'}

Original Factors: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Factors with evidence applied: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

Result of multiplication: 

	   Alarm Leaving Fire Tampering      prob
	0      0       0    0         0  0.998900
	1      0       1    0         0  0.001000
	2      1       0    0         0  0.000012
	3      1       1    0         0  0.000088
	4      0       0    0         1  0.149850
	5      0       1    0         1  0.000150
	6      1       0    0         1  0.102000
	7      1       1    0         1  0.748000
	8      0       0    1         0  0.009990
	9      0       1    1         0  0.000010
	10     1       0    1         0  0.118800
	11     1       1    1         0  0.871200
	12     0       0    1         1  0.499500
	13     0       1    1         1  0.000500
	14     1       0    1         1  0.060000
	15     1       1    1         1  0.440000

Sum out Alarm

	  Leaving Fire Tampering      prob
	0       0    0         0  0.998912
	1       0    0         1  0.251850
	2       0    1         0  0.128790
	3       0    1         1  0.559500
	4       1    0         0  0.001088
	5       1    0         1  0.748150
	6       1    1         0  0.871210
	7       1    1         1  0.440500

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Leaving Fire Tampering      prob
	0       0    0         0  0.998912
	1       0    0         1  0.251850
	2       0    1         0  0.128790
	3       0    1         1  0.559500
	4       1    0         0  0.001088
	5       1    0         1  0.748150
	6       1    1         0  0.871210
	7       1    1         1  0.440500

Eliminate variable: Leaving

Factors to multiply containing variable: Leaving

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Leaving Fire Tampering      prob
	0       0    0         0  0.998912
	1       0    0         1  0.251850
	2       0    1         0  0.128790
	3       0    1         1  0.559500
	4       1    0         0  0.001088
	5       1    0         1  0.748150
	6       1    1         0  0.871210
	7       1    1         1  0.440500

Result of multiplication: 

	   Tampering Report Leaving Fire      prob
	0          0      0       0    0  0.988923
	1          1      0       0    0  0.249331
	2          0      0       0    1  0.127502
	3          1      0       0    1  0.553905
	4          0      1       0    0  0.009989
	5          1      1       0    0  0.002518
	6          0      1       0    1  0.001288
	7          1      1       0    1  0.005595
	8          0      0       1    0  0.000272
	9          1      0       1    0  0.187037
	10         0      0       1    1  0.217802
	11         1      0       1    1  0.110125
	12         0      1       1    0  0.000816
	13         1      1       1    0  0.561113
	14         0      1       1    1  0.653407
	15         1      1       1    1  0.330375

Sum out Leaving

	  Tampering Report Fire      prob
	0         0      0    0  0.989195
	1         0      0    1  0.345305
	2         0      1    0  0.010805
	3         0      1    1  0.654695
	4         1      0    0  0.436369
	5         1      0    1  0.664030
	6         1      1    0  0.563631
	7         1      1    1  0.335970

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering Report Fire      prob
	0         0      0    0  0.989195
	1         0      0    1  0.345305
	2         0      1    0  0.010805
	3         0      1    1  0.654695
	4         1      0    0  0.436369
	5         1      0    1  0.664030
	6         1      1    0  0.563631
	7         1      1    1  0.335970

Eliminate variable: Fire

Factors to multiply containing variable: Fire

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering Report Fire      prob
	0         0      0    0  0.989195
	1         0      0    1  0.345305
	2         0      1    0  0.010805
	3         0      1    1  0.654695
	4         1      0    0  0.436369
	5         1      0    1  0.664030
	6         1      1    0  0.563631
	7         1      1    1  0.335970

Result of multiplication: 

	  Tampering Report Fire      prob
	0         0      0    0  0.009793
	1         0      1    0  0.000107
	2         1      0    0  0.004320
	3         1      1    0  0.005580
	4         0      0    1  0.003108
	5         0      1    1  0.005892
	6         1      0    1  0.005976
	7         1      1    1  0.003024

Sum out Fire

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Eliminate variable: Report

Factors to multiply containing variable: Report

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Result of multiplication: 

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Storing factor for backtracking to find value of Report

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Maximise out Report

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

Eliminate variable: Tampering

Factors to multiply containing variable: Tampering

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

Result of multiplication: 

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Storing factor for backtracking to find value of Tampering

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

New List of Factors: 

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Finding MAP instantiation for Tampering

MAP assignment for variable Tampering is 0

Popped this factor from the backtracking stack:

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Finding MAP instantiation for Report

MAP assignment for variable Report is 0

Final Map Instantiation:

Tampering->0

Report->0

Elimination Order: ['Smoke', 'Alarm', 'Leaving', 'Fire', 'Report', 'Tampering']

MAP Variables: ['Tampering', 'Report']

Observed Variables: {}

Original Factors: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Factors with evidence applied: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Eliminate variable: Smoke

Factors to multiply containing variable: Smoke

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

Result of multiplication: 

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

Sum out Smoke

	  Fire  prob
	0    0   1.0
	1    1   1.0

New List of Factors: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire  prob
	0    0   1.0
	1    1   1.0

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

Result of multiplication: 

	   Alarm Leaving Fire Tampering      prob
	0      0       0    0         0  0.998900
	1      0       1    0         0  0.001000
	2      1       0    0         0  0.000012
	3      1       1    0         0  0.000088
	4      0       0    0         1  0.149850
	5      0       1    0         1  0.000150
	6      1       0    0         1  0.102000
	7      1       1    0         1  0.748000
	8      0       0    1         0  0.009990
	9      0       1    1         0  0.000010
	10     1       0    1         0  0.118800
	11     1       1    1         0  0.871200
	12     0       0    1         1  0.499500
	13     0       1    1         1  0.000500
	14     1       0    1         1  0.060000
	15     1       1    1         1  0.440000

Sum out Alarm

	  Leaving Fire Tampering      prob
	0       0    0         0  0.998912
	1       0    0         1  0.251850
	2       0    1         0  0.128790
	3       0    1         1  0.559500
	4       1    0         0  0.001088
	5       1    0         1  0.748150
	6       1    1         0  0.871210
	7       1    1         1  0.440500

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire  prob
	0    0   1.0
	1    1   1.0

	  Leaving Fire Tampering      prob
	0       0    0         0  0.998912
	1       0    0         1  0.251850
	2       0    1         0  0.128790
	3       0    1         1  0.559500
	4       1    0         0  0.001088
	5       1    0         1  0.748150
	6       1    1         0  0.871210
	7       1    1         1  0.440500

Eliminate variable: Leaving

Factors to multiply containing variable: Leaving

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Leaving Fire Tampering      prob
	0       0    0         0  0.998912
	1       0    0         1  0.251850
	2       0    1         0  0.128790
	3       0    1         1  0.559500
	4       1    0         0  0.001088
	5       1    0         1  0.748150
	6       1    1         0  0.871210
	7       1    1         1  0.440500

Result of multiplication: 

	   Tampering Report Leaving Fire      prob
	0          0      0       0    0  0.988923
	1          1      0       0    0  0.249331
	2          0      0       0    1  0.127502
	3          1      0       0    1  0.553905
	4          0      1       0    0  0.009989
	5          1      1       0    0  0.002518
	6          0      1       0    1  0.001288
	7          1      1       0    1  0.005595
	8          0      0       1    0  0.000272
	9          1      0       1    0  0.187037
	10         0      0       1    1  0.217802
	11         1      0       1    1  0.110125
	12         0      1       1    0  0.000816
	13         1      1       1    0  0.561113
	14         0      1       1    1  0.653407
	15         1      1       1    1  0.330375

Sum out Leaving

	  Tampering Report Fire      prob
	0         0      0    0  0.989195
	1         0      0    1  0.345305
	2         0      1    0  0.010805
	3         0      1    1  0.654695
	4         1      0    0  0.436369
	5         1      0    1  0.664030
	6         1      1    0  0.563631
	7         1      1    1  0.335970

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire  prob
	0    0   1.0
	1    1   1.0

	  Tampering Report Fire      prob
	0         0      0    0  0.989195
	1         0      0    1  0.345305
	2         0      1    0  0.010805
	3         0      1    1  0.654695
	4         1      0    0  0.436369
	5         1      0    1  0.664030
	6         1      1    0  0.563631
	7         1      1    1  0.335970

Eliminate variable: Fire

Factors to multiply containing variable: Fire

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	0    0   1.0
	1    1   1.0

	  Tampering Report Fire      prob
	0         0      0    0  0.989195
	1         0      0    1  0.345305
	2         0      1    0  0.010805
	3         0      1    1  0.654695
	4         1      0    0  0.436369
	5         1      0    1  0.664030
	6         1      1    0  0.563631
	7         1      1    1  0.335970

Result of multiplication: 

	  Tampering Report Fire      prob
	0         0      0    0  0.979303
	1         0      1    0  0.010697
	2         1      0    0  0.432005
	3         1      1    0  0.557995
	4         0      0    1  0.003453
	5         0      1    1  0.006547
	6         1      0    1  0.006640
	7         1      1    1  0.003360

Sum out Fire

	  Tampering Report      prob
	0         0      0  0.982756
	1         0      1  0.017244
	2         1      0  0.438646
	3         1      1  0.561354

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering Report      prob
	0         0      0  0.982756
	1         0      1  0.017244
	2         1      0  0.438646
	3         1      1  0.561354

Eliminate variable: Report

Factors to multiply containing variable: Report

	  Tampering Report      prob
	0         0      0  0.982756
	1         0      1  0.017244
	2         1      0  0.438646
	3         1      1  0.561354

Result of multiplication: 

	  Tampering Report      prob
	0         0      0  0.982756
	1         0      1  0.017244
	2         1      0  0.438646
	3         1      1  0.561354

Storing factor for backtracking to find value of Report

	  Tampering Report      prob
	0         0      0  0.982756
	1         0      1  0.017244
	2         1      0  0.438646
	3         1      1  0.561354

Maximise out Report

	  Tampering      prob
	0         0  0.982756
	1         1  0.561354

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.982756
	1         1  0.561354

Eliminate variable: Tampering

Factors to multiply containing variable: Tampering

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.982756
	1         1  0.561354

Result of multiplication: 

	  Tampering      prob
	0         0  0.963101
	1         1  0.011227

Storing factor for backtracking to find value of Tampering

	  Tampering      prob
	0         0  0.963101
	1         1  0.011227

New List of Factors: 

	  Tampering      prob
	0         0  0.963101
	1         1  0.011227

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	  Tampering      prob
	0         0  0.963101
	1         1  0.011227

Finding MAP instantiation for Tampering

MAP assignment for variable Tampering is 0

Popped this factor from the backtracking stack:

	  Tampering Report      prob
	0         0      0  0.982756
	1         0      1  0.017244
	2         1      0  0.438646
	3         1      1  0.561354

Finding MAP instantiation for Report

MAP assignment for variable Report is 0

Final Map Instantiation:

Tampering->0

Report->0

Elimination Order: ['Report', 'Smoke', 'Tampering', 'JohnCalls', 'MaryCalls', 'Fire', 'Leaving', 'Earthquake', 'Alarm']

MAP Variables: ['Alarm']

Observed Variables: {'Burglary': 'True'}

Original Factors: 

	   Alarm Burglary Earthquake   prob
	0   True     True       True  0.950
	1  False     True       True  0.050
	2   True    False       True  0.290
	3  False    False       True  0.710
	4   True     True      False  0.940
	5  False     True      False  0.060
	6   True    False      False  0.001
	7  False    False      False  0.999

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Burglary  prob
	0     True  0.01
	1    False  0.99

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Factors with evidence applied: 

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Eliminate variable: Report

Factors to multiply containing variable: Report

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

Result of multiplication: 

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

Sum out Report

	  Leaving  prob
	0       0   1.0
	1       1   1.0

New List of Factors: 

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

	  Leaving  prob
	0       0   1.0
	1       1   1.0

Eliminate variable: Smoke

Factors to multiply containing variable: Smoke

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

Result of multiplication: 

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

Sum out Smoke

	  Fire  prob
	0    0   1.0
	1    1   1.0

New List of Factors: 

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

	  Leaving  prob
	0       0   1.0
	1       1   1.0

	  Fire  prob
	0    0   1.0
	1    1   1.0

Eliminate variable: Tampering

Factors to multiply containing variable: Tampering

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Result of multiplication: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Elimination Order: ['Report', 'Smoke', 'Tampering', 'JohnCalls', 'MaryCalls', 'Fire', 'Leaving', 'Earthquake', 'Alarm']

MAP Variables: ['Alarm']

Observed Variables: {'Burglary': 'False'}

Original Factors: 

	   Alarm Burglary Earthquake   prob
	0   True     True       True  0.950
	1  False     True       True  0.050
	2   True    False       True  0.290
	3  False    False       True  0.710
	4   True     True      False  0.940
	5  False     True      False  0.060
	6   True    False      False  0.001
	7  False    False      False  0.999

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Burglary  prob
	0     True  0.01
	1    False  0.99

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Factors with evidence applied: 

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Eliminate variable: Report

Factors to multiply containing variable: Report

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

Result of multiplication: 

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

Sum out Report

	  Leaving  prob
	0       0   1.0
	1       1   1.0

New List of Factors: 

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

	  Leaving  prob
	0       0   1.0
	1       1   1.0

Eliminate variable: Smoke

Factors to multiply containing variable: Smoke

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

Result of multiplication: 

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

Sum out Smoke

	  Fire  prob
	0    0   1.0
	1    1   1.0

New List of Factors: 

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

	  Leaving  prob
	0       0   1.0
	1       1   1.0

	  Fire  prob
	0    0   1.0
	1    1   1.0

Eliminate variable: Tampering

Factors to multiply containing variable: Tampering

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Result of multiplication: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Elimination Order: ['Alarm', 'Leaving', 'Fire', 'Report', 'Tampering']

MAP Variables: ['Tampering', 'Report']

Observed Variables: {'Smoke': '1'}

Original Factors: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Factors with evidence applied: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

Result of multiplication: 

	   Leaving Fire Alarm Tampering      prob
	0        0    0     0         0  0.998900
	1        1    0     0         0  0.001000
	2        0    0     1         0  0.000012
	3        1    0     1         0  0.000088
	4        0    0     0         1  0.149850
	5        1    0     0         1  0.000150
	6        0    0     1         1  0.102000
	7        1    0     1         1  0.748000
	8        0    1     0         0  0.009990
	9        1    1     0         0  0.000010
	10       0    1     1         0  0.118800
	11       1    1     1         0  0.871200
	12       0    1     0         1  0.499500
	13       1    1     0         1  0.000500
	14       0    1     1         1  0.060000
	15       1    1     1         1  0.440000

Sum out Alarm

	  Leaving Fire Tampering      prob
	0       0    0         0  0.998912
	1       0    0         1  0.251850
	2       0    1         0  0.128790
	3       0    1         1  0.559500
	4       1    0         0  0.001088
	5       1    0         1  0.748150
	6       1    1         0  0.871210
	7       1    1         1  0.440500

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Leaving Fire Tampering      prob
	0       0    0         0  0.998912
	1       0    0         1  0.251850
	2       0    1         0  0.128790
	3       0    1         1  0.559500
	4       1    0         0  0.001088
	5       1    0         1  0.748150
	6       1    1         0  0.871210
	7       1    1         1  0.440500

Eliminate variable: Leaving

Factors to multiply containing variable: Leaving

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Leaving Fire Tampering      prob
	0       0    0         0  0.998912
	1       0    0         1  0.251850
	2       0    1         0  0.128790
	3       0    1         1  0.559500
	4       1    0         0  0.001088
	5       1    0         1  0.748150
	6       1    1         0  0.871210
	7       1    1         1  0.440500

Result of multiplication: 

	   Leaving Fire Tampering Report      prob
	0        0    0         0      0  0.988923
	1        0    0         1      0  0.249331
	2        0    1         0      0  0.127502
	3        0    1         1      0  0.553905
	4        0    0         0      1  0.009989
	5        0    0         1      1  0.002518
	6        0    1         0      1  0.001288
	7        0    1         1      1  0.005595
	8        1    0         0      0  0.000272
	9        1    0         1      0  0.187037
	10       1    1         0      0  0.217802
	11       1    1         1      0  0.110125
	12       1    0         0      1  0.000816
	13       1    0         1      1  0.561113
	14       1    1         0      1  0.653407
	15       1    1         1      1  0.330375

Sum out Leaving

	  Fire Tampering Report      prob
	0    0         0      0  0.989195
	1    0         0      1  0.010805
	2    0         1      0  0.436369
	3    0         1      1  0.563631
	4    1         0      0  0.345305
	5    1         0      1  0.654695
	6    1         1      0  0.664030
	7    1         1      1  0.335970

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire Tampering Report      prob
	0    0         0      0  0.989195
	1    0         0      1  0.010805
	2    0         1      0  0.436369
	3    0         1      1  0.563631
	4    1         0      0  0.345305
	5    1         0      1  0.654695
	6    1         1      0  0.664030
	7    1         1      1  0.335970

Eliminate variable: Fire

Factors to multiply containing variable: Fire

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Fire Tampering Report      prob
	0    0         0      0  0.989195
	1    0         0      1  0.010805
	2    0         1      0  0.436369
	3    0         1      1  0.563631
	4    1         0      0  0.345305
	5    1         0      1  0.654695
	6    1         1      0  0.664030
	7    1         1      1  0.335970

Result of multiplication: 

	  Fire Tampering Report      prob
	0    0         0      0  0.009793
	1    0         0      1  0.000107
	2    0         1      0  0.004320
	3    0         1      1  0.005580
	4    1         0      0  0.003108
	5    1         0      1  0.005892
	6    1         1      0  0.005976
	7    1         1      1  0.003024

Sum out Fire

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Eliminate variable: Report

Factors to multiply containing variable: Report

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Result of multiplication: 

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Storing factor for backtracking to find value of Report

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Maximise out Report

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

Eliminate variable: Tampering

Factors to multiply containing variable: Tampering

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

Result of multiplication: 

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Storing factor for backtracking to find value of Tampering

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

New List of Factors: 

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Finding MAP instantiation for Tampering

MAP assignment for variable Tampering is 0

Popped this factor from the backtracking stack:

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Finding MAP instantiation for Report

MAP assignment for variable Report is 0

Final Map Instantiation:

Tampering->0

Report->0

Elimination Order: ['Smoke', 'Alarm', 'Leaving', 'Fire', 'Report', 'Tampering']

MAP Variables: ['Tampering', 'Report']

Observed Variables: {}

Original Factors: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Factors with evidence applied: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Eliminate variable: Smoke

Factors to multiply containing variable: Smoke

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

Result of multiplication: 

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

Sum out Smoke

	  Fire  prob
	0    0   1.0
	1    1   1.0

New List of Factors: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire  prob
	0    0   1.0
	1    1   1.0

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

Result of multiplication: 

	   Leaving Fire Alarm Tampering      prob
	0        0    0     0         0  0.998900
	1        1    0     0         0  0.001000
	2        0    0     1         0  0.000012
	3        1    0     1         0  0.000088
	4        0    0     0         1  0.149850
	5        1    0     0         1  0.000150
	6        0    0     1         1  0.102000
	7        1    0     1         1  0.748000
	8        0    1     0         0  0.009990
	9        1    1     0         0  0.000010
	10       0    1     1         0  0.118800
	11       1    1     1         0  0.871200
	12       0    1     0         1  0.499500
	13       1    1     0         1  0.000500
	14       0    1     1         1  0.060000
	15       1    1     1         1  0.440000

Sum out Alarm

	  Leaving Fire Tampering      prob
	0       0    0         0  0.998912
	1       0    0         1  0.251850
	2       0    1         0  0.128790
	3       0    1         1  0.559500
	4       1    0         0  0.001088
	5       1    0         1  0.748150
	6       1    1         0  0.871210
	7       1    1         1  0.440500

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire  prob
	0    0   1.0
	1    1   1.0

	  Leaving Fire Tampering      prob
	0       0    0         0  0.998912
	1       0    0         1  0.251850
	2       0    1         0  0.128790
	3       0    1         1  0.559500
	4       1    0         0  0.001088
	5       1    0         1  0.748150
	6       1    1         0  0.871210
	7       1    1         1  0.440500

Eliminate variable: Leaving

Factors to multiply containing variable: Leaving

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Leaving Fire Tampering      prob
	0       0    0         0  0.998912
	1       0    0         1  0.251850
	2       0    1         0  0.128790
	3       0    1         1  0.559500
	4       1    0         0  0.001088
	5       1    0         1  0.748150
	6       1    1         0  0.871210
	7       1    1         1  0.440500

Result of multiplication: 

	   Leaving Fire Tampering Report      prob
	0        0    0         0      0  0.988923
	1        0    0         1      0  0.249331
	2        0    1         0      0  0.127502
	3        0    1         1      0  0.553905
	4        0    0         0      1  0.009989
	5        0    0         1      1  0.002518
	6        0    1         0      1  0.001288
	7        0    1         1      1  0.005595
	8        1    0         0      0  0.000272
	9        1    0         1      0  0.187037
	10       1    1         0      0  0.217802
	11       1    1         1      0  0.110125
	12       1    0         0      1  0.000816
	13       1    0         1      1  0.561113
	14       1    1         0      1  0.653407
	15       1    1         1      1  0.330375

Sum out Leaving

	  Fire Tampering Report      prob
	0    0         0      0  0.989195
	1    0         0      1  0.010805
	2    0         1      0  0.436369
	3    0         1      1  0.563631
	4    1         0      0  0.345305
	5    1         0      1  0.654695
	6    1         1      0  0.664030
	7    1         1      1  0.335970

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire  prob
	0    0   1.0
	1    1   1.0

	  Fire Tampering Report      prob
	0    0         0      0  0.989195
	1    0         0      1  0.010805
	2    0         1      0  0.436369
	3    0         1      1  0.563631
	4    1         0      0  0.345305
	5    1         0      1  0.654695
	6    1         1      0  0.664030
	7    1         1      1  0.335970

Eliminate variable: Fire

Factors to multiply containing variable: Fire

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	0    0   1.0
	1    1   1.0

	  Fire Tampering Report      prob
	0    0         0      0  0.989195
	1    0         0      1  0.010805
	2    0         1      0  0.436369
	3    0         1      1  0.563631
	4    1         0      0  0.345305
	5    1         0      1  0.654695
	6    1         1      0  0.664030
	7    1         1      1  0.335970

Result of multiplication: 

	  Fire Tampering Report      prob
	0    0         0      0  0.979303
	1    0         0      1  0.010697
	2    0         1      0  0.432005
	3    0         1      1  0.557995
	4    1         0      0  0.003453
	5    1         0      1  0.006547
	6    1         1      0  0.006640
	7    1         1      1  0.003360

Sum out Fire

	  Tampering Report      prob
	0         0      0  0.982756
	1         0      1  0.017244
	2         1      0  0.438646
	3         1      1  0.561354

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering Report      prob
	0         0      0  0.982756
	1         0      1  0.017244
	2         1      0  0.438646
	3         1      1  0.561354

Eliminate variable: Report

Factors to multiply containing variable: Report

	  Tampering Report      prob
	0         0      0  0.982756
	1         0      1  0.017244
	2         1      0  0.438646
	3         1      1  0.561354

Result of multiplication: 

	  Tampering Report      prob
	0         0      0  0.982756
	1         0      1  0.017244
	2         1      0  0.438646
	3         1      1  0.561354

Storing factor for backtracking to find value of Report

	  Tampering Report      prob
	0         0      0  0.982756
	1         0      1  0.017244
	2         1      0  0.438646
	3         1      1  0.561354

Maximise out Report

	  Tampering      prob
	0         0  0.982756
	1         1  0.561354

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.982756
	1         1  0.561354

Eliminate variable: Tampering

Factors to multiply containing variable: Tampering

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.982756
	1         1  0.561354

Result of multiplication: 

	  Tampering      prob
	0         0  0.963101
	1         1  0.011227

Storing factor for backtracking to find value of Tampering

	  Tampering      prob
	0         0  0.963101
	1         1  0.011227

New List of Factors: 

	  Tampering      prob
	0         0  0.963101
	1         1  0.011227

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	  Tampering      prob
	0         0  0.963101
	1         1  0.011227

Finding MAP instantiation for Tampering

MAP assignment for variable Tampering is 0

Popped this factor from the backtracking stack:

	  Tampering Report      prob
	0         0      0  0.982756
	1         0      1  0.017244
	2         1      0  0.438646
	3         1      1  0.561354

Finding MAP instantiation for Report

MAP assignment for variable Report is 0

Final Map Instantiation:

Tampering->0

Report->0

Elimination Order: ['Report', 'Smoke', 'Tampering', 'JohnCalls', 'MaryCalls', 'Fire', 'Leaving', 'Earthquake', 'Alarm']

MAP Variables: ['Alarm']

Observed Variables: {'Burglary': 'True'}

Original Factors: 

	   Alarm Burglary Earthquake   prob
	0   True     True       True  0.950
	1  False     True       True  0.050
	2   True    False       True  0.290
	3  False    False       True  0.710
	4   True     True      False  0.940
	5  False     True      False  0.060
	6   True    False      False  0.001
	7  False    False      False  0.999

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Burglary  prob
	0     True  0.01
	1    False  0.99

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Factors with evidence applied: 

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Eliminate variable: Report

Factors to multiply containing variable: Report

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

Result of multiplication: 

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

Sum out Report

	  Leaving  prob
	0       0   1.0
	1       1   1.0

New List of Factors: 

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

	  Leaving  prob
	0       0   1.0
	1       1   1.0

Eliminate variable: Smoke

Factors to multiply containing variable: Smoke

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

Result of multiplication: 

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

Sum out Smoke

	  Fire  prob
	0    0   1.0
	1    1   1.0

New List of Factors: 

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

	  Leaving  prob
	0       0   1.0
	1       1   1.0

	  Fire  prob
	0    0   1.0
	1    1   1.0

Eliminate variable: Tampering

Factors to multiply containing variable: Tampering

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Result of multiplication: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Elimination Order: ['Report', 'Smoke', 'Tampering', 'JohnCalls', 'MaryCalls', 'Fire', 'Leaving', 'Earthquake', 'Alarm']

MAP Variables: ['Alarm']

Observed Variables: {'Burglary': 'False'}

Original Factors: 

	   Alarm Burglary Earthquake   prob
	0   True     True       True  0.950
	1  False     True       True  0.050
	2   True    False       True  0.290
	3  False    False       True  0.710
	4   True     True      False  0.940
	5  False     True      False  0.060
	6   True    False      False  0.001
	7  False    False      False  0.999

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Burglary  prob
	0     True  0.01
	1    False  0.99

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Factors with evidence applied: 

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Eliminate variable: Report

Factors to multiply containing variable: Report

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

Result of multiplication: 

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

Sum out Report

	  Leaving  prob
	0       0   1.0
	1       1   1.0

New List of Factors: 

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

	  Leaving  prob
	0       0   1.0
	1       1   1.0

Eliminate variable: Smoke

Factors to multiply containing variable: Smoke

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

Result of multiplication: 

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

Sum out Smoke

	  Fire  prob
	0    0   1.0
	1    1   1.0

New List of Factors: 

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

	  Leaving  prob
	0       0   1.0
	1       1   1.0

	  Fire  prob
	0    0   1.0
	1    1   1.0

Eliminate variable: Tampering

Factors to multiply containing variable: Tampering

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Result of multiplication: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Elimination Order: ['Alarm', 'Leaving', 'Fire', 'Report', 'Tampering']

MAP Variables: ['Tampering', 'Report']

Observed Variables: {'Smoke': '1'}

Original Factors: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Factors with evidence applied: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

Result of multiplication: 

	   Alarm Fire Tampering Leaving      prob
	0      0    0         0       0  0.998900
	1      0    0         0       1  0.001000
	2      1    0         0       0  0.000012
	3      1    0         0       1  0.000088
	4      0    0         1       0  0.149850
	5      0    0         1       1  0.000150
	6      1    0         1       0  0.102000
	7      1    0         1       1  0.748000
	8      0    1         0       0  0.009990
	9      0    1         0       1  0.000010
	10     1    1         0       0  0.118800
	11     1    1         0       1  0.871200
	12     0    1         1       0  0.499500
	13     0    1         1       1  0.000500
	14     1    1         1       0  0.060000
	15     1    1         1       1  0.440000

Sum out Alarm

	  Fire Tampering Leaving      prob
	0    0         0       0  0.998912
	1    0         0       1  0.001088
	2    0         1       0  0.251850
	3    0         1       1  0.748150
	4    1         0       0  0.128790
	5    1         0       1  0.871210
	6    1         1       0  0.559500
	7    1         1       1  0.440500

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire Tampering Leaving      prob
	0    0         0       0  0.998912
	1    0         0       1  0.001088
	2    0         1       0  0.251850
	3    0         1       1  0.748150
	4    1         0       0  0.128790
	5    1         0       1  0.871210
	6    1         1       0  0.559500
	7    1         1       1  0.440500

Eliminate variable: Leaving

Factors to multiply containing variable: Leaving

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Fire Tampering Leaving      prob
	0    0         0       0  0.998912
	1    0         0       1  0.001088
	2    0         1       0  0.251850
	3    0         1       1  0.748150
	4    1         0       0  0.128790
	5    1         0       1  0.871210
	6    1         1       0  0.559500
	7    1         1       1  0.440500

Result of multiplication: 

	   Fire Tampering Leaving Report      prob
	0     0         0       0      0  0.988923
	1     0         1       0      0  0.249331
	2     1         0       0      0  0.127502
	3     1         1       0      0  0.553905
	4     0         0       0      1  0.009989
	5     0         1       0      1  0.002518
	6     1         0       0      1  0.001288
	7     1         1       0      1  0.005595
	8     0         0       1      0  0.000272
	9     0         1       1      0  0.187037
	10    1         0       1      0  0.217802
	11    1         1       1      0  0.110125
	12    0         0       1      1  0.000816
	13    0         1       1      1  0.561113
	14    1         0       1      1  0.653407
	15    1         1       1      1  0.330375

Sum out Leaving

	  Fire Tampering Report      prob
	0    0         0      0  0.989195
	1    0         0      1  0.010805
	2    0         1      0  0.436369
	3    0         1      1  0.563631
	4    1         0      0  0.345305
	5    1         0      1  0.654695
	6    1         1      0  0.664030
	7    1         1      1  0.335970

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire Tampering Report      prob
	0    0         0      0  0.989195
	1    0         0      1  0.010805
	2    0         1      0  0.436369
	3    0         1      1  0.563631
	4    1         0      0  0.345305
	5    1         0      1  0.654695
	6    1         1      0  0.664030
	7    1         1      1  0.335970

Eliminate variable: Fire

Factors to multiply containing variable: Fire

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Fire Tampering Report      prob
	0    0         0      0  0.989195
	1    0         0      1  0.010805
	2    0         1      0  0.436369
	3    0         1      1  0.563631
	4    1         0      0  0.345305
	5    1         0      1  0.654695
	6    1         1      0  0.664030
	7    1         1      1  0.335970

Result of multiplication: 

	  Tampering Fire Report      prob
	0         0    0      0  0.009793
	1         0    0      1  0.000107
	2         1    0      0  0.004320
	3         1    0      1  0.005580
	4         0    1      0  0.003108
	5         0    1      1  0.005892
	6         1    1      0  0.005976
	7         1    1      1  0.003024

Sum out Fire

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Eliminate variable: Report

Factors to multiply containing variable: Report

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Result of multiplication: 

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Storing factor for backtracking to find value of Report

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Maximise out Report

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

Eliminate variable: Tampering

Factors to multiply containing variable: Tampering

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

Result of multiplication: 

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Finding MAP instantiation for Tampering

MAP assignment for variable Tampering is 0

Final Map Instantiation:

Tampering->0

Elimination Order: ['Smoke', 'Alarm', 'Leaving', 'Fire', 'Report', 'Tampering']

MAP Variables: ['Tampering', 'Report']

Observed Variables: {}

Original Factors: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Factors with evidence applied: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Eliminate variable: Smoke

Factors to multiply containing variable: Smoke

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

Result of multiplication: 

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

Sum out Smoke

	  Fire  prob
	0    0   1.0
	1    1   1.0

New List of Factors: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire  prob
	0    0   1.0
	1    1   1.0

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

Result of multiplication: 

	   Alarm Fire Tampering Leaving      prob
	0      0    0         0       0  0.998900
	1      0    0         0       1  0.001000
	2      1    0         0       0  0.000012
	3      1    0         0       1  0.000088
	4      0    0         1       0  0.149850
	5      0    0         1       1  0.000150
	6      1    0         1       0  0.102000
	7      1    0         1       1  0.748000
	8      0    1         0       0  0.009990
	9      0    1         0       1  0.000010
	10     1    1         0       0  0.118800
	11     1    1         0       1  0.871200
	12     0    1         1       0  0.499500
	13     0    1         1       1  0.000500
	14     1    1         1       0  0.060000
	15     1    1         1       1  0.440000

Sum out Alarm

	  Fire Tampering Leaving      prob
	0    0         0       0  0.998912
	1    0         0       1  0.001088
	2    0         1       0  0.251850
	3    0         1       1  0.748150
	4    1         0       0  0.128790
	5    1         0       1  0.871210
	6    1         1       0  0.559500
	7    1         1       1  0.440500

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire  prob
	0    0   1.0
	1    1   1.0

	  Fire Tampering Leaving      prob
	0    0         0       0  0.998912
	1    0         0       1  0.001088
	2    0         1       0  0.251850
	3    0         1       1  0.748150
	4    1         0       0  0.128790
	5    1         0       1  0.871210
	6    1         1       0  0.559500
	7    1         1       1  0.440500

Eliminate variable: Leaving

Factors to multiply containing variable: Leaving

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Fire Tampering Leaving      prob
	0    0         0       0  0.998912
	1    0         0       1  0.001088
	2    0         1       0  0.251850
	3    0         1       1  0.748150
	4    1         0       0  0.128790
	5    1         0       1  0.871210
	6    1         1       0  0.559500
	7    1         1       1  0.440500

Result of multiplication: 

	   Fire Tampering Leaving Report      prob
	0     0         0       0      0  0.988923
	1     0         1       0      0  0.249331
	2     1         0       0      0  0.127502
	3     1         1       0      0  0.553905
	4     0         0       0      1  0.009989
	5     0         1       0      1  0.002518
	6     1         0       0      1  0.001288
	7     1         1       0      1  0.005595
	8     0         0       1      0  0.000272
	9     0         1       1      0  0.187037
	10    1         0       1      0  0.217802
	11    1         1       1      0  0.110125
	12    0         0       1      1  0.000816
	13    0         1       1      1  0.561113
	14    1         0       1      1  0.653407
	15    1         1       1      1  0.330375

Sum out Leaving

	  Fire Tampering Report      prob
	0    0         0      0  0.989195
	1    0         0      1  0.010805
	2    0         1      0  0.436369
	3    0         1      1  0.563631
	4    1         0      0  0.345305
	5    1         0      1  0.654695
	6    1         1      0  0.664030
	7    1         1      1  0.335970

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire  prob
	0    0   1.0
	1    1   1.0

	  Fire Tampering Report      prob
	0    0         0      0  0.989195
	1    0         0      1  0.010805
	2    0         1      0  0.436369
	3    0         1      1  0.563631
	4    1         0      0  0.345305
	5    1         0      1  0.654695
	6    1         1      0  0.664030
	7    1         1      1  0.335970

Eliminate variable: Fire

Factors to multiply containing variable: Fire

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	0    0   1.0
	1    1   1.0

	  Fire Tampering Report      prob
	0    0         0      0  0.989195
	1    0         0      1  0.010805
	2    0         1      0  0.436369
	3    0         1      1  0.563631
	4    1         0      0  0.345305
	5    1         0      1  0.654695
	6    1         1      0  0.664030
	7    1         1      1  0.335970

Result of multiplication: 

	  Tampering Fire Report      prob
	0         0    0      0  0.979303
	1         0    0      1  0.010697
	2         1    0      0  0.432005
	3         1    0      1  0.557995
	4         0    1      0  0.003453
	5         0    1      1  0.006547
	6         1    1      0  0.006640
	7         1    1      1  0.003360

Sum out Fire

	  Tampering Report      prob
	0         0      0  0.982756
	1         0      1  0.017244
	2         1      0  0.438646
	3         1      1  0.561354

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering Report      prob
	0         0      0  0.982756
	1         0      1  0.017244
	2         1      0  0.438646
	3         1      1  0.561354

Eliminate variable: Report

Factors to multiply containing variable: Report

	  Tampering Report      prob
	0         0      0  0.982756
	1         0      1  0.017244
	2         1      0  0.438646
	3         1      1  0.561354

Result of multiplication: 

	  Tampering Report      prob
	0         0      0  0.982756
	1         0      1  0.017244
	2         1      0  0.438646
	3         1      1  0.561354

Storing factor for backtracking to find value of Report

	  Tampering Report      prob
	0         0      0  0.982756
	1         0      1  0.017244
	2         1      0  0.438646
	3         1      1  0.561354

Maximise out Report

	  Tampering      prob
	0         0  0.982756
	1         1  0.561354

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.982756
	1         1  0.561354

Eliminate variable: Tampering

Factors to multiply containing variable: Tampering

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.982756
	1         1  0.561354

Result of multiplication: 

	  Tampering      prob
	0         0  0.963101
	1         1  0.011227

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	  Tampering Report      prob
	0         0      0  0.982756
	1         0      1  0.017244
	2         1      0  0.438646
	3         1      1  0.561354

Finding MAP instantiation for Tampering

MAP assignment for variable Tampering is 0

Final Map Instantiation:

Tampering->0

Elimination Order: ['Report', 'Smoke', 'Tampering', 'JohnCalls', 'MaryCalls', 'Fire', 'Leaving', 'Earthquake', 'Alarm']

MAP Variables: ['Alarm']

Observed Variables: {'Burglary': 'True'}

Original Factors: 

	   Alarm Burglary Earthquake   prob
	0   True     True       True  0.950
	1  False     True       True  0.050
	2   True    False       True  0.290
	3  False    False       True  0.710
	4   True     True      False  0.940
	5  False     True      False  0.060
	6   True    False      False  0.001
	7  False    False      False  0.999

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Burglary  prob
	0     True  0.01
	1    False  0.99

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Factors with evidence applied: 

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Eliminate variable: Report

Factors to multiply containing variable: Report

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

Result of multiplication: 

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

Sum out Report

	  Leaving  prob
	0       0   1.0
	1       1   1.0

New List of Factors: 

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

	  Leaving  prob
	0       0   1.0
	1       1   1.0

Eliminate variable: Smoke

Factors to multiply containing variable: Smoke

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

Result of multiplication: 

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

Sum out Smoke

	  Fire  prob
	0    0   1.0
	1    1   1.0

New List of Factors: 

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

	  Leaving  prob
	0       0   1.0
	1       1   1.0

	  Fire  prob
	0    0   1.0
	1    1   1.0

Eliminate variable: Tampering

Factors to multiply containing variable: Tampering

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Result of multiplication: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Eliminate variable: JohnCalls

Factors to multiply containing variable: JohnCalls

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Result of multiplication: 

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Sum out JohnCalls

	   Alarm  prob
	0  False   1.0
	1   True   1.0

New List of Factors: 

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

	  Leaving  prob
	0       0   1.0
	1       1   1.0

	  Fire  prob
	0    0   1.0
	1    1   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

Eliminate variable: MaryCalls

Factors to multiply containing variable: MaryCalls

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Result of multiplication: 

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Sum out MaryCalls

	   Alarm  prob
	0  False   1.0
	1   True   1.0

New List of Factors: 

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	  Leaving  prob
	0       0   1.0
	1       1   1.0

	  Fire  prob
	0    0   1.0
	1    1   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

Eliminate variable: Fire

Factors to multiply containing variable: Fire

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	0    0   1.0
	1    1   1.0

Result of multiplication: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

Eliminate variable: Leaving

Factors to multiply containing variable: Leaving

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Leaving  prob
	0       0   1.0
	1       1   1.0

Result of multiplication: 

	  Alarm Leaving   prob
	0     0       0  0.999
	1     0       1  0.001
	2     1       0  0.120
	3     1       1  0.880

Sum out Leaving

	  Alarm  prob
	0     0   1.0
	1     1   1.0

New List of Factors: 

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	  Fire  prob
	0    0   1.0
	1    1   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	  Alarm  prob
	0     0   1.0
	1     1   1.0

Eliminate variable: Earthquake

Factors to multiply containing variable: Earthquake

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

Result of multiplication: 

	   Alarm Earthquake    prob
	0   True       True  0.0190
	1  False       True  0.0010
	2   True      False  0.9212
	3  False      False  0.0588

Sum out Earthquake

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire  prob
	0    0   1.0
	1    1   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	  Alarm  prob
	0     0   1.0
	1     1   1.0

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	  Alarm  prob
	0     0   1.0
	1     1   1.0

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Result of multiplication: 

	Empty DataFrame
	Columns: [Alarm, prob]
	Index: []

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Final Map Instantiation:

Elimination Order: ['Report', 'Smoke', 'Tampering', 'JohnCalls', 'MaryCalls', 'Fire', 'Leaving', 'Earthquake', 'Alarm']

MAP Variables: ['Alarm']

Observed Variables: {'Burglary': 'False'}

Original Factors: 

	   Alarm Burglary Earthquake   prob
	0   True     True       True  0.950
	1  False     True       True  0.050
	2   True    False       True  0.290
	3  False    False       True  0.710
	4   True     True      False  0.940
	5  False     True      False  0.060
	6   True    False      False  0.001
	7  False    False      False  0.999

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Burglary  prob
	0     True  0.01
	1    False  0.99

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Factors with evidence applied: 

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Eliminate variable: Report

Factors to multiply containing variable: Report

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

Result of multiplication: 

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

Sum out Report

	  Leaving  prob
	0       0   1.0
	1       1   1.0

New List of Factors: 

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

	  Leaving  prob
	0       0   1.0
	1       1   1.0

Eliminate variable: Smoke

Factors to multiply containing variable: Smoke

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

Result of multiplication: 

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

Sum out Smoke

	  Fire  prob
	0    0   1.0
	1    1   1.0

New List of Factors: 

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

	  Leaving  prob
	0       0   1.0
	1       1   1.0

	  Fire  prob
	0    0   1.0
	1    1   1.0

Eliminate variable: Tampering

Factors to multiply containing variable: Tampering

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Result of multiplication: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Eliminate variable: JohnCalls

Factors to multiply containing variable: JohnCalls

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Result of multiplication: 

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Sum out JohnCalls

	   Alarm  prob
	0  False   1.0
	1   True   1.0

New List of Factors: 

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

	  Leaving  prob
	0       0   1.0
	1       1   1.0

	  Fire  prob
	0    0   1.0
	1    1   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

Eliminate variable: MaryCalls

Factors to multiply containing variable: MaryCalls

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Result of multiplication: 

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Sum out MaryCalls

	   Alarm  prob
	0  False   1.0
	1   True   1.0

New List of Factors: 

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	  Leaving  prob
	0       0   1.0
	1       1   1.0

	  Fire  prob
	0    0   1.0
	1    1   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

Eliminate variable: Fire

Factors to multiply containing variable: Fire

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	0    0   1.0
	1    1   1.0

Result of multiplication: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

Eliminate variable: Leaving

Factors to multiply containing variable: Leaving

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Leaving  prob
	0       0   1.0
	1       1   1.0

Result of multiplication: 

	  Alarm Leaving   prob
	0     0       0  0.999
	1     0       1  0.001
	2     1       0  0.120
	3     1       1  0.880

Sum out Leaving

	  Alarm  prob
	0     0   1.0
	1     1   1.0

New List of Factors: 

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	  Fire  prob
	0    0   1.0
	1    1   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	  Alarm  prob
	0     0   1.0
	1     1   1.0

Eliminate variable: Earthquake

Factors to multiply containing variable: Earthquake

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

Result of multiplication: 

	   Alarm Earthquake     prob
	0   True       True  0.00580
	1  False       True  0.01420
	2   True      False  0.00098
	3  False      False  0.97902

Sum out Earthquake

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire  prob
	0    0   1.0
	1    1   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	  Alarm  prob
	0     0   1.0
	1     1   1.0

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	  Alarm  prob
	0     0   1.0
	1     1   1.0

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

Result of multiplication: 

	Empty DataFrame
	Columns: [Alarm, prob]
	Index: []

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Final Map Instantiation:

Elimination Order: ['Alarm', 'Leaving', 'Fire', 'Report', 'Tampering']

MAP Variables: ['Tampering', 'Report']

Observed Variables: {'Smoke': '1'}

Original Factors: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Factors with evidence applied: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

Result of multiplication: 

	   Leaving Fire Alarm Tampering      prob
	0        0    0     0         0  0.998900
	1        1    0     0         0  0.001000
	2        0    0     1         0  0.000012
	3        1    0     1         0  0.000088
	4        0    0     0         1  0.149850
	5        1    0     0         1  0.000150
	6        0    0     1         1  0.102000
	7        1    0     1         1  0.748000
	8        0    1     0         0  0.009990
	9        1    1     0         0  0.000010
	10       0    1     1         0  0.118800
	11       1    1     1         0  0.871200
	12       0    1     0         1  0.499500
	13       1    1     0         1  0.000500
	14       0    1     1         1  0.060000
	15       1    1     1         1  0.440000

Sum out Alarm

	  Leaving Fire Tampering      prob
	0       0    0         0  0.998912
	1       0    0         1  0.251850
	2       0    1         0  0.128790
	3       0    1         1  0.559500
	4       1    0         0  0.001088
	5       1    0         1  0.748150
	6       1    1         0  0.871210
	7       1    1         1  0.440500

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Leaving Fire Tampering      prob
	0       0    0         0  0.998912
	1       0    0         1  0.251850
	2       0    1         0  0.128790
	3       0    1         1  0.559500
	4       1    0         0  0.001088
	5       1    0         1  0.748150
	6       1    1         0  0.871210
	7       1    1         1  0.440500

Eliminate variable: Leaving

Factors to multiply containing variable: Leaving

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Leaving Fire Tampering      prob
	0       0    0         0  0.998912
	1       0    0         1  0.251850
	2       0    1         0  0.128790
	3       0    1         1  0.559500
	4       1    0         0  0.001088
	5       1    0         1  0.748150
	6       1    1         0  0.871210
	7       1    1         1  0.440500

Result of multiplication: 

	   Report Leaving Fire Tampering      prob
	0       0       0    0         0  0.988923
	1       0       0    0         1  0.249331
	2       0       0    1         0  0.127502
	3       0       0    1         1  0.553905
	4       1       0    0         0  0.009989
	5       1       0    0         1  0.002518
	6       1       0    1         0  0.001288
	7       1       0    1         1  0.005595
	8       0       1    0         0  0.000272
	9       0       1    0         1  0.187037
	10      0       1    1         0  0.217802
	11      0       1    1         1  0.110125
	12      1       1    0         0  0.000816
	13      1       1    0         1  0.561113
	14      1       1    1         0  0.653407
	15      1       1    1         1  0.330375

Sum out Leaving

	  Report Fire Tampering      prob
	0      0    0         0  0.989195
	1      0    0         1  0.436369
	2      0    1         0  0.345305
	3      0    1         1  0.664030
	4      1    0         0  0.010805
	5      1    0         1  0.563631
	6      1    1         0  0.654695
	7      1    1         1  0.335970

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Report Fire Tampering      prob
	0      0    0         0  0.989195
	1      0    0         1  0.436369
	2      0    1         0  0.345305
	3      0    1         1  0.664030
	4      1    0         0  0.010805
	5      1    0         1  0.563631
	6      1    1         0  0.654695
	7      1    1         1  0.335970

Eliminate variable: Fire

Factors to multiply containing variable: Fire

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Report Fire Tampering      prob
	0      0    0         0  0.989195
	1      0    0         1  0.436369
	2      0    1         0  0.345305
	3      0    1         1  0.664030
	4      1    0         0  0.010805
	5      1    0         1  0.563631
	6      1    1         0  0.654695
	7      1    1         1  0.335970

Result of multiplication: 

	  Report Fire Tampering      prob
	0      0    0         0  0.009793
	1      0    0         1  0.004320
	2      1    0         0  0.000107
	3      1    0         1  0.005580
	4      0    1         0  0.003108
	5      0    1         1  0.005976
	6      1    1         0  0.005892
	7      1    1         1  0.003024

Sum out Fire

	  Report Tampering      prob
	0      0         0  0.012901
	1      0         1  0.010296
	2      1         0  0.005999
	3      1         1  0.008604

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Report Tampering      prob
	0      0         0  0.012901
	1      0         1  0.010296
	2      1         0  0.005999
	3      1         1  0.008604

Eliminate variable: Report

Factors to multiply containing variable: Report

	  Report Tampering      prob
	0      0         0  0.012901
	1      0         1  0.010296
	2      1         0  0.005999
	3      1         1  0.008604

Result of multiplication: 

	  Report Tampering      prob
	0      0         0  0.012901
	1      0         1  0.010296
	2      1         0  0.005999
	3      1         1  0.008604

Storing factor for backtracking to find value of Report

	  Report Tampering      prob
	0      0         0  0.012901
	1      0         1  0.010296
	2      1         0  0.005999
	3      1         1  0.008604

Maximise out Report

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

Eliminate variable: Tampering

Factors to multiply containing variable: Tampering

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

Result of multiplication: 

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Storing factor for backtracking to find value of Tampering

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

New List of Factors: 

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Finding MAP instantiation for Tampering

MAP assignment for variable Tampering is 0

Popped this factor from the backtracking stack:

	  Report Tampering      prob
	0      0         0  0.012901
	1      0         1  0.010296
	2      1         0  0.005999
	3      1         1  0.008604

Finding MAP instantiation for Report

MAP assignment for variable Report is 0

Final Map Instantiation:

Tampering->0

Report->0

Elimination Order: ['Smoke', 'Alarm', 'Leaving', 'Fire', 'Report', 'Tampering']

MAP Variables: ['Tampering', 'Report']

Observed Variables: {}

Original Factors: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Factors with evidence applied: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Eliminate variable: Smoke

Factors to multiply containing variable: Smoke

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

Result of multiplication: 

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

Sum out Smoke

	  Fire  prob
	0    0   1.0
	1    1   1.0

New List of Factors: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire  prob
	0    0   1.0
	1    1   1.0

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

Result of multiplication: 

	   Leaving Fire Alarm Tampering      prob
	0        0    0     0         0  0.998900
	1        1    0     0         0  0.001000
	2        0    0     1         0  0.000012
	3        1    0     1         0  0.000088
	4        0    0     0         1  0.149850
	5        1    0     0         1  0.000150
	6        0    0     1         1  0.102000
	7        1    0     1         1  0.748000
	8        0    1     0         0  0.009990
	9        1    1     0         0  0.000010
	10       0    1     1         0  0.118800
	11       1    1     1         0  0.871200
	12       0    1     0         1  0.499500
	13       1    1     0         1  0.000500
	14       0    1     1         1  0.060000
	15       1    1     1         1  0.440000

Sum out Alarm

	  Leaving Fire Tampering      prob
	0       0    0         0  0.998912
	1       0    0         1  0.251850
	2       0    1         0  0.128790
	3       0    1         1  0.559500
	4       1    0         0  0.001088
	5       1    0         1  0.748150
	6       1    1         0  0.871210
	7       1    1         1  0.440500

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire  prob
	0    0   1.0
	1    1   1.0

	  Leaving Fire Tampering      prob
	0       0    0         0  0.998912
	1       0    0         1  0.251850
	2       0    1         0  0.128790
	3       0    1         1  0.559500
	4       1    0         0  0.001088
	5       1    0         1  0.748150
	6       1    1         0  0.871210
	7       1    1         1  0.440500

Eliminate variable: Leaving

Factors to multiply containing variable: Leaving

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Leaving Fire Tampering      prob
	0       0    0         0  0.998912
	1       0    0         1  0.251850
	2       0    1         0  0.128790
	3       0    1         1  0.559500
	4       1    0         0  0.001088
	5       1    0         1  0.748150
	6       1    1         0  0.871210
	7       1    1         1  0.440500

Result of multiplication: 

	   Report Leaving Fire Tampering      prob
	0       0       0    0         0  0.988923
	1       0       0    0         1  0.249331
	2       0       0    1         0  0.127502
	3       0       0    1         1  0.553905
	4       1       0    0         0  0.009989
	5       1       0    0         1  0.002518
	6       1       0    1         0  0.001288
	7       1       0    1         1  0.005595
	8       0       1    0         0  0.000272
	9       0       1    0         1  0.187037
	10      0       1    1         0  0.217802
	11      0       1    1         1  0.110125
	12      1       1    0         0  0.000816
	13      1       1    0         1  0.561113
	14      1       1    1         0  0.653407
	15      1       1    1         1  0.330375

Sum out Leaving

	  Report Fire Tampering      prob
	0      0    0         0  0.989195
	1      0    0         1  0.436369
	2      0    1         0  0.345305
	3      0    1         1  0.664030
	4      1    0         0  0.010805
	5      1    0         1  0.563631
	6      1    1         0  0.654695
	7      1    1         1  0.335970

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire  prob
	0    0   1.0
	1    1   1.0

	  Report Fire Tampering      prob
	0      0    0         0  0.989195
	1      0    0         1  0.436369
	2      0    1         0  0.345305
	3      0    1         1  0.664030
	4      1    0         0  0.010805
	5      1    0         1  0.563631
	6      1    1         0  0.654695
	7      1    1         1  0.335970

Eliminate variable: Fire

Factors to multiply containing variable: Fire

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	0    0   1.0
	1    1   1.0

	  Report Fire Tampering      prob
	0      0    0         0  0.989195
	1      0    0         1  0.436369
	2      0    1         0  0.345305
	3      0    1         1  0.664030
	4      1    0         0  0.010805
	5      1    0         1  0.563631
	6      1    1         0  0.654695
	7      1    1         1  0.335970

Result of multiplication: 

	  Report Fire Tampering      prob
	0      0    0         0  0.979303
	1      0    0         1  0.432005
	2      1    0         0  0.010697
	3      1    0         1  0.557995
	4      0    1         0  0.003453
	5      0    1         1  0.006640
	6      1    1         0  0.006547
	7      1    1         1  0.003360

Sum out Fire

	  Report Tampering      prob
	0      0         0  0.982756
	1      0         1  0.438646
	2      1         0  0.017244
	3      1         1  0.561354

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Report Tampering      prob
	0      0         0  0.982756
	1      0         1  0.438646
	2      1         0  0.017244
	3      1         1  0.561354

Eliminate variable: Report

Factors to multiply containing variable: Report

	  Report Tampering      prob
	0      0         0  0.982756
	1      0         1  0.438646
	2      1         0  0.017244
	3      1         1  0.561354

Result of multiplication: 

	  Report Tampering      prob
	0      0         0  0.982756
	1      0         1  0.438646
	2      1         0  0.017244
	3      1         1  0.561354

Storing factor for backtracking to find value of Report

	  Report Tampering      prob
	0      0         0  0.982756
	1      0         1  0.438646
	2      1         0  0.017244
	3      1         1  0.561354

Maximise out Report

	  Tampering      prob
	0         0  0.982756
	1         1  0.561354

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.982756
	1         1  0.561354

Eliminate variable: Tampering

Factors to multiply containing variable: Tampering

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.982756
	1         1  0.561354

Result of multiplication: 

	  Tampering      prob
	0         0  0.963101
	1         1  0.011227

Storing factor for backtracking to find value of Tampering

	  Tampering      prob
	0         0  0.963101
	1         1  0.011227

New List of Factors: 

	  Tampering      prob
	0         0  0.963101
	1         1  0.011227

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	  Tampering      prob
	0         0  0.963101
	1         1  0.011227

Finding MAP instantiation for Tampering

MAP assignment for variable Tampering is 0

Popped this factor from the backtracking stack:

	  Report Tampering      prob
	0      0         0  0.982756
	1      0         1  0.438646
	2      1         0  0.017244
	3      1         1  0.561354

Finding MAP instantiation for Report

MAP assignment for variable Report is 0

Final Map Instantiation:

Tampering->0

Report->0

Elimination Order: ['Report', 'Smoke', 'Tampering', 'JohnCalls', 'MaryCalls', 'Fire', 'Leaving', 'Earthquake', 'Alarm']

MAP Variables: ['Alarm']

Observed Variables: {'Burglary': 'True'}

Original Factors: 

	   Alarm Burglary Earthquake   prob
	0   True     True       True  0.950
	1  False     True       True  0.050
	2   True    False       True  0.290
	3  False    False       True  0.710
	4   True     True      False  0.940
	5  False     True      False  0.060
	6   True    False      False  0.001
	7  False    False      False  0.999

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Burglary  prob
	0     True  0.01
	1    False  0.99

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Factors with evidence applied: 

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Eliminate variable: Report

Factors to multiply containing variable: Report

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

Result of multiplication: 

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

Sum out Report

	  Leaving  prob
	0       0   1.0
	1       1   1.0

New List of Factors: 

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

	  Leaving  prob
	0       0   1.0
	1       1   1.0

Eliminate variable: Smoke

Factors to multiply containing variable: Smoke

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

Result of multiplication: 

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

Sum out Smoke

	  Fire  prob
	0    0   1.0
	1    1   1.0

New List of Factors: 

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

	  Leaving  prob
	0       0   1.0
	1       1   1.0

	  Fire  prob
	0    0   1.0
	1    1   1.0

Eliminate variable: Tampering

Factors to multiply containing variable: Tampering

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Result of multiplication: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Elimination Order: ['Alarm', 'Leaving', 'Fire', 'Report', 'Tampering']

MAP Variables: ['Tampering', 'Report']

Observed Variables: {'Smoke': '1'}

Original Factors: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Factors with evidence applied: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

Result of multiplication: 

	   Tampering Leaving Fire Alarm      prob
	0          0       0    0     0  0.998900
	1          0       1    0     0  0.001000
	2          0       0    0     1  0.000012
	3          0       1    0     1  0.000088
	4          1       0    0     0  0.149850
	5          1       1    0     0  0.000150
	6          1       0    0     1  0.102000
	7          1       1    0     1  0.748000
	8          0       0    1     0  0.009990
	9          0       1    1     0  0.000010
	10         0       0    1     1  0.118800
	11         0       1    1     1  0.871200
	12         1       0    1     0  0.499500
	13         1       1    1     0  0.000500
	14         1       0    1     1  0.060000
	15         1       1    1     1  0.440000

Sum out Alarm

	  Tampering Leaving Fire      prob
	0         0       0    0  0.998912
	1         0       0    1  0.128790
	2         0       1    0  0.001088
	3         0       1    1  0.871210
	4         1       0    0  0.251850
	5         1       0    1  0.559500
	6         1       1    0  0.748150
	7         1       1    1  0.440500

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering Leaving Fire      prob
	0         0       0    0  0.998912
	1         0       0    1  0.128790
	2         0       1    0  0.001088
	3         0       1    1  0.871210
	4         1       0    0  0.251850
	5         1       0    1  0.559500
	6         1       1    0  0.748150
	7         1       1    1  0.440500

Eliminate variable: Leaving

Factors to multiply containing variable: Leaving

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Tampering Leaving Fire      prob
	0         0       0    0  0.998912
	1         0       0    1  0.128790
	2         0       1    0  0.001088
	3         0       1    1  0.871210
	4         1       0    0  0.251850
	5         1       0    1  0.559500
	6         1       1    0  0.748150
	7         1       1    1  0.440500

Result of multiplication: 

	   Report Leaving Fire Tampering      prob
	0       0       0    0         0  0.988923
	1       0       0    1         0  0.127502
	2       0       0    0         1  0.249331
	3       0       0    1         1  0.553905
	4       1       0    0         0  0.009989
	5       1       0    1         0  0.001288
	6       1       0    0         1  0.002518
	7       1       0    1         1  0.005595
	8       0       1    0         0  0.000272
	9       0       1    1         0  0.217802
	10      0       1    0         1  0.187037
	11      0       1    1         1  0.110125
	12      1       1    0         0  0.000816
	13      1       1    1         0  0.653407
	14      1       1    0         1  0.561113
	15      1       1    1         1  0.330375

Sum out Leaving

	  Report Fire Tampering      prob
	0      0    0         0  0.989195
	1      0    0         1  0.436369
	2      0    1         0  0.345305
	3      0    1         1  0.664030
	4      1    0         0  0.010805
	5      1    0         1  0.563631
	6      1    1         0  0.654695
	7      1    1         1  0.335970

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Report Fire Tampering      prob
	0      0    0         0  0.989195
	1      0    0         1  0.436369
	2      0    1         0  0.345305
	3      0    1         1  0.664030
	4      1    0         0  0.010805
	5      1    0         1  0.563631
	6      1    1         0  0.654695
	7      1    1         1  0.335970

Eliminate variable: Fire

Factors to multiply containing variable: Fire

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Report Fire Tampering      prob
	0      0    0         0  0.989195
	1      0    0         1  0.436369
	2      0    1         0  0.345305
	3      0    1         1  0.664030
	4      1    0         0  0.010805
	5      1    0         1  0.563631
	6      1    1         0  0.654695
	7      1    1         1  0.335970

Result of multiplication: 

	  Report Tampering Fire      prob
	0      0         0    0  0.009793
	1      0         1    0  0.004320
	2      1         0    0  0.000107
	3      1         1    0  0.005580
	4      0         0    1  0.003108
	5      0         1    1  0.005976
	6      1         0    1  0.005892
	7      1         1    1  0.003024

Sum out Fire

	  Report Tampering      prob
	0      0         0  0.012901
	1      0         1  0.010296
	2      1         0  0.005999
	3      1         1  0.008604

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Report Tampering      prob
	0      0         0  0.012901
	1      0         1  0.010296
	2      1         0  0.005999
	3      1         1  0.008604

Eliminate variable: Report

Factors to multiply containing variable: Report

	  Report Tampering      prob
	0      0         0  0.012901
	1      0         1  0.010296
	2      1         0  0.005999
	3      1         1  0.008604

Result of multiplication: 

	  Report Tampering      prob
	0      0         0  0.012901
	1      0         1  0.010296
	2      1         0  0.005999
	3      1         1  0.008604

Storing factor for backtracking to find value of Report

	  Report Tampering      prob
	0      0         0  0.012901
	1      0         1  0.010296
	2      1         0  0.005999
	3      1         1  0.008604

Maximise out Report

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

Eliminate variable: Tampering

Factors to multiply containing variable: Tampering

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

Result of multiplication: 

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Storing factor for backtracking to find value of Tampering

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

New List of Factors: 

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Finding MAP instantiation for Tampering

MAP assignment for variable Tampering is 0

Popped this factor from the backtracking stack:

	  Report Tampering      prob
	0      0         0  0.012901
	1      0         1  0.010296
	2      1         0  0.005999
	3      1         1  0.008604

Finding MAP instantiation for Report

MAP assignment for variable Report is 0

Final Map Instantiation:

Tampering->0

Report->0

Elimination Order: ['Smoke', 'Alarm', 'Leaving', 'Fire', 'Report', 'Tampering']

MAP Variables: ['Tampering', 'Report']

Observed Variables: {}

Original Factors: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Factors with evidence applied: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Eliminate variable: Smoke

Factors to multiply containing variable: Smoke

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

Result of multiplication: 

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

Sum out Smoke

	  Fire  prob
	0    0   1.0
	1    1   1.0

New List of Factors: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire  prob
	0    0   1.0
	1    1   1.0

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

Result of multiplication: 

	   Tampering Leaving Fire Alarm      prob
	0          0       0    0     0  0.998900
	1          0       1    0     0  0.001000
	2          0       0    0     1  0.000012
	3          0       1    0     1  0.000088
	4          1       0    0     0  0.149850
	5          1       1    0     0  0.000150
	6          1       0    0     1  0.102000
	7          1       1    0     1  0.748000
	8          0       0    1     0  0.009990
	9          0       1    1     0  0.000010
	10         0       0    1     1  0.118800
	11         0       1    1     1  0.871200
	12         1       0    1     0  0.499500
	13         1       1    1     0  0.000500
	14         1       0    1     1  0.060000
	15         1       1    1     1  0.440000

Sum out Alarm

	  Tampering Leaving Fire      prob
	0         0       0    0  0.998912
	1         0       0    1  0.128790
	2         0       1    0  0.001088
	3         0       1    1  0.871210
	4         1       0    0  0.251850
	5         1       0    1  0.559500
	6         1       1    0  0.748150
	7         1       1    1  0.440500

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire  prob
	0    0   1.0
	1    1   1.0

	  Tampering Leaving Fire      prob
	0         0       0    0  0.998912
	1         0       0    1  0.128790
	2         0       1    0  0.001088
	3         0       1    1  0.871210
	4         1       0    0  0.251850
	5         1       0    1  0.559500
	6         1       1    0  0.748150
	7         1       1    1  0.440500

Eliminate variable: Leaving

Factors to multiply containing variable: Leaving

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Tampering Leaving Fire      prob
	0         0       0    0  0.998912
	1         0       0    1  0.128790
	2         0       1    0  0.001088
	3         0       1    1  0.871210
	4         1       0    0  0.251850
	5         1       0    1  0.559500
	6         1       1    0  0.748150
	7         1       1    1  0.440500

Result of multiplication: 

	   Report Leaving Fire Tampering      prob
	0       0       0    0         0  0.988923
	1       0       0    1         0  0.127502
	2       0       0    0         1  0.249331
	3       0       0    1         1  0.553905
	4       1       0    0         0  0.009989
	5       1       0    1         0  0.001288
	6       1       0    0         1  0.002518
	7       1       0    1         1  0.005595
	8       0       1    0         0  0.000272
	9       0       1    1         0  0.217802
	10      0       1    0         1  0.187037
	11      0       1    1         1  0.110125
	12      1       1    0         0  0.000816
	13      1       1    1         0  0.653407
	14      1       1    0         1  0.561113
	15      1       1    1         1  0.330375

Sum out Leaving

	  Report Fire Tampering      prob
	0      0    0         0  0.989195
	1      0    0         1  0.436369
	2      0    1         0  0.345305
	3      0    1         1  0.664030
	4      1    0         0  0.010805
	5      1    0         1  0.563631
	6      1    1         0  0.654695
	7      1    1         1  0.335970

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire  prob
	0    0   1.0
	1    1   1.0

	  Report Fire Tampering      prob
	0      0    0         0  0.989195
	1      0    0         1  0.436369
	2      0    1         0  0.345305
	3      0    1         1  0.664030
	4      1    0         0  0.010805
	5      1    0         1  0.563631
	6      1    1         0  0.654695
	7      1    1         1  0.335970

Eliminate variable: Fire

Factors to multiply containing variable: Fire

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	0    0   1.0
	1    1   1.0

	  Report Fire Tampering      prob
	0      0    0         0  0.989195
	1      0    0         1  0.436369
	2      0    1         0  0.345305
	3      0    1         1  0.664030
	4      1    0         0  0.010805
	5      1    0         1  0.563631
	6      1    1         0  0.654695
	7      1    1         1  0.335970

Result of multiplication: 

	  Report Tampering Fire      prob
	0      0         0    0  0.979303
	1      0         1    0  0.432005
	2      1         0    0  0.010697
	3      1         1    0  0.557995
	4      0         0    1  0.003453
	5      0         1    1  0.006640
	6      1         0    1  0.006547
	7      1         1    1  0.003360

Sum out Fire

	  Report Tampering      prob
	0      0         0  0.982756
	1      0         1  0.438646
	2      1         0  0.017244
	3      1         1  0.561354

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Report Tampering      prob
	0      0         0  0.982756
	1      0         1  0.438646
	2      1         0  0.017244
	3      1         1  0.561354

Eliminate variable: Report

Factors to multiply containing variable: Report

	  Report Tampering      prob
	0      0         0  0.982756
	1      0         1  0.438646
	2      1         0  0.017244
	3      1         1  0.561354

Result of multiplication: 

	  Report Tampering      prob
	0      0         0  0.982756
	1      0         1  0.438646
	2      1         0  0.017244
	3      1         1  0.561354

Storing factor for backtracking to find value of Report

	  Report Tampering      prob
	0      0         0  0.982756
	1      0         1  0.438646
	2      1         0  0.017244
	3      1         1  0.561354

Maximise out Report

	  Tampering      prob
	0         0  0.982756
	1         1  0.561354

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.982756
	1         1  0.561354

Eliminate variable: Tampering

Factors to multiply containing variable: Tampering

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.982756
	1         1  0.561354

Result of multiplication: 

	  Tampering      prob
	0         0  0.963101
	1         1  0.011227

Storing factor for backtracking to find value of Tampering

	  Tampering      prob
	0         0  0.963101
	1         1  0.011227

New List of Factors: 

	  Tampering      prob
	0         0  0.963101
	1         1  0.011227

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	  Tampering      prob
	0         0  0.963101
	1         1  0.011227

Finding MAP instantiation for Tampering

MAP assignment for variable Tampering is 0

Popped this factor from the backtracking stack:

	  Report Tampering      prob
	0      0         0  0.982756
	1      0         1  0.438646
	2      1         0  0.017244
	3      1         1  0.561354

Finding MAP instantiation for Report

MAP assignment for variable Report is 0

Final Map Instantiation:

Tampering->0

Report->0

Elimination Order: ['Report', 'Smoke', 'Tampering', 'JohnCalls', 'MaryCalls', 'Fire', 'Leaving', 'Earthquake', 'Alarm']

MAP Variables: ['Alarm']

Observed Variables: {'Burglary': 'True'}

Original Factors: 

	   Alarm Burglary Earthquake   prob
	0   True     True       True  0.950
	1  False     True       True  0.050
	2   True    False       True  0.290
	3  False    False       True  0.710
	4   True     True      False  0.940
	5  False     True      False  0.060
	6   True    False      False  0.001
	7  False    False      False  0.999

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Burglary  prob
	0     True  0.01
	1    False  0.99

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Factors with evidence applied: 

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Eliminate variable: Report

Factors to multiply containing variable: Report

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

Result of multiplication: 

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

Sum out Report

	  Leaving  prob
	0       0   1.0
	1       1   1.0

New List of Factors: 

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

	  Leaving  prob
	0       0   1.0
	1       1   1.0

Eliminate variable: Smoke

Factors to multiply containing variable: Smoke

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

Result of multiplication: 

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

Sum out Smoke

	  Fire  prob
	0    0   1.0
	1    1   1.0

New List of Factors: 

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

	  Leaving  prob
	0       0   1.0
	1       1   1.0

	  Fire  prob
	0    0   1.0
	1    1   1.0

Eliminate variable: Tampering

Factors to multiply containing variable: Tampering

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Result of multiplication: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Elimination Order: ['Report', 'Smoke', 'Tampering', 'JohnCalls', 'MaryCalls', 'Fire', 'Leaving', 'Earthquake', 'Alarm']

MAP Variables: ['Alarm']

Observed Variables: {'Burglary': 'False'}

Original Factors: 

	   Alarm Burglary Earthquake   prob
	0   True     True       True  0.950
	1  False     True       True  0.050
	2   True    False       True  0.290
	3  False    False       True  0.710
	4   True     True      False  0.940
	5  False     True      False  0.060
	6   True    False      False  0.001
	7  False    False      False  0.999

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Burglary  prob
	0     True  0.01
	1    False  0.99

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Factors with evidence applied: 

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Eliminate variable: Report

Factors to multiply containing variable: Report

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

Result of multiplication: 

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

Sum out Report

	  Leaving  prob
	0       0   1.0
	1       1   1.0

New List of Factors: 

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

	  Leaving  prob
	0       0   1.0
	1       1   1.0

Eliminate variable: Smoke

Factors to multiply containing variable: Smoke

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

Result of multiplication: 

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

Sum out Smoke

	  Fire  prob
	0    0   1.0
	1    1   1.0

New List of Factors: 

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

	  Leaving  prob
	0       0   1.0
	1       1   1.0

	  Fire  prob
	0    0   1.0
	1    1   1.0

Eliminate variable: Tampering

Factors to multiply containing variable: Tampering

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Result of multiplication: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Elimination Order: ['Alarm', 'Leaving', 'Fire', 'Report', 'Tampering']

MAP Variables: ['Tampering', 'Report']

Observed Variables: {'Smoke': '1'}

Original Factors: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Factors with evidence applied: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

Result of multiplication: 

	   Leaving Tampering Fire Alarm      prob
	0        0         0    0     0  0.998900
	1        1         0    0     0  0.001000
	2        0         0    0     1  0.000012
	3        1         0    0     1  0.000088
	4        0         1    0     0  0.149850
	5        1         1    0     0  0.000150
	6        0         1    0     1  0.102000
	7        1         1    0     1  0.748000
	8        0         0    1     0  0.009990
	9        1         0    1     0  0.000010
	10       0         0    1     1  0.118800
	11       1         0    1     1  0.871200
	12       0         1    1     0  0.499500
	13       1         1    1     0  0.000500
	14       0         1    1     1  0.060000
	15       1         1    1     1  0.440000

Sum out Alarm

	  Leaving Tampering Fire      prob
	0       0         0    0  0.998912
	1       0         0    1  0.128790
	2       0         1    0  0.251850
	3       0         1    1  0.559500
	4       1         0    0  0.001088
	5       1         0    1  0.871210
	6       1         1    0  0.748150
	7       1         1    1  0.440500

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Leaving Tampering Fire      prob
	0       0         0    0  0.998912
	1       0         0    1  0.128790
	2       0         1    0  0.251850
	3       0         1    1  0.559500
	4       1         0    0  0.001088
	5       1         0    1  0.871210
	6       1         1    0  0.748150
	7       1         1    1  0.440500

Eliminate variable: Leaving

Factors to multiply containing variable: Leaving

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Leaving Tampering Fire      prob
	0       0         0    0  0.998912
	1       0         0    1  0.128790
	2       0         1    0  0.251850
	3       0         1    1  0.559500
	4       1         0    0  0.001088
	5       1         0    1  0.871210
	6       1         1    0  0.748150
	7       1         1    1  0.440500

Result of multiplication: 

	   Tampering Fire Leaving Report      prob
	0          0    0       0      0  0.988923
	1          0    1       0      0  0.127502
	2          1    0       0      0  0.249331
	3          1    1       0      0  0.553905
	4          0    0       0      1  0.009989
	5          0    1       0      1  0.001288
	6          1    0       0      1  0.002518
	7          1    1       0      1  0.005595
	8          0    0       1      0  0.000272
	9          0    1       1      0  0.217802
	10         1    0       1      0  0.187037
	11         1    1       1      0  0.110125
	12         0    0       1      1  0.000816
	13         0    1       1      1  0.653407
	14         1    0       1      1  0.561113
	15         1    1       1      1  0.330375

Sum out Leaving

	  Tampering Fire Report      prob
	0         0    0      0  0.989195
	1         0    0      1  0.010805
	2         0    1      0  0.345305
	3         0    1      1  0.654695
	4         1    0      0  0.436369
	5         1    0      1  0.563631
	6         1    1      0  0.664030
	7         1    1      1  0.335970

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering Fire Report      prob
	0         0    0      0  0.989195
	1         0    0      1  0.010805
	2         0    1      0  0.345305
	3         0    1      1  0.654695
	4         1    0      0  0.436369
	5         1    0      1  0.563631
	6         1    1      0  0.664030
	7         1    1      1  0.335970

Eliminate variable: Fire

Factors to multiply containing variable: Fire

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering Fire Report      prob
	0         0    0      0  0.989195
	1         0    0      1  0.010805
	2         0    1      0  0.345305
	3         0    1      1  0.654695
	4         1    0      0  0.436369
	5         1    0      1  0.563631
	6         1    1      0  0.664030
	7         1    1      1  0.335970

Result of multiplication: 

	  Tampering Fire Report      prob
	0         0    0      0  0.009793
	1         0    0      1  0.000107
	2         1    0      0  0.004320
	3         1    0      1  0.005580
	4         0    1      0  0.003108
	5         0    1      1  0.005892
	6         1    1      0  0.005976
	7         1    1      1  0.003024

Sum out Fire

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Eliminate variable: Report

Factors to multiply containing variable: Report

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Result of multiplication: 

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Storing factor for backtracking to find value of Report

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Maximise out Report

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

Eliminate variable: Tampering

Factors to multiply containing variable: Tampering

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

Result of multiplication: 

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Storing factor for backtracking to find value of Tampering

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

New List of Factors: 

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Finding MAP instantiation for Tampering

MAP assignment for variable Tampering is 0

Popped this factor from the backtracking stack:

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Finding MAP instantiation for Report

MAP assignment for variable Report is 0

Final Map Instantiation:

Tampering->0

Report->0

Elimination Order: ['Smoke', 'Alarm', 'Leaving', 'Fire', 'Report', 'Tampering']

MAP Variables: ['Tampering', 'Report']

Observed Variables: {}

Original Factors: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Factors with evidence applied: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Eliminate variable: Smoke

Factors to multiply containing variable: Smoke

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

Result of multiplication: 

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

Sum out Smoke

	  Fire  prob
	0    0   1.0
	1    1   1.0

New List of Factors: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire  prob
	0    0   1.0
	1    1   1.0

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

Result of multiplication: 

	   Leaving Tampering Fire Alarm      prob
	0        0         0    0     0  0.998900
	1        1         0    0     0  0.001000
	2        0         0    0     1  0.000012
	3        1         0    0     1  0.000088
	4        0         1    0     0  0.149850
	5        1         1    0     0  0.000150
	6        0         1    0     1  0.102000
	7        1         1    0     1  0.748000
	8        0         0    1     0  0.009990
	9        1         0    1     0  0.000010
	10       0         0    1     1  0.118800
	11       1         0    1     1  0.871200
	12       0         1    1     0  0.499500
	13       1         1    1     0  0.000500
	14       0         1    1     1  0.060000
	15       1         1    1     1  0.440000

Sum out Alarm

	  Leaving Tampering Fire      prob
	0       0         0    0  0.998912
	1       0         0    1  0.128790
	2       0         1    0  0.251850
	3       0         1    1  0.559500
	4       1         0    0  0.001088
	5       1         0    1  0.871210
	6       1         1    0  0.748150
	7       1         1    1  0.440500

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire  prob
	0    0   1.0
	1    1   1.0

	  Leaving Tampering Fire      prob
	0       0         0    0  0.998912
	1       0         0    1  0.128790
	2       0         1    0  0.251850
	3       0         1    1  0.559500
	4       1         0    0  0.001088
	5       1         0    1  0.871210
	6       1         1    0  0.748150
	7       1         1    1  0.440500

Eliminate variable: Leaving

Factors to multiply containing variable: Leaving

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Leaving Tampering Fire      prob
	0       0         0    0  0.998912
	1       0         0    1  0.128790
	2       0         1    0  0.251850
	3       0         1    1  0.559500
	4       1         0    0  0.001088
	5       1         0    1  0.871210
	6       1         1    0  0.748150
	7       1         1    1  0.440500

Result of multiplication: 

	   Tampering Fire Leaving Report      prob
	0          0    0       0      0  0.988923
	1          0    1       0      0  0.127502
	2          1    0       0      0  0.249331
	3          1    1       0      0  0.553905
	4          0    0       0      1  0.009989
	5          0    1       0      1  0.001288
	6          1    0       0      1  0.002518
	7          1    1       0      1  0.005595
	8          0    0       1      0  0.000272
	9          0    1       1      0  0.217802
	10         1    0       1      0  0.187037
	11         1    1       1      0  0.110125
	12         0    0       1      1  0.000816
	13         0    1       1      1  0.653407
	14         1    0       1      1  0.561113
	15         1    1       1      1  0.330375

Sum out Leaving

	  Tampering Fire Report      prob
	0         0    0      0  0.989195
	1         0    0      1  0.010805
	2         0    1      0  0.345305
	3         0    1      1  0.654695
	4         1    0      0  0.436369
	5         1    0      1  0.563631
	6         1    1      0  0.664030
	7         1    1      1  0.335970

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire  prob
	0    0   1.0
	1    1   1.0

	  Tampering Fire Report      prob
	0         0    0      0  0.989195
	1         0    0      1  0.010805
	2         0    1      0  0.345305
	3         0    1      1  0.654695
	4         1    0      0  0.436369
	5         1    0      1  0.563631
	6         1    1      0  0.664030
	7         1    1      1  0.335970

Eliminate variable: Fire

Factors to multiply containing variable: Fire

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	0    0   1.0
	1    1   1.0

	  Tampering Fire Report      prob
	0         0    0      0  0.989195
	1         0    0      1  0.010805
	2         0    1      0  0.345305
	3         0    1      1  0.654695
	4         1    0      0  0.436369
	5         1    0      1  0.563631
	6         1    1      0  0.664030
	7         1    1      1  0.335970

Result of multiplication: 

	  Tampering Fire Report      prob
	0         0    0      0  0.979303
	1         0    0      1  0.010697
	2         1    0      0  0.432005
	3         1    0      1  0.557995
	4         0    1      0  0.003453
	5         0    1      1  0.006547
	6         1    1      0  0.006640
	7         1    1      1  0.003360

Sum out Fire

	  Tampering Report      prob
	0         0      0  0.982756
	1         0      1  0.017244
	2         1      0  0.438646
	3         1      1  0.561354

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering Report      prob
	0         0      0  0.982756
	1         0      1  0.017244
	2         1      0  0.438646
	3         1      1  0.561354

Eliminate variable: Report

Factors to multiply containing variable: Report

	  Tampering Report      prob
	0         0      0  0.982756
	1         0      1  0.017244
	2         1      0  0.438646
	3         1      1  0.561354

Result of multiplication: 

	  Tampering Report      prob
	0         0      0  0.982756
	1         0      1  0.017244
	2         1      0  0.438646
	3         1      1  0.561354

Storing factor for backtracking to find value of Report

	  Tampering Report      prob
	0         0      0  0.982756
	1         0      1  0.017244
	2         1      0  0.438646
	3         1      1  0.561354

Maximise out Report

	  Tampering      prob
	0         0  0.982756
	1         1  0.561354

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.982756
	1         1  0.561354

Eliminate variable: Tampering

Factors to multiply containing variable: Tampering

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.982756
	1         1  0.561354

Result of multiplication: 

	  Tampering      prob
	0         0  0.963101
	1         1  0.011227

Storing factor for backtracking to find value of Tampering

	  Tampering      prob
	0         0  0.963101
	1         1  0.011227

New List of Factors: 

	  Tampering      prob
	0         0  0.963101
	1         1  0.011227

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	  Tampering      prob
	0         0  0.963101
	1         1  0.011227

Finding MAP instantiation for Tampering

MAP assignment for variable Tampering is 0

Popped this factor from the backtracking stack:

	  Tampering Report      prob
	0         0      0  0.982756
	1         0      1  0.017244
	2         1      0  0.438646
	3         1      1  0.561354

Finding MAP instantiation for Report

MAP assignment for variable Report is 0

Final Map Instantiation:

Tampering->0

Report->0

Elimination Order: ['JohnCalls', 'MaryCalls', 'Earthquake', 'Alarm']

MAP Variables: ['Alarm']

Observed Variables: {'Burglary': 'True'}

Original Factors: 

	  Burglary  prob
	0     True  0.01
	1    False  0.99

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Burglary Earthquake   prob
	0   True     True       True  0.950
	1  False     True       True  0.050
	2   True    False       True  0.290
	3  False    False       True  0.710
	4   True     True      False  0.940
	5  False     True      False  0.060
	6   True    False      False  0.001
	7  False    False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Factors with evidence applied: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Eliminate variable: JohnCalls

Factors to multiply containing variable: JohnCalls

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Result of multiplication: 

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Sum out JohnCalls

	   Alarm  prob
	0  False   1.0
	1   True   1.0

New List of Factors: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

	   Alarm  prob
	0  False   1.0
	1   True   1.0

Eliminate variable: MaryCalls

Factors to multiply containing variable: MaryCalls

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Result of multiplication: 

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Sum out MaryCalls

	   Alarm  prob
	0  False   1.0
	1   True   1.0

New List of Factors: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

Eliminate variable: Earthquake

Factors to multiply containing variable: Earthquake

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

Result of multiplication: 

	  Earthquake  Alarm    prob
	0       True   True  0.0190
	1       True  False  0.0010
	2      False   True  0.9212
	3      False  False  0.0588

Sum out Earthquake

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

New List of Factors: 

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Result of multiplication: 

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Storing factor for backtracking to find value of Alarm

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

New List of Factors: 

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Finding MAP instantiation for Alarm

MAP assignment for variable Alarm is True

Final Map Instantiation:

Alarm->True

Elimination Order: ['JohnCalls', 'MaryCalls', 'Earthquake', 'Alarm']

MAP Variables: ['Alarm']

Observed Variables: {'Burglary': 'False'}

Original Factors: 

	  Burglary  prob
	0     True  0.01
	1    False  0.99

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Burglary Earthquake   prob
	0   True     True       True  0.950
	1  False     True       True  0.050
	2   True    False       True  0.290
	3  False    False       True  0.710
	4   True     True      False  0.940
	5  False     True      False  0.060
	6   True    False      False  0.001
	7  False    False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Factors with evidence applied: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Eliminate variable: JohnCalls

Factors to multiply containing variable: JohnCalls

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Result of multiplication: 

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Sum out JohnCalls

	   Alarm  prob
	0  False   1.0
	1   True   1.0

New List of Factors: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

	   Alarm  prob
	0  False   1.0
	1   True   1.0

Eliminate variable: MaryCalls

Factors to multiply containing variable: MaryCalls

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Result of multiplication: 

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Sum out MaryCalls

	   Alarm  prob
	0  False   1.0
	1   True   1.0

New List of Factors: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

Eliminate variable: Earthquake

Factors to multiply containing variable: Earthquake

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

Result of multiplication: 

	  Earthquake  Alarm     prob
	0       True   True  0.00580
	1       True  False  0.01420
	2      False   True  0.00098
	3      False  False  0.97902

Sum out Earthquake

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

New List of Factors: 

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

Result of multiplication: 

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

Storing factor for backtracking to find value of Alarm

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

New List of Factors: 

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

Finding MAP instantiation for Alarm

MAP assignment for variable Alarm is False

Final Map Instantiation:

Alarm->False

Elimination Order: ['Alarm', 'Leaving', 'Fire', 'Report', 'Tampering']

MAP Variables: ['Tampering', 'Report']

Observed Variables: {'Smoke': '1'}

Original Factors: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Factors with evidence applied: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

Result of multiplication: 

	   Alarm Leaving Tampering Fire      prob
	0      0       0         0    0  0.998900
	1      0       1         0    0  0.001000
	2      1       0         0    0  0.000012
	3      1       1         0    0  0.000088
	4      0       0         1    0  0.149850
	5      0       1         1    0  0.000150
	6      1       0         1    0  0.102000
	7      1       1         1    0  0.748000
	8      0       0         0    1  0.009990
	9      0       1         0    1  0.000010
	10     1       0         0    1  0.118800
	11     1       1         0    1  0.871200
	12     0       0         1    1  0.499500
	13     0       1         1    1  0.000500
	14     1       0         1    1  0.060000
	15     1       1         1    1  0.440000

Sum out Alarm

	  Leaving Tampering Fire      prob
	0       0         0    0  0.998912
	1       0         0    1  0.128790
	2       0         1    0  0.251850
	3       0         1    1  0.559500
	4       1         0    0  0.001088
	5       1         0    1  0.871210
	6       1         1    0  0.748150
	7       1         1    1  0.440500

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Leaving Tampering Fire      prob
	0       0         0    0  0.998912
	1       0         0    1  0.128790
	2       0         1    0  0.251850
	3       0         1    1  0.559500
	4       1         0    0  0.001088
	5       1         0    1  0.871210
	6       1         1    0  0.748150
	7       1         1    1  0.440500

Eliminate variable: Leaving

Factors to multiply containing variable: Leaving

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Leaving Tampering Fire      prob
	0       0         0    0  0.998912
	1       0         0    1  0.128790
	2       0         1    0  0.251850
	3       0         1    1  0.559500
	4       1         0    0  0.001088
	5       1         0    1  0.871210
	6       1         1    0  0.748150
	7       1         1    1  0.440500

Result of multiplication: 

	   Report Leaving Tampering Fire      prob
	0       0       0         0    0  0.988923
	1       0       0         0    1  0.127502
	2       0       0         1    0  0.249331
	3       0       0         1    1  0.553905
	4       1       0         0    0  0.009989
	5       1       0         0    1  0.001288
	6       1       0         1    0  0.002518
	7       1       0         1    1  0.005595
	8       0       1         0    0  0.000272
	9       0       1         0    1  0.217802
	10      0       1         1    0  0.187037
	11      0       1         1    1  0.110125
	12      1       1         0    0  0.000816
	13      1       1         0    1  0.653407
	14      1       1         1    0  0.561113
	15      1       1         1    1  0.330375

Sum out Leaving

	  Report Tampering Fire      prob
	0      0         0    0  0.989195
	1      0         0    1  0.345305
	2      0         1    0  0.436369
	3      0         1    1  0.664030
	4      1         0    0  0.010805
	5      1         0    1  0.654695
	6      1         1    0  0.563631
	7      1         1    1  0.335970

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Report Tampering Fire      prob
	0      0         0    0  0.989195
	1      0         0    1  0.345305
	2      0         1    0  0.436369
	3      0         1    1  0.664030
	4      1         0    0  0.010805
	5      1         0    1  0.654695
	6      1         1    0  0.563631
	7      1         1    1  0.335970

Eliminate variable: Fire

Factors to multiply containing variable: Fire

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Report Tampering Fire      prob
	0      0         0    0  0.989195
	1      0         0    1  0.345305
	2      0         1    0  0.436369
	3      0         1    1  0.664030
	4      1         0    0  0.010805
	5      1         0    1  0.654695
	6      1         1    0  0.563631
	7      1         1    1  0.335970

Result of multiplication: 

	  Report Tampering Fire      prob
	0      0         0    0  0.009793
	1      0         1    0  0.004320
	2      1         0    0  0.000107
	3      1         1    0  0.005580
	4      0         0    1  0.003108
	5      0         1    1  0.005976
	6      1         0    1  0.005892
	7      1         1    1  0.003024

Sum out Fire

	  Report Tampering      prob
	0      0         0  0.012901
	1      0         1  0.010296
	2      1         0  0.005999
	3      1         1  0.008604

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Report Tampering      prob
	0      0         0  0.012901
	1      0         1  0.010296
	2      1         0  0.005999
	3      1         1  0.008604

Eliminate variable: Report

Factors to multiply containing variable: Report

	  Report Tampering      prob
	0      0         0  0.012901
	1      0         1  0.010296
	2      1         0  0.005999
	3      1         1  0.008604

Result of multiplication: 

	  Report Tampering      prob
	0      0         0  0.012901
	1      0         1  0.010296
	2      1         0  0.005999
	3      1         1  0.008604

Storing factor for backtracking to find value of Report

	  Report Tampering      prob
	0      0         0  0.012901
	1      0         1  0.010296
	2      1         0  0.005999
	3      1         1  0.008604

Maximise out Report

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

Eliminate variable: Tampering

Factors to multiply containing variable: Tampering

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

Result of multiplication: 

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Storing factor for backtracking to find value of Tampering

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

New List of Factors: 

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Finding MAP instantiation for Tampering

MAP assignment for variable Tampering is 0

Popped this factor from the backtracking stack:

	  Report Tampering      prob
	0      0         0  0.012901
	1      0         1  0.010296
	2      1         0  0.005999
	3      1         1  0.008604

Finding MAP instantiation for Report

MAP assignment for variable Report is 0

Final Map Instantiation:

Tampering->0

Report->0

Elimination Order: ['Smoke', 'Alarm', 'Leaving', 'Fire', 'Report', 'Tampering']

MAP Variables: ['Tampering', 'Report']

Observed Variables: {}

Original Factors: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Factors with evidence applied: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Eliminate variable: Smoke

Factors to multiply containing variable: Smoke

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

Result of multiplication: 

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

Sum out Smoke

	  Fire  prob
	0    0   1.0
	1    1   1.0

New List of Factors: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire  prob
	0    0   1.0
	1    1   1.0

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

Result of multiplication: 

	   Alarm Leaving Tampering Fire      prob
	0      0       0         0    0  0.998900
	1      0       1         0    0  0.001000
	2      1       0         0    0  0.000012
	3      1       1         0    0  0.000088
	4      0       0         1    0  0.149850
	5      0       1         1    0  0.000150
	6      1       0         1    0  0.102000
	7      1       1         1    0  0.748000
	8      0       0         0    1  0.009990
	9      0       1         0    1  0.000010
	10     1       0         0    1  0.118800
	11     1       1         0    1  0.871200
	12     0       0         1    1  0.499500
	13     0       1         1    1  0.000500
	14     1       0         1    1  0.060000
	15     1       1         1    1  0.440000

Sum out Alarm

	  Leaving Tampering Fire      prob
	0       0         0    0  0.998912
	1       0         0    1  0.128790
	2       0         1    0  0.251850
	3       0         1    1  0.559500
	4       1         0    0  0.001088
	5       1         0    1  0.871210
	6       1         1    0  0.748150
	7       1         1    1  0.440500

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire  prob
	0    0   1.0
	1    1   1.0

	  Leaving Tampering Fire      prob
	0       0         0    0  0.998912
	1       0         0    1  0.128790
	2       0         1    0  0.251850
	3       0         1    1  0.559500
	4       1         0    0  0.001088
	5       1         0    1  0.871210
	6       1         1    0  0.748150
	7       1         1    1  0.440500

Eliminate variable: Leaving

Factors to multiply containing variable: Leaving

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Leaving Tampering Fire      prob
	0       0         0    0  0.998912
	1       0         0    1  0.128790
	2       0         1    0  0.251850
	3       0         1    1  0.559500
	4       1         0    0  0.001088
	5       1         0    1  0.871210
	6       1         1    0  0.748150
	7       1         1    1  0.440500

Result of multiplication: 

	   Report Leaving Tampering Fire      prob
	0       0       0         0    0  0.988923
	1       0       0         0    1  0.127502
	2       0       0         1    0  0.249331
	3       0       0         1    1  0.553905
	4       1       0         0    0  0.009989
	5       1       0         0    1  0.001288
	6       1       0         1    0  0.002518
	7       1       0         1    1  0.005595
	8       0       1         0    0  0.000272
	9       0       1         0    1  0.217802
	10      0       1         1    0  0.187037
	11      0       1         1    1  0.110125
	12      1       1         0    0  0.000816
	13      1       1         0    1  0.653407
	14      1       1         1    0  0.561113
	15      1       1         1    1  0.330375

Sum out Leaving

	  Report Tampering Fire      prob
	0      0         0    0  0.989195
	1      0         0    1  0.345305
	2      0         1    0  0.436369
	3      0         1    1  0.664030
	4      1         0    0  0.010805
	5      1         0    1  0.654695
	6      1         1    0  0.563631
	7      1         1    1  0.335970

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire  prob
	0    0   1.0
	1    1   1.0

	  Report Tampering Fire      prob
	0      0         0    0  0.989195
	1      0         0    1  0.345305
	2      0         1    0  0.436369
	3      0         1    1  0.664030
	4      1         0    0  0.010805
	5      1         0    1  0.654695
	6      1         1    0  0.563631
	7      1         1    1  0.335970

Eliminate variable: Fire

Factors to multiply containing variable: Fire

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	0    0   1.0
	1    1   1.0

	  Report Tampering Fire      prob
	0      0         0    0  0.989195
	1      0         0    1  0.345305
	2      0         1    0  0.436369
	3      0         1    1  0.664030
	4      1         0    0  0.010805
	5      1         0    1  0.654695
	6      1         1    0  0.563631
	7      1         1    1  0.335970

Result of multiplication: 

	  Report Tampering Fire      prob
	0      0         0    0  0.979303
	1      0         1    0  0.432005
	2      1         0    0  0.010697
	3      1         1    0  0.557995
	4      0         0    1  0.003453
	5      0         1    1  0.006640
	6      1         0    1  0.006547
	7      1         1    1  0.003360

Sum out Fire

	  Report Tampering      prob
	0      0         0  0.982756
	1      0         1  0.438646
	2      1         0  0.017244
	3      1         1  0.561354

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Report Tampering      prob
	0      0         0  0.982756
	1      0         1  0.438646
	2      1         0  0.017244
	3      1         1  0.561354

Eliminate variable: Report

Factors to multiply containing variable: Report

	  Report Tampering      prob
	0      0         0  0.982756
	1      0         1  0.438646
	2      1         0  0.017244
	3      1         1  0.561354

Result of multiplication: 

	  Report Tampering      prob
	0      0         0  0.982756
	1      0         1  0.438646
	2      1         0  0.017244
	3      1         1  0.561354

Storing factor for backtracking to find value of Report

	  Report Tampering      prob
	0      0         0  0.982756
	1      0         1  0.438646
	2      1         0  0.017244
	3      1         1  0.561354

Maximise out Report

	  Tampering      prob
	0         0  0.982756
	1         1  0.561354

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.982756
	1         1  0.561354

Eliminate variable: Tampering

Factors to multiply containing variable: Tampering

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.982756
	1         1  0.561354

Result of multiplication: 

	  Tampering      prob
	0         0  0.963101
	1         1  0.011227

Storing factor for backtracking to find value of Tampering

	  Tampering      prob
	0         0  0.963101
	1         1  0.011227

New List of Factors: 

	  Tampering      prob
	0         0  0.963101
	1         1  0.011227

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	  Tampering      prob
	0         0  0.963101
	1         1  0.011227

Finding MAP instantiation for Tampering

MAP assignment for variable Tampering is 0

Popped this factor from the backtracking stack:

	  Report Tampering      prob
	0      0         0  0.982756
	1      0         1  0.438646
	2      1         0  0.017244
	3      1         1  0.561354

Finding MAP instantiation for Report

MAP assignment for variable Report is 0

Final Map Instantiation:

Tampering->0

Report->0

Elimination Order: ['Alarm', 'Leaving', 'Tampering', 'Fire']

MAP Variables: ['Tampering', 'Fire']

Observed Variables: {'Smoke': '1', 'Report': '1'}

Original Factors: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Factors with evidence applied: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Leaving  prob
	1       0  0.01
	3       1  0.75

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

Result of multiplication: 

	   Alarm Leaving Tampering Fire      prob
	0      0       0         0    0  0.998900
	1      0       1         0    0  0.001000
	2      1       0         0    0  0.000012
	3      1       1         0    0  0.000088
	4      0       0         1    0  0.149850
	5      0       1         1    0  0.000150
	6      1       0         1    0  0.102000
	7      1       1         1    0  0.748000
	8      0       0         0    1  0.009990
	9      0       1         0    1  0.000010
	10     1       0         0    1  0.118800
	11     1       1         0    1  0.871200
	12     0       0         1    1  0.499500
	13     0       1         1    1  0.000500
	14     1       0         1    1  0.060000
	15     1       1         1    1  0.440000

Sum out Alarm

	  Leaving Tampering Fire      prob
	0       0         0    0  0.998912
	1       0         0    1  0.128790
	2       0         1    0  0.251850
	3       0         1    1  0.559500
	4       1         0    0  0.001088
	5       1         0    1  0.871210
	6       1         1    0  0.748150
	7       1         1    1  0.440500

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving  prob
	1       0  0.01
	3       1  0.75

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Leaving Tampering Fire      prob
	0       0         0    0  0.998912
	1       0         0    1  0.128790
	2       0         1    0  0.251850
	3       0         1    1  0.559500
	4       1         0    0  0.001088
	5       1         0    1  0.871210
	6       1         1    0  0.748150
	7       1         1    1  0.440500

Eliminate variable: Leaving

Factors to multiply containing variable: Leaving

	  Leaving  prob
	1       0  0.01
	3       1  0.75

	  Leaving Tampering Fire      prob
	0       0         0    0  0.998912
	1       0         0    1  0.128790
	2       0         1    0  0.251850
	3       0         1    1  0.559500
	4       1         0    0  0.001088
	5       1         0    1  0.871210
	6       1         1    0  0.748150
	7       1         1    1  0.440500

Result of multiplication: 

	  Leaving Tampering Fire      prob
	0       0         0    0  0.009989
	1       0         0    1  0.001288
	2       0         1    0  0.002518
	3       0         1    1  0.005595
	4       1         0    0  0.000816
	5       1         0    1  0.653407
	6       1         1    0  0.561113
	7       1         1    1  0.330375

Sum out Leaving

	  Tampering Fire      prob
	0         0    0  0.010805
	1         0    1  0.654695
	2         1    0  0.563631
	3         1    1  0.335970

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering Fire      prob
	0         0    0  0.010805
	1         0    1  0.654695
	2         1    0  0.563631
	3         1    1  0.335970

Eliminate variable: Tampering

Factors to multiply containing variable: Tampering

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering Fire      prob
	0         0    0  0.010805
	1         0    1  0.654695
	2         1    0  0.563631
	3         1    1  0.335970

Result of multiplication: 

	  Tampering Fire      prob
	0         0    0  0.010589
	1         0    1  0.641601
	2         1    0  0.011273
	3         1    1  0.006719

Storing factor for backtracking to find value of Tampering

	  Tampering Fire      prob
	0         0    0  0.010589
	1         0    1  0.641601
	2         1    0  0.011273
	3         1    1  0.006719

Maximise out Tampering

	  Fire      prob
	0    0  0.011273
	1    1  0.641601

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Fire      prob
	0    0  0.011273
	1    1  0.641601

Eliminate variable: Fire

Factors to multiply containing variable: Fire

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Fire      prob
	0    0  0.011273
	1    1  0.641601

Result of multiplication: 

	  Fire      prob
	0    0  0.000112
	1    1  0.005774

Storing factor for backtracking to find value of Fire

	  Fire      prob
	0    0  0.000112
	1    1  0.005774

New List of Factors: 

	  Fire      prob
	0    0  0.000112
	1    1  0.005774

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	  Fire      prob
	0    0  0.000112
	1    1  0.005774

Finding MAP instantiation for Fire

MAP assignment for variable Fire is 1

Popped this factor from the backtracking stack:

	  Tampering Fire      prob
	0         0    0  0.010589
	1         0    1  0.641601
	2         1    0  0.011273
	3         1    1  0.006719

Finding MAP instantiation for Tampering

Elimination Order: ['JohnCalls', 'MaryCalls', 'Earthquake', 'Alarm']

MAP Variables: ['Alarm']

Observed Variables: {'Burglary': 'True'}

Original Factors: 

	  Burglary  prob
	0     True  0.01
	1    False  0.99

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Burglary Earthquake   prob
	0   True     True       True  0.950
	1  False     True       True  0.050
	2   True    False       True  0.290
	3  False    False       True  0.710
	4   True     True      False  0.940
	5  False     True      False  0.060
	6   True    False      False  0.001
	7  False    False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Factors with evidence applied: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Eliminate variable: JohnCalls

Factors to multiply containing variable: JohnCalls

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Result of multiplication: 

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Sum out JohnCalls

	   Alarm  prob
	0  False   1.0
	1   True   1.0

New List of Factors: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

	   Alarm  prob
	0  False   1.0
	1   True   1.0

Eliminate variable: MaryCalls

Factors to multiply containing variable: MaryCalls

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Result of multiplication: 

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Sum out MaryCalls

	   Alarm  prob
	0  False   1.0
	1   True   1.0

New List of Factors: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

Eliminate variable: Earthquake

Factors to multiply containing variable: Earthquake

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

Result of multiplication: 

	   Alarm Earthquake    prob
	0   True       True  0.0190
	1  False       True  0.0010
	2   True      False  0.9212
	3  False      False  0.0588

Sum out Earthquake

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

New List of Factors: 

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Result of multiplication: 

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Storing factor for backtracking to find value of Alarm

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

New List of Factors: 

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Finding MAP instantiation for Alarm

MAP assignment for variable Alarm is True

Final Map Instantiation:

Alarm->True

Elimination Order: ['JohnCalls', 'MaryCalls', 'Earthquake', 'Alarm']

MAP Variables: ['Alarm']

Observed Variables: {'Burglary': 'False'}

Original Factors: 

	  Burglary  prob
	0     True  0.01
	1    False  0.99

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Burglary Earthquake   prob
	0   True     True       True  0.950
	1  False     True       True  0.050
	2   True    False       True  0.290
	3  False    False       True  0.710
	4   True     True      False  0.940
	5  False     True      False  0.060
	6   True    False      False  0.001
	7  False    False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Factors with evidence applied: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Eliminate variable: JohnCalls

Factors to multiply containing variable: JohnCalls

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Result of multiplication: 

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Sum out JohnCalls

	   Alarm  prob
	0  False   1.0
	1   True   1.0

New List of Factors: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

	   Alarm  prob
	0  False   1.0
	1   True   1.0

Eliminate variable: MaryCalls

Factors to multiply containing variable: MaryCalls

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Result of multiplication: 

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Sum out MaryCalls

	   Alarm  prob
	0  False   1.0
	1   True   1.0

New List of Factors: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

Eliminate variable: Earthquake

Factors to multiply containing variable: Earthquake

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

Result of multiplication: 

	   Alarm Earthquake     prob
	0   True       True  0.00580
	1  False       True  0.01420
	2   True      False  0.00098
	3  False      False  0.97902

Sum out Earthquake

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

New List of Factors: 

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

Result of multiplication: 

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

Storing factor for backtracking to find value of Alarm

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

New List of Factors: 

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

Finding MAP instantiation for Alarm

MAP assignment for variable Alarm is False

Final Map Instantiation:

Alarm->False

Elimination Order: ['Alarm', 'Leaving', 'Fire', 'Report', 'Tampering']

MAP Variables: ['Tampering', 'Report']

Observed Variables: {'Smoke': '1'}

Original Factors: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Factors with evidence applied: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

Result of multiplication: 

	   Leaving Alarm Tampering Fire      prob
	0        0     0         0    0  0.998900
	1        1     0         0    0  0.001000
	2        0     1         0    0  0.000012
	3        1     1         0    0  0.000088
	4        0     0         1    0  0.149850
	5        1     0         1    0  0.000150
	6        0     1         1    0  0.102000
	7        1     1         1    0  0.748000
	8        0     0         0    1  0.009990
	9        1     0         0    1  0.000010
	10       0     1         0    1  0.118800
	11       1     1         0    1  0.871200
	12       0     0         1    1  0.499500
	13       1     0         1    1  0.000500
	14       0     1         1    1  0.060000
	15       1     1         1    1  0.440000

Sum out Alarm

	  Leaving Tampering Fire      prob
	0       0         0    0  0.998912
	1       0         0    1  0.128790
	2       0         1    0  0.251850
	3       0         1    1  0.559500
	4       1         0    0  0.001088
	5       1         0    1  0.871210
	6       1         1    0  0.748150
	7       1         1    1  0.440500

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Leaving Tampering Fire      prob
	0       0         0    0  0.998912
	1       0         0    1  0.128790
	2       0         1    0  0.251850
	3       0         1    1  0.559500
	4       1         0    0  0.001088
	5       1         0    1  0.871210
	6       1         1    0  0.748150
	7       1         1    1  0.440500

Eliminate variable: Leaving

Factors to multiply containing variable: Leaving

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Leaving Tampering Fire      prob
	0       0         0    0  0.998912
	1       0         0    1  0.128790
	2       0         1    0  0.251850
	3       0         1    1  0.559500
	4       1         0    0  0.001088
	5       1         0    1  0.871210
	6       1         1    0  0.748150
	7       1         1    1  0.440500

Result of multiplication: 

	   Leaving Report Tampering Fire      prob
	0        0      0         0    0  0.988923
	1        0      0         0    1  0.127502
	2        0      0         1    0  0.249331
	3        0      0         1    1  0.553905
	4        0      1         0    0  0.009989
	5        0      1         0    1  0.001288
	6        0      1         1    0  0.002518
	7        0      1         1    1  0.005595
	8        1      0         0    0  0.000272
	9        1      0         0    1  0.217802
	10       1      0         1    0  0.187037
	11       1      0         1    1  0.110125
	12       1      1         0    0  0.000816
	13       1      1         0    1  0.653407
	14       1      1         1    0  0.561113
	15       1      1         1    1  0.330375

Sum out Leaving

	  Report Tampering Fire      prob
	0      0         0    0  0.989195
	1      0         0    1  0.345305
	2      0         1    0  0.436369
	3      0         1    1  0.664030
	4      1         0    0  0.010805
	5      1         0    1  0.654695
	6      1         1    0  0.563631
	7      1         1    1  0.335970

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Report Tampering Fire      prob
	0      0         0    0  0.989195
	1      0         0    1  0.345305
	2      0         1    0  0.436369
	3      0         1    1  0.664030
	4      1         0    0  0.010805
	5      1         0    1  0.654695
	6      1         1    0  0.563631
	7      1         1    1  0.335970

Eliminate variable: Fire

Factors to multiply containing variable: Fire

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Report Tampering Fire      prob
	0      0         0    0  0.989195
	1      0         0    1  0.345305
	2      0         1    0  0.436369
	3      0         1    1  0.664030
	4      1         0    0  0.010805
	5      1         0    1  0.654695
	6      1         1    0  0.563631
	7      1         1    1  0.335970

Result of multiplication: 

	  Report Tampering Fire      prob
	0      0         0    0  0.009793
	1      0         1    0  0.004320
	2      1         0    0  0.000107
	3      1         1    0  0.005580
	4      0         0    1  0.003108
	5      0         1    1  0.005976
	6      1         0    1  0.005892
	7      1         1    1  0.003024

Sum out Fire

	  Report Tampering      prob
	0      0         0  0.012901
	1      0         1  0.010296
	2      1         0  0.005999
	3      1         1  0.008604

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Report Tampering      prob
	0      0         0  0.012901
	1      0         1  0.010296
	2      1         0  0.005999
	3      1         1  0.008604

Eliminate variable: Report

Factors to multiply containing variable: Report

	  Report Tampering      prob
	0      0         0  0.012901
	1      0         1  0.010296
	2      1         0  0.005999
	3      1         1  0.008604

Result of multiplication: 

	  Report Tampering      prob
	0      0         0  0.012901
	1      0         1  0.010296
	2      1         0  0.005999
	3      1         1  0.008604

Storing factor for backtracking to find value of Report

	  Report Tampering      prob
	0      0         0  0.012901
	1      0         1  0.010296
	2      1         0  0.005999
	3      1         1  0.008604

Maximise out Report

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

Eliminate variable: Tampering

Factors to multiply containing variable: Tampering

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

Result of multiplication: 

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Storing factor for backtracking to find value of Tampering

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

New List of Factors: 

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Finding MAP instantiation for Tampering

MAP assignment for variable Tampering is 0

Popped this factor from the backtracking stack:

	  Report Tampering      prob
	0      0         0  0.012901
	1      0         1  0.010296
	2      1         0  0.005999
	3      1         1  0.008604

Finding MAP instantiation for Report

MAP assignment for variable Report is 0

Final Map Instantiation:

Tampering->0

Report->0

Elimination Order: ['Smoke', 'Alarm', 'Leaving', 'Fire', 'Report', 'Tampering']

MAP Variables: ['Tampering', 'Report']

Observed Variables: {}

Original Factors: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Factors with evidence applied: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Eliminate variable: Smoke

Factors to multiply containing variable: Smoke

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

Result of multiplication: 

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

Sum out Smoke

	  Fire  prob
	0    0   1.0
	1    1   1.0

New List of Factors: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire  prob
	0    0   1.0
	1    1   1.0

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

Result of multiplication: 

	   Leaving Alarm Tampering Fire      prob
	0        0     0         0    0  0.998900
	1        1     0         0    0  0.001000
	2        0     1         0    0  0.000012
	3        1     1         0    0  0.000088
	4        0     0         1    0  0.149850
	5        1     0         1    0  0.000150
	6        0     1         1    0  0.102000
	7        1     1         1    0  0.748000
	8        0     0         0    1  0.009990
	9        1     0         0    1  0.000010
	10       0     1         0    1  0.118800
	11       1     1         0    1  0.871200
	12       0     0         1    1  0.499500
	13       1     0         1    1  0.000500
	14       0     1         1    1  0.060000
	15       1     1         1    1  0.440000

Sum out Alarm

	  Leaving Tampering Fire      prob
	0       0         0    0  0.998912
	1       0         0    1  0.128790
	2       0         1    0  0.251850
	3       0         1    1  0.559500
	4       1         0    0  0.001088
	5       1         0    1  0.871210
	6       1         1    0  0.748150
	7       1         1    1  0.440500

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire  prob
	0    0   1.0
	1    1   1.0

	  Leaving Tampering Fire      prob
	0       0         0    0  0.998912
	1       0         0    1  0.128790
	2       0         1    0  0.251850
	3       0         1    1  0.559500
	4       1         0    0  0.001088
	5       1         0    1  0.871210
	6       1         1    0  0.748150
	7       1         1    1  0.440500

Eliminate variable: Leaving

Factors to multiply containing variable: Leaving

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Leaving Tampering Fire      prob
	0       0         0    0  0.998912
	1       0         0    1  0.128790
	2       0         1    0  0.251850
	3       0         1    1  0.559500
	4       1         0    0  0.001088
	5       1         0    1  0.871210
	6       1         1    0  0.748150
	7       1         1    1  0.440500

Result of multiplication: 

	   Leaving Report Tampering Fire      prob
	0        0      0         0    0  0.988923
	1        0      0         0    1  0.127502
	2        0      0         1    0  0.249331
	3        0      0         1    1  0.553905
	4        0      1         0    0  0.009989
	5        0      1         0    1  0.001288
	6        0      1         1    0  0.002518
	7        0      1         1    1  0.005595
	8        1      0         0    0  0.000272
	9        1      0         0    1  0.217802
	10       1      0         1    0  0.187037
	11       1      0         1    1  0.110125
	12       1      1         0    0  0.000816
	13       1      1         0    1  0.653407
	14       1      1         1    0  0.561113
	15       1      1         1    1  0.330375

Sum out Leaving

	  Report Tampering Fire      prob
	0      0         0    0  0.989195
	1      0         0    1  0.345305
	2      0         1    0  0.436369
	3      0         1    1  0.664030
	4      1         0    0  0.010805
	5      1         0    1  0.654695
	6      1         1    0  0.563631
	7      1         1    1  0.335970

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire  prob
	0    0   1.0
	1    1   1.0

	  Report Tampering Fire      prob
	0      0         0    0  0.989195
	1      0         0    1  0.345305
	2      0         1    0  0.436369
	3      0         1    1  0.664030
	4      1         0    0  0.010805
	5      1         0    1  0.654695
	6      1         1    0  0.563631
	7      1         1    1  0.335970

Eliminate variable: Fire

Factors to multiply containing variable: Fire

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	0    0   1.0
	1    1   1.0

	  Report Tampering Fire      prob
	0      0         0    0  0.989195
	1      0         0    1  0.345305
	2      0         1    0  0.436369
	3      0         1    1  0.664030
	4      1         0    0  0.010805
	5      1         0    1  0.654695
	6      1         1    0  0.563631
	7      1         1    1  0.335970

Result of multiplication: 

	  Report Tampering Fire      prob
	0      0         0    0  0.979303
	1      0         1    0  0.432005
	2      1         0    0  0.010697
	3      1         1    0  0.557995
	4      0         0    1  0.003453
	5      0         1    1  0.006640
	6      1         0    1  0.006547
	7      1         1    1  0.003360

Sum out Fire

	  Report Tampering      prob
	0      0         0  0.982756
	1      0         1  0.438646
	2      1         0  0.017244
	3      1         1  0.561354

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Report Tampering      prob
	0      0         0  0.982756
	1      0         1  0.438646
	2      1         0  0.017244
	3      1         1  0.561354

Eliminate variable: Report

Factors to multiply containing variable: Report

	  Report Tampering      prob
	0      0         0  0.982756
	1      0         1  0.438646
	2      1         0  0.017244
	3      1         1  0.561354

Result of multiplication: 

	  Report Tampering      prob
	0      0         0  0.982756
	1      0         1  0.438646
	2      1         0  0.017244
	3      1         1  0.561354

Storing factor for backtracking to find value of Report

	  Report Tampering      prob
	0      0         0  0.982756
	1      0         1  0.438646
	2      1         0  0.017244
	3      1         1  0.561354

Maximise out Report

	  Tampering      prob
	0         0  0.982756
	1         1  0.561354

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.982756
	1         1  0.561354

Eliminate variable: Tampering

Factors to multiply containing variable: Tampering

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.982756
	1         1  0.561354

Result of multiplication: 

	  Tampering      prob
	0         0  0.963101
	1         1  0.011227

Storing factor for backtracking to find value of Tampering

	  Tampering      prob
	0         0  0.963101
	1         1  0.011227

New List of Factors: 

	  Tampering      prob
	0         0  0.963101
	1         1  0.011227

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	  Tampering      prob
	0         0  0.963101
	1         1  0.011227

Finding MAP instantiation for Tampering

MAP assignment for variable Tampering is 0

Popped this factor from the backtracking stack:

	  Report Tampering      prob
	0      0         0  0.982756
	1      0         1  0.438646
	2      1         0  0.017244
	3      1         1  0.561354

Finding MAP instantiation for Report

MAP assignment for variable Report is 0

Final Map Instantiation:

Tampering->0

Report->0

Elimination Order: ['Alarm', 'Leaving', 'Tampering', 'Fire']

MAP Variables: ['Tampering', 'Fire']

Observed Variables: {'Smoke': '1', 'Report': '1'}

Original Factors: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Factors with evidence applied: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Leaving  prob
	1       0  0.01
	3       1  0.75

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

Result of multiplication: 

	   Leaving Alarm Tampering Fire      prob
	0        0     0         0    0  0.998900
	1        1     0         0    0  0.001000
	2        0     1         0    0  0.000012
	3        1     1         0    0  0.000088
	4        0     0         1    0  0.149850
	5        1     0         1    0  0.000150
	6        0     1         1    0  0.102000
	7        1     1         1    0  0.748000
	8        0     0         0    1  0.009990
	9        1     0         0    1  0.000010
	10       0     1         0    1  0.118800
	11       1     1         0    1  0.871200
	12       0     0         1    1  0.499500
	13       1     0         1    1  0.000500
	14       0     1         1    1  0.060000
	15       1     1         1    1  0.440000

Sum out Alarm

	  Leaving Tampering Fire      prob
	0       0         0    0  0.998912
	1       0         0    1  0.128790
	2       0         1    0  0.251850
	3       0         1    1  0.559500
	4       1         0    0  0.001088
	5       1         0    1  0.871210
	6       1         1    0  0.748150
	7       1         1    1  0.440500

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving  prob
	1       0  0.01
	3       1  0.75

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Leaving Tampering Fire      prob
	0       0         0    0  0.998912
	1       0         0    1  0.128790
	2       0         1    0  0.251850
	3       0         1    1  0.559500
	4       1         0    0  0.001088
	5       1         0    1  0.871210
	6       1         1    0  0.748150
	7       1         1    1  0.440500

Eliminate variable: Leaving

Factors to multiply containing variable: Leaving

	  Leaving  prob
	1       0  0.01
	3       1  0.75

	  Leaving Tampering Fire      prob
	0       0         0    0  0.998912
	1       0         0    1  0.128790
	2       0         1    0  0.251850
	3       0         1    1  0.559500
	4       1         0    0  0.001088
	5       1         0    1  0.871210
	6       1         1    0  0.748150
	7       1         1    1  0.440500

Result of multiplication: 

	  Leaving Tampering Fire      prob
	0       0         0    0  0.009989
	1       0         0    1  0.001288
	2       0         1    0  0.002518
	3       0         1    1  0.005595
	4       1         0    0  0.000816
	5       1         0    1  0.653407
	6       1         1    0  0.561113
	7       1         1    1  0.330375

Sum out Leaving

	  Tampering Fire      prob
	0         0    0  0.010805
	1         0    1  0.654695
	2         1    0  0.563631
	3         1    1  0.335970

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering Fire      prob
	0         0    0  0.010805
	1         0    1  0.654695
	2         1    0  0.563631
	3         1    1  0.335970

Eliminate variable: Tampering

Factors to multiply containing variable: Tampering

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering Fire      prob
	0         0    0  0.010805
	1         0    1  0.654695
	2         1    0  0.563631
	3         1    1  0.335970

Result of multiplication: 

	  Tampering Fire      prob
	0         0    0  0.010589
	1         0    1  0.641601
	2         1    0  0.011273
	3         1    1  0.006719

Storing factor for backtracking to find value of Tampering

	  Tampering Fire      prob
	0         0    0  0.010589
	1         0    1  0.641601
	2         1    0  0.011273
	3         1    1  0.006719

Maximise out Tampering

	  Fire      prob
	0    0  0.011273
	1    1  0.641601

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Fire      prob
	0    0  0.011273
	1    1  0.641601

Eliminate variable: Fire

Factors to multiply containing variable: Fire

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Fire      prob
	0    0  0.011273
	1    1  0.641601

Result of multiplication: 

	  Fire      prob
	0    0  0.000112
	1    1  0.005774

Storing factor for backtracking to find value of Fire

	  Fire      prob
	0    0  0.000112
	1    1  0.005774

New List of Factors: 

	  Fire      prob
	0    0  0.000112
	1    1  0.005774

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	  Fire      prob
	0    0  0.000112
	1    1  0.005774

Finding MAP instantiation for Fire

MAP assignment for variable Fire is 1

Popped this factor from the backtracking stack:

	  Tampering Fire      prob
	0         0    0  0.010589
	1         0    1  0.641601
	2         1    0  0.011273
	3         1    1  0.006719

Finding MAP instantiation for Tampering

Elimination Order: ['JohnCalls', 'MaryCalls', 'Earthquake', 'Alarm']

MAP Variables: ['Alarm']

Observed Variables: {'Burglary': 'True'}

Original Factors: 

	  Burglary  prob
	0     True  0.01
	1    False  0.99

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Burglary Earthquake   prob
	0   True     True       True  0.950
	1  False     True       True  0.050
	2   True    False       True  0.290
	3  False    False       True  0.710
	4   True     True      False  0.940
	5  False     True      False  0.060
	6   True    False      False  0.001
	7  False    False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Factors with evidence applied: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Eliminate variable: JohnCalls

Factors to multiply containing variable: JohnCalls

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Result of multiplication: 

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Sum out JohnCalls

	   Alarm  prob
	0  False   1.0
	1   True   1.0

New List of Factors: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

	   Alarm  prob
	0  False   1.0
	1   True   1.0

Eliminate variable: MaryCalls

Factors to multiply containing variable: MaryCalls

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Result of multiplication: 

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Sum out MaryCalls

	   Alarm  prob
	0  False   1.0
	1   True   1.0

New List of Factors: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

Eliminate variable: Earthquake

Factors to multiply containing variable: Earthquake

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

Result of multiplication: 

	   Alarm Earthquake    prob
	0   True       True  0.0190
	1  False       True  0.0010
	2   True      False  0.9212
	3  False      False  0.0588

Sum out Earthquake

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

New List of Factors: 

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Result of multiplication: 

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Storing factor for backtracking to find value of Alarm

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

New List of Factors: 

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Finding MAP instantiation for Alarm

MAP assignment for variable Alarm is True

Final Map Instantiation:

Alarm->True

Elimination Order: ['JohnCalls', 'MaryCalls', 'Earthquake', 'Alarm']

MAP Variables: ['Alarm']

Observed Variables: {'Burglary': 'False'}

Original Factors: 

	  Burglary  prob
	0     True  0.01
	1    False  0.99

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Burglary Earthquake   prob
	0   True     True       True  0.950
	1  False     True       True  0.050
	2   True    False       True  0.290
	3  False    False       True  0.710
	4   True     True      False  0.940
	5  False     True      False  0.060
	6   True    False      False  0.001
	7  False    False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Factors with evidence applied: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Eliminate variable: JohnCalls

Factors to multiply containing variable: JohnCalls

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Result of multiplication: 

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Sum out JohnCalls

	   Alarm  prob
	0  False   1.0
	1   True   1.0

New List of Factors: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

	   Alarm  prob
	0  False   1.0
	1   True   1.0

Eliminate variable: MaryCalls

Factors to multiply containing variable: MaryCalls

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Result of multiplication: 

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Sum out MaryCalls

	   Alarm  prob
	0  False   1.0
	1   True   1.0

New List of Factors: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

Eliminate variable: Earthquake

Factors to multiply containing variable: Earthquake

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

Result of multiplication: 

	   Alarm Earthquake     prob
	0   True       True  0.00580
	1  False       True  0.01420
	2   True      False  0.00098
	3  False      False  0.97902

Sum out Earthquake

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

New List of Factors: 

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

Result of multiplication: 

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

Storing factor for backtracking to find value of Alarm

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

New List of Factors: 

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

Finding MAP instantiation for Alarm

MAP assignment for variable Alarm is False

Final Map Instantiation:

Alarm->False

Elimination Order: ['Alarm', 'Leaving', 'Fire', 'Report', 'Tampering']

MAP Variables: ['Tampering', 'Report']

Observed Variables: {'Smoke': '1'}

Original Factors: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Factors with evidence applied: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

Result of multiplication: 

	   Tampering Alarm Leaving Fire      prob
	0          0     0       0    0  0.998900
	1          0     0       1    0  0.001000
	2          0     1       0    0  0.000012
	3          0     1       1    0  0.000088
	4          1     0       0    0  0.149850
	5          1     0       1    0  0.000150
	6          1     1       0    0  0.102000
	7          1     1       1    0  0.748000
	8          0     0       0    1  0.009990
	9          0     0       1    1  0.000010
	10         0     1       0    1  0.118800
	11         0     1       1    1  0.871200
	12         1     0       0    1  0.499500
	13         1     0       1    1  0.000500
	14         1     1       0    1  0.060000
	15         1     1       1    1  0.440000

Sum out Alarm

	  Tampering Leaving Fire      prob
	0         0       0    0  0.998912
	1         0       0    1  0.128790
	2         0       1    0  0.001088
	3         0       1    1  0.871210
	4         1       0    0  0.251850
	5         1       0    1  0.559500
	6         1       1    0  0.748150
	7         1       1    1  0.440500

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering Leaving Fire      prob
	0         0       0    0  0.998912
	1         0       0    1  0.128790
	2         0       1    0  0.001088
	3         0       1    1  0.871210
	4         1       0    0  0.251850
	5         1       0    1  0.559500
	6         1       1    0  0.748150
	7         1       1    1  0.440500

Eliminate variable: Leaving

Factors to multiply containing variable: Leaving

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Tampering Leaving Fire      prob
	0         0       0    0  0.998912
	1         0       0    1  0.128790
	2         0       1    0  0.001088
	3         0       1    1  0.871210
	4         1       0    0  0.251850
	5         1       0    1  0.559500
	6         1       1    0  0.748150
	7         1       1    1  0.440500

Result of multiplication: 

	   Report Tampering Leaving Fire      prob
	0       0         0       0    0  0.988923
	1       0         0       0    1  0.127502
	2       0         1       0    0  0.249331
	3       0         1       0    1  0.553905
	4       1         0       0    0  0.009989
	5       1         0       0    1  0.001288
	6       1         1       0    0  0.002518
	7       1         1       0    1  0.005595
	8       0         0       1    0  0.000272
	9       0         0       1    1  0.217802
	10      0         1       1    0  0.187037
	11      0         1       1    1  0.110125
	12      1         0       1    0  0.000816
	13      1         0       1    1  0.653407
	14      1         1       1    0  0.561113
	15      1         1       1    1  0.330375

Sum out Leaving

	  Report Tampering Fire      prob
	0      0         0    0  0.989195
	1      0         0    1  0.345305
	2      0         1    0  0.436369
	3      0         1    1  0.664030
	4      1         0    0  0.010805
	5      1         0    1  0.654695
	6      1         1    0  0.563631
	7      1         1    1  0.335970

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Report Tampering Fire      prob
	0      0         0    0  0.989195
	1      0         0    1  0.345305
	2      0         1    0  0.436369
	3      0         1    1  0.664030
	4      1         0    0  0.010805
	5      1         0    1  0.654695
	6      1         1    0  0.563631
	7      1         1    1  0.335970

Eliminate variable: Fire

Factors to multiply containing variable: Fire

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Report Tampering Fire      prob
	0      0         0    0  0.989195
	1      0         0    1  0.345305
	2      0         1    0  0.436369
	3      0         1    1  0.664030
	4      1         0    0  0.010805
	5      1         0    1  0.654695
	6      1         1    0  0.563631
	7      1         1    1  0.335970

Result of multiplication: 

	  Report Tampering Fire      prob
	0      0         0    0  0.009793
	1      0         1    0  0.004320
	2      1         0    0  0.000107
	3      1         1    0  0.005580
	4      0         0    1  0.003108
	5      0         1    1  0.005976
	6      1         0    1  0.005892
	7      1         1    1  0.003024

Sum out Fire

	  Report Tampering      prob
	0      0         0  0.012901
	1      0         1  0.010296
	2      1         0  0.005999
	3      1         1  0.008604

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Report Tampering      prob
	0      0         0  0.012901
	1      0         1  0.010296
	2      1         0  0.005999
	3      1         1  0.008604

Eliminate variable: Report

Factors to multiply containing variable: Report

	  Report Tampering      prob
	0      0         0  0.012901
	1      0         1  0.010296
	2      1         0  0.005999
	3      1         1  0.008604

Result of multiplication: 

	  Report Tampering      prob
	0      0         0  0.012901
	1      0         1  0.010296
	2      1         0  0.005999
	3      1         1  0.008604

Storing factor for backtracking to find value of Report

	  Report Tampering      prob
	0      0         0  0.012901
	1      0         1  0.010296
	2      1         0  0.005999
	3      1         1  0.008604

Maximise out Report

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

Eliminate variable: Tampering

Factors to multiply containing variable: Tampering

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

Result of multiplication: 

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Storing factor for backtracking to find value of Tampering

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

New List of Factors: 

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Finding MAP instantiation for Tampering

MAP assignment for variable Tampering is 0

Popped this factor from the backtracking stack:

	  Report Tampering      prob
	0      0         0  0.012901
	1      0         1  0.010296
	2      1         0  0.005999
	3      1         1  0.008604

Finding MAP instantiation for Report

MAP assignment for variable Report is 0

Final Map Instantiation:

Tampering->0

Report->0

Elimination Order: ['Smoke', 'Alarm', 'Leaving', 'Fire', 'Report', 'Tampering']

MAP Variables: ['Tampering', 'Report']

Observed Variables: {}

Original Factors: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Factors with evidence applied: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Eliminate variable: Smoke

Factors to multiply containing variable: Smoke

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

Result of multiplication: 

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

Sum out Smoke

	  Fire  prob
	0    0   1.0
	1    1   1.0

New List of Factors: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire  prob
	0    0   1.0
	1    1   1.0

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

Result of multiplication: 

	   Tampering Alarm Leaving Fire      prob
	0          0     0       0    0  0.998900
	1          0     0       1    0  0.001000
	2          0     1       0    0  0.000012
	3          0     1       1    0  0.000088
	4          1     0       0    0  0.149850
	5          1     0       1    0  0.000150
	6          1     1       0    0  0.102000
	7          1     1       1    0  0.748000
	8          0     0       0    1  0.009990
	9          0     0       1    1  0.000010
	10         0     1       0    1  0.118800
	11         0     1       1    1  0.871200
	12         1     0       0    1  0.499500
	13         1     0       1    1  0.000500
	14         1     1       0    1  0.060000
	15         1     1       1    1  0.440000

Sum out Alarm

	  Tampering Leaving Fire      prob
	0         0       0    0  0.998912
	1         0       0    1  0.128790
	2         0       1    0  0.001088
	3         0       1    1  0.871210
	4         1       0    0  0.251850
	5         1       0    1  0.559500
	6         1       1    0  0.748150
	7         1       1    1  0.440500

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire  prob
	0    0   1.0
	1    1   1.0

	  Tampering Leaving Fire      prob
	0         0       0    0  0.998912
	1         0       0    1  0.128790
	2         0       1    0  0.001088
	3         0       1    1  0.871210
	4         1       0    0  0.251850
	5         1       0    1  0.559500
	6         1       1    0  0.748150
	7         1       1    1  0.440500

Eliminate variable: Leaving

Factors to multiply containing variable: Leaving

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Tampering Leaving Fire      prob
	0         0       0    0  0.998912
	1         0       0    1  0.128790
	2         0       1    0  0.001088
	3         0       1    1  0.871210
	4         1       0    0  0.251850
	5         1       0    1  0.559500
	6         1       1    0  0.748150
	7         1       1    1  0.440500

Result of multiplication: 

	   Report Tampering Leaving Fire      prob
	0       0         0       0    0  0.988923
	1       0         0       0    1  0.127502
	2       0         1       0    0  0.249331
	3       0         1       0    1  0.553905
	4       1         0       0    0  0.009989
	5       1         0       0    1  0.001288
	6       1         1       0    0  0.002518
	7       1         1       0    1  0.005595
	8       0         0       1    0  0.000272
	9       0         0       1    1  0.217802
	10      0         1       1    0  0.187037
	11      0         1       1    1  0.110125
	12      1         0       1    0  0.000816
	13      1         0       1    1  0.653407
	14      1         1       1    0  0.561113
	15      1         1       1    1  0.330375

Sum out Leaving

	  Report Tampering Fire      prob
	0      0         0    0  0.989195
	1      0         0    1  0.345305
	2      0         1    0  0.436369
	3      0         1    1  0.664030
	4      1         0    0  0.010805
	5      1         0    1  0.654695
	6      1         1    0  0.563631
	7      1         1    1  0.335970

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire  prob
	0    0   1.0
	1    1   1.0

	  Report Tampering Fire      prob
	0      0         0    0  0.989195
	1      0         0    1  0.345305
	2      0         1    0  0.436369
	3      0         1    1  0.664030
	4      1         0    0  0.010805
	5      1         0    1  0.654695
	6      1         1    0  0.563631
	7      1         1    1  0.335970

Eliminate variable: Fire

Factors to multiply containing variable: Fire

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	0    0   1.0
	1    1   1.0

	  Report Tampering Fire      prob
	0      0         0    0  0.989195
	1      0         0    1  0.345305
	2      0         1    0  0.436369
	3      0         1    1  0.664030
	4      1         0    0  0.010805
	5      1         0    1  0.654695
	6      1         1    0  0.563631
	7      1         1    1  0.335970

Result of multiplication: 

	  Report Tampering Fire      prob
	0      0         0    0  0.979303
	1      0         1    0  0.432005
	2      1         0    0  0.010697
	3      1         1    0  0.557995
	4      0         0    1  0.003453
	5      0         1    1  0.006640
	6      1         0    1  0.006547
	7      1         1    1  0.003360

Sum out Fire

	  Report Tampering      prob
	0      0         0  0.982756
	1      0         1  0.438646
	2      1         0  0.017244
	3      1         1  0.561354

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Report Tampering      prob
	0      0         0  0.982756
	1      0         1  0.438646
	2      1         0  0.017244
	3      1         1  0.561354

Eliminate variable: Report

Factors to multiply containing variable: Report

	  Report Tampering      prob
	0      0         0  0.982756
	1      0         1  0.438646
	2      1         0  0.017244
	3      1         1  0.561354

Result of multiplication: 

	  Report Tampering      prob
	0      0         0  0.982756
	1      0         1  0.438646
	2      1         0  0.017244
	3      1         1  0.561354

Storing factor for backtracking to find value of Report

	  Report Tampering      prob
	0      0         0  0.982756
	1      0         1  0.438646
	2      1         0  0.017244
	3      1         1  0.561354

Maximise out Report

	  Tampering      prob
	0         0  0.982756
	1         1  0.561354

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.982756
	1         1  0.561354

Eliminate variable: Tampering

Factors to multiply containing variable: Tampering

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.982756
	1         1  0.561354

Result of multiplication: 

	  Tampering      prob
	0         0  0.963101
	1         1  0.011227

Storing factor for backtracking to find value of Tampering

	  Tampering      prob
	0         0  0.963101
	1         1  0.011227

New List of Factors: 

	  Tampering      prob
	0         0  0.963101
	1         1  0.011227

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	  Tampering      prob
	0         0  0.963101
	1         1  0.011227

Finding MAP instantiation for Tampering

MAP assignment for variable Tampering is 0

Popped this factor from the backtracking stack:

	  Report Tampering      prob
	0      0         0  0.982756
	1      0         1  0.438646
	2      1         0  0.017244
	3      1         1  0.561354

Finding MAP instantiation for Report

MAP assignment for variable Report is 0

Final Map Instantiation:

Tampering->0

Report->0

Elimination Order: ['Alarm', 'Leaving', 'Tampering', 'Fire']

MAP Variables: ['Tampering', 'Fire']

Observed Variables: {'Smoke': '1', 'Report': '1'}

Original Factors: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Factors with evidence applied: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Leaving  prob
	1       0  0.01
	3       1  0.75

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

Result of multiplication: 

	   Tampering Alarm Leaving Fire      prob
	0          0     0       0    0  0.998900
	1          0     0       1    0  0.001000
	2          0     1       0    0  0.000012
	3          0     1       1    0  0.000088
	4          1     0       0    0  0.149850
	5          1     0       1    0  0.000150
	6          1     1       0    0  0.102000
	7          1     1       1    0  0.748000
	8          0     0       0    1  0.009990
	9          0     0       1    1  0.000010
	10         0     1       0    1  0.118800
	11         0     1       1    1  0.871200
	12         1     0       0    1  0.499500
	13         1     0       1    1  0.000500
	14         1     1       0    1  0.060000
	15         1     1       1    1  0.440000

Sum out Alarm

	  Tampering Leaving Fire      prob
	0         0       0    0  0.998912
	1         0       0    1  0.128790
	2         0       1    0  0.001088
	3         0       1    1  0.871210
	4         1       0    0  0.251850
	5         1       0    1  0.559500
	6         1       1    0  0.748150
	7         1       1    1  0.440500

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving  prob
	1       0  0.01
	3       1  0.75

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering Leaving Fire      prob
	0         0       0    0  0.998912
	1         0       0    1  0.128790
	2         0       1    0  0.001088
	3         0       1    1  0.871210
	4         1       0    0  0.251850
	5         1       0    1  0.559500
	6         1       1    0  0.748150
	7         1       1    1  0.440500

Eliminate variable: Leaving

Factors to multiply containing variable: Leaving

	  Leaving  prob
	1       0  0.01
	3       1  0.75

	  Tampering Leaving Fire      prob
	0         0       0    0  0.998912
	1         0       0    1  0.128790
	2         0       1    0  0.001088
	3         0       1    1  0.871210
	4         1       0    0  0.251850
	5         1       0    1  0.559500
	6         1       1    0  0.748150
	7         1       1    1  0.440500

Result of multiplication: 

	  Tampering Leaving Fire      prob
	0         0       0    0  0.009989
	1         0       0    1  0.001288
	2         1       0    0  0.002518
	3         1       0    1  0.005595
	4         0       1    0  0.000816
	5         0       1    1  0.653407
	6         1       1    0  0.561113
	7         1       1    1  0.330375

Sum out Leaving

	  Tampering Fire      prob
	0         0    0  0.010805
	1         0    1  0.654695
	2         1    0  0.563631
	3         1    1  0.335970

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering Fire      prob
	0         0    0  0.010805
	1         0    1  0.654695
	2         1    0  0.563631
	3         1    1  0.335970

Eliminate variable: Tampering

Factors to multiply containing variable: Tampering

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering Fire      prob
	0         0    0  0.010805
	1         0    1  0.654695
	2         1    0  0.563631
	3         1    1  0.335970

Result of multiplication: 

	  Tampering Fire      prob
	0         0    0  0.010589
	1         0    1  0.641601
	2         1    0  0.011273
	3         1    1  0.006719

Storing factor for backtracking to find value of Tampering

	  Tampering Fire      prob
	0         0    0  0.010589
	1         0    1  0.641601
	2         1    0  0.011273
	3         1    1  0.006719

Maximise out Tampering

	  Fire      prob
	0    0  0.011273
	1    1  0.641601

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Fire      prob
	0    0  0.011273
	1    1  0.641601

Eliminate variable: Fire

Factors to multiply containing variable: Fire

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Fire      prob
	0    0  0.011273
	1    1  0.641601

Result of multiplication: 

	  Fire      prob
	0    0  0.000112
	1    1  0.005774

Storing factor for backtracking to find value of Fire

	  Fire      prob
	0    0  0.000112
	1    1  0.005774

New List of Factors: 

	  Fire      prob
	0    0  0.000112
	1    1  0.005774

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	  Fire      prob
	0    0  0.000112
	1    1  0.005774

Finding MAP instantiation for Fire

MAP assignment for variable Fire is 1

Popped this factor from the backtracking stack:

	  Tampering Fire      prob
	0         0    0  0.010589
	1         0    1  0.641601
	2         1    0  0.011273
	3         1    1  0.006719

Finding MAP instantiation for Tampering

Elimination Order: ['JohnCalls', 'MaryCalls', 'Earthquake', 'Alarm']

MAP Variables: ['Alarm']

Observed Variables: {'Burglary': 'True'}

Original Factors: 

	  Burglary  prob
	0     True  0.01
	1    False  0.99

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Burglary Earthquake   prob
	0   True     True       True  0.950
	1  False     True       True  0.050
	2   True    False       True  0.290
	3  False    False       True  0.710
	4   True     True      False  0.940
	5  False     True      False  0.060
	6   True    False      False  0.001
	7  False    False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Factors with evidence applied: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Eliminate variable: JohnCalls

Factors to multiply containing variable: JohnCalls

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Result of multiplication: 

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Sum out JohnCalls

	   Alarm  prob
	0  False   1.0
	1   True   1.0

New List of Factors: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

	   Alarm  prob
	0  False   1.0
	1   True   1.0

Eliminate variable: MaryCalls

Factors to multiply containing variable: MaryCalls

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Result of multiplication: 

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Sum out MaryCalls

	   Alarm  prob
	0  False   1.0
	1   True   1.0

New List of Factors: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

Eliminate variable: Earthquake

Factors to multiply containing variable: Earthquake

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

Result of multiplication: 

	   Alarm Earthquake    prob
	0   True       True  0.0190
	1  False       True  0.0010
	2   True      False  0.9212
	3  False      False  0.0588

Sum out Earthquake

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

New List of Factors: 

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Result of multiplication: 

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Storing factor for backtracking to find value of Alarm

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

New List of Factors: 

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Finding MAP instantiation for Alarm

MAP assignment for variable Alarm is True

Final Map Instantiation:

Alarm->True

Elimination Order: ['JohnCalls', 'MaryCalls', 'Earthquake', 'Alarm']

MAP Variables: ['Alarm']

Observed Variables: {'Burglary': 'False'}

Original Factors: 

	  Burglary  prob
	0     True  0.01
	1    False  0.99

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Burglary Earthquake   prob
	0   True     True       True  0.950
	1  False     True       True  0.050
	2   True    False       True  0.290
	3  False    False       True  0.710
	4   True     True      False  0.940
	5  False     True      False  0.060
	6   True    False      False  0.001
	7  False    False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Factors with evidence applied: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Eliminate variable: JohnCalls

Factors to multiply containing variable: JohnCalls

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Result of multiplication: 

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Sum out JohnCalls

	   Alarm  prob
	0  False   1.0
	1   True   1.0

New List of Factors: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

	   Alarm  prob
	0  False   1.0
	1   True   1.0

Eliminate variable: MaryCalls

Factors to multiply containing variable: MaryCalls

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Result of multiplication: 

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Sum out MaryCalls

	   Alarm  prob
	0  False   1.0
	1   True   1.0

New List of Factors: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

Eliminate variable: Earthquake

Factors to multiply containing variable: Earthquake

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

Result of multiplication: 

	   Alarm Earthquake     prob
	0   True       True  0.00580
	1  False       True  0.01420
	2   True      False  0.00098
	3  False      False  0.97902

Sum out Earthquake

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

New List of Factors: 

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

Result of multiplication: 

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

Storing factor for backtracking to find value of Alarm

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

New List of Factors: 

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

Finding MAP instantiation for Alarm

MAP assignment for variable Alarm is False

Final Map Instantiation:

Alarm->False

Elimination Order: ['Alarm', 'Leaving', 'Fire', 'Report', 'Tampering']

MAP Variables: ['Tampering', 'Report']

Observed Variables: {'Smoke': '1'}

Original Factors: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Factors with evidence applied: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

Result of multiplication: 

	   Alarm Fire Tampering Leaving      prob
	0      0    0         0       0  0.998900
	1      0    0         0       1  0.001000
	2      1    0         0       0  0.000012
	3      1    0         0       1  0.000088
	4      0    0         1       0  0.149850
	5      0    0         1       1  0.000150
	6      1    0         1       0  0.102000
	7      1    0         1       1  0.748000
	8      0    1         0       0  0.009990
	9      0    1         0       1  0.000010
	10     1    1         0       0  0.118800
	11     1    1         0       1  0.871200
	12     0    1         1       0  0.499500
	13     0    1         1       1  0.000500
	14     1    1         1       0  0.060000
	15     1    1         1       1  0.440000

Sum out Alarm

	  Fire Tampering Leaving      prob
	0    0         0       0  0.998912
	1    0         0       1  0.001088
	2    0         1       0  0.251850
	3    0         1       1  0.748150
	4    1         0       0  0.128790
	5    1         0       1  0.871210
	6    1         1       0  0.559500
	7    1         1       1  0.440500

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire Tampering Leaving      prob
	0    0         0       0  0.998912
	1    0         0       1  0.001088
	2    0         1       0  0.251850
	3    0         1       1  0.748150
	4    1         0       0  0.128790
	5    1         0       1  0.871210
	6    1         1       0  0.559500
	7    1         1       1  0.440500

Eliminate variable: Leaving

Factors to multiply containing variable: Leaving

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Fire Tampering Leaving      prob
	0    0         0       0  0.998912
	1    0         0       1  0.001088
	2    0         1       0  0.251850
	3    0         1       1  0.748150
	4    1         0       0  0.128790
	5    1         0       1  0.871210
	6    1         1       0  0.559500
	7    1         1       1  0.440500

Result of multiplication: 

	   Fire Leaving Tampering Report      prob
	0     0       0         0      0  0.988923
	1     0       0         1      0  0.249331
	2     1       0         0      0  0.127502
	3     1       0         1      0  0.553905
	4     0       0         0      1  0.009989
	5     0       0         1      1  0.002518
	6     1       0         0      1  0.001288
	7     1       0         1      1  0.005595
	8     0       1         0      0  0.000272
	9     0       1         1      0  0.187037
	10    1       1         0      0  0.217802
	11    1       1         1      0  0.110125
	12    0       1         0      1  0.000816
	13    0       1         1      1  0.561113
	14    1       1         0      1  0.653407
	15    1       1         1      1  0.330375

Sum out Leaving

	  Fire Tampering Report      prob
	0    0         0      0  0.989195
	1    0         0      1  0.010805
	2    0         1      0  0.436369
	3    0         1      1  0.563631
	4    1         0      0  0.345305
	5    1         0      1  0.654695
	6    1         1      0  0.664030
	7    1         1      1  0.335970

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire Tampering Report      prob
	0    0         0      0  0.989195
	1    0         0      1  0.010805
	2    0         1      0  0.436369
	3    0         1      1  0.563631
	4    1         0      0  0.345305
	5    1         0      1  0.654695
	6    1         1      0  0.664030
	7    1         1      1  0.335970

Eliminate variable: Fire

Factors to multiply containing variable: Fire

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Fire Tampering Report      prob
	0    0         0      0  0.989195
	1    0         0      1  0.010805
	2    0         1      0  0.436369
	3    0         1      1  0.563631
	4    1         0      0  0.345305
	5    1         0      1  0.654695
	6    1         1      0  0.664030
	7    1         1      1  0.335970

Result of multiplication: 

	  Fire Tampering Report      prob
	0    0         0      0  0.009793
	1    0         0      1  0.000107
	2    0         1      0  0.004320
	3    0         1      1  0.005580
	4    1         0      0  0.003108
	5    1         0      1  0.005892
	6    1         1      0  0.005976
	7    1         1      1  0.003024

Sum out Fire

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Eliminate variable: Report

Factors to multiply containing variable: Report

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Result of multiplication: 

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Storing factor for backtracking to find value of Report

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Maximise out Report

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

Eliminate variable: Tampering

Factors to multiply containing variable: Tampering

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

Result of multiplication: 

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Storing factor for backtracking to find value of Tampering

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

New List of Factors: 

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Finding MAP instantiation for Tampering

MAP assignment for variable Tampering is 0

Popped this factor from the backtracking stack:

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Finding MAP instantiation for Report

MAP assignment for variable Report is 0

Final Map Instantiation:

Tampering->0

Report->0

Elimination Order: ['Smoke', 'Alarm', 'Leaving', 'Fire', 'Report', 'Tampering']

MAP Variables: ['Tampering', 'Report']

Observed Variables: {}

Original Factors: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Factors with evidence applied: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Eliminate variable: Smoke

Factors to multiply containing variable: Smoke

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

Result of multiplication: 

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

Sum out Smoke

	  Fire  prob
	0    0   1.0
	1    1   1.0

New List of Factors: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire  prob
	0    0   1.0
	1    1   1.0

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

Result of multiplication: 

	   Alarm Fire Tampering Leaving      prob
	0      0    0         0       0  0.998900
	1      0    0         0       1  0.001000
	2      1    0         0       0  0.000012
	3      1    0         0       1  0.000088
	4      0    0         1       0  0.149850
	5      0    0         1       1  0.000150
	6      1    0         1       0  0.102000
	7      1    0         1       1  0.748000
	8      0    1         0       0  0.009990
	9      0    1         0       1  0.000010
	10     1    1         0       0  0.118800
	11     1    1         0       1  0.871200
	12     0    1         1       0  0.499500
	13     0    1         1       1  0.000500
	14     1    1         1       0  0.060000
	15     1    1         1       1  0.440000

Sum out Alarm

	  Fire Tampering Leaving      prob
	0    0         0       0  0.998912
	1    0         0       1  0.001088
	2    0         1       0  0.251850
	3    0         1       1  0.748150
	4    1         0       0  0.128790
	5    1         0       1  0.871210
	6    1         1       0  0.559500
	7    1         1       1  0.440500

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire  prob
	0    0   1.0
	1    1   1.0

	  Fire Tampering Leaving      prob
	0    0         0       0  0.998912
	1    0         0       1  0.001088
	2    0         1       0  0.251850
	3    0         1       1  0.748150
	4    1         0       0  0.128790
	5    1         0       1  0.871210
	6    1         1       0  0.559500
	7    1         1       1  0.440500

Eliminate variable: Leaving

Factors to multiply containing variable: Leaving

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Fire Tampering Leaving      prob
	0    0         0       0  0.998912
	1    0         0       1  0.001088
	2    0         1       0  0.251850
	3    0         1       1  0.748150
	4    1         0       0  0.128790
	5    1         0       1  0.871210
	6    1         1       0  0.559500
	7    1         1       1  0.440500

Result of multiplication: 

	   Fire Leaving Tampering Report      prob
	0     0       0         0      0  0.988923
	1     0       0         1      0  0.249331
	2     1       0         0      0  0.127502
	3     1       0         1      0  0.553905
	4     0       0         0      1  0.009989
	5     0       0         1      1  0.002518
	6     1       0         0      1  0.001288
	7     1       0         1      1  0.005595
	8     0       1         0      0  0.000272
	9     0       1         1      0  0.187037
	10    1       1         0      0  0.217802
	11    1       1         1      0  0.110125
	12    0       1         0      1  0.000816
	13    0       1         1      1  0.561113
	14    1       1         0      1  0.653407
	15    1       1         1      1  0.330375

Sum out Leaving

	  Fire Tampering Report      prob
	0    0         0      0  0.989195
	1    0         0      1  0.010805
	2    0         1      0  0.436369
	3    0         1      1  0.563631
	4    1         0      0  0.345305
	5    1         0      1  0.654695
	6    1         1      0  0.664030
	7    1         1      1  0.335970

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire  prob
	0    0   1.0
	1    1   1.0

	  Fire Tampering Report      prob
	0    0         0      0  0.989195
	1    0         0      1  0.010805
	2    0         1      0  0.436369
	3    0         1      1  0.563631
	4    1         0      0  0.345305
	5    1         0      1  0.654695
	6    1         1      0  0.664030
	7    1         1      1  0.335970

Eliminate variable: Fire

Factors to multiply containing variable: Fire

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	0    0   1.0
	1    1   1.0

	  Fire Tampering Report      prob
	0    0         0      0  0.989195
	1    0         0      1  0.010805
	2    0         1      0  0.436369
	3    0         1      1  0.563631
	4    1         0      0  0.345305
	5    1         0      1  0.654695
	6    1         1      0  0.664030
	7    1         1      1  0.335970

Result of multiplication: 

	  Fire Tampering Report      prob
	0    0         0      0  0.979303
	1    0         0      1  0.010697
	2    0         1      0  0.432005
	3    0         1      1  0.557995
	4    1         0      0  0.003453
	5    1         0      1  0.006547
	6    1         1      0  0.006640
	7    1         1      1  0.003360

Sum out Fire

	  Tampering Report      prob
	0         0      0  0.982756
	1         0      1  0.017244
	2         1      0  0.438646
	3         1      1  0.561354

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering Report      prob
	0         0      0  0.982756
	1         0      1  0.017244
	2         1      0  0.438646
	3         1      1  0.561354

Eliminate variable: Report

Factors to multiply containing variable: Report

	  Tampering Report      prob
	0         0      0  0.982756
	1         0      1  0.017244
	2         1      0  0.438646
	3         1      1  0.561354

Result of multiplication: 

	  Tampering Report      prob
	0         0      0  0.982756
	1         0      1  0.017244
	2         1      0  0.438646
	3         1      1  0.561354

Storing factor for backtracking to find value of Report

	  Tampering Report      prob
	0         0      0  0.982756
	1         0      1  0.017244
	2         1      0  0.438646
	3         1      1  0.561354

Maximise out Report

	  Tampering      prob
	0         0  0.982756
	1         1  0.561354

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.982756
	1         1  0.561354

Eliminate variable: Tampering

Factors to multiply containing variable: Tampering

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.982756
	1         1  0.561354

Result of multiplication: 

	  Tampering      prob
	0         0  0.963101
	1         1  0.011227

Storing factor for backtracking to find value of Tampering

	  Tampering      prob
	0         0  0.963101
	1         1  0.011227

New List of Factors: 

	  Tampering      prob
	0         0  0.963101
	1         1  0.011227

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	  Tampering      prob
	0         0  0.963101
	1         1  0.011227

Finding MAP instantiation for Tampering

MAP assignment for variable Tampering is 0

Popped this factor from the backtracking stack:

	  Tampering Report      prob
	0         0      0  0.982756
	1         0      1  0.017244
	2         1      0  0.438646
	3         1      1  0.561354

Finding MAP instantiation for Report

MAP assignment for variable Report is 0

Final Map Instantiation:

Tampering->0

Report->0

Elimination Order: ['Report', 'Alarm', 'Leaving', 'Tampering', 'Fire']

MAP Variables: ['Tampering', 'Fire']

Observed Variables: {'Smoke': '1'}

Original Factors: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Factors with evidence applied: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Eliminate variable: Report

Factors to multiply containing variable: Report

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

Result of multiplication: 

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

Sum out Report

	  Leaving  prob
	0       0   1.0
	1       1   1.0

New List of Factors: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Leaving  prob
	0       0   1.0
	1       1   1.0

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

Result of multiplication: 

	   Alarm Fire Tampering Leaving      prob
	0      0    0         0       0  0.998900
	1      0    0         0       1  0.001000
	2      1    0         0       0  0.000012
	3      1    0         0       1  0.000088
	4      0    0         1       0  0.149850
	5      0    0         1       1  0.000150
	6      1    0         1       0  0.102000
	7      1    0         1       1  0.748000
	8      0    1         0       0  0.009990
	9      0    1         0       1  0.000010
	10     1    1         0       0  0.118800
	11     1    1         0       1  0.871200
	12     0    1         1       0  0.499500
	13     0    1         1       1  0.000500
	14     1    1         1       0  0.060000
	15     1    1         1       1  0.440000

Sum out Alarm

	  Fire Tampering Leaving      prob
	0    0         0       0  0.998912
	1    0         0       1  0.001088
	2    0         1       0  0.251850
	3    0         1       1  0.748150
	4    1         0       0  0.128790
	5    1         0       1  0.871210
	6    1         1       0  0.559500
	7    1         1       1  0.440500

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Leaving  prob
	0       0   1.0
	1       1   1.0

	  Fire Tampering Leaving      prob
	0    0         0       0  0.998912
	1    0         0       1  0.001088
	2    0         1       0  0.251850
	3    0         1       1  0.748150
	4    1         0       0  0.128790
	5    1         0       1  0.871210
	6    1         1       0  0.559500
	7    1         1       1  0.440500

Eliminate variable: Leaving

Factors to multiply containing variable: Leaving

	  Leaving  prob
	0       0   1.0
	1       1   1.0

	  Fire Tampering Leaving      prob
	0    0         0       0  0.998912
	1    0         0       1  0.001088
	2    0         1       0  0.251850
	3    0         1       1  0.748150
	4    1         0       0  0.128790
	5    1         0       1  0.871210
	6    1         1       0  0.559500
	7    1         1       1  0.440500

Result of multiplication: 

	  Fire Leaving Tampering      prob
	0    0       0         0  0.998912
	1    0       0         1  0.251850
	2    1       0         0  0.128790
	3    1       0         1  0.559500
	4    0       1         0  0.001088
	5    0       1         1  0.748150
	6    1       1         0  0.871210
	7    1       1         1  0.440500

Sum out Leaving

	  Fire Tampering  prob
	0    0         0   1.0
	1    0         1   1.0
	2    1         0   1.0
	3    1         1   1.0

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire Tampering  prob
	0    0         0   1.0
	1    0         1   1.0
	2    1         0   1.0
	3    1         1   1.0

Eliminate variable: Tampering

Factors to multiply containing variable: Tampering

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire Tampering  prob
	0    0         0   1.0
	1    0         1   1.0
	2    1         0   1.0
	3    1         1   1.0

Result of multiplication: 

	  Fire Tampering  prob
	0    0         0  0.98
	1    1         0  0.98
	2    0         1  0.02
	3    1         1  0.02

Storing factor for backtracking to find value of Tampering

	  Fire Tampering  prob
	0    0         0  0.98
	1    1         0  0.98
	2    0         1  0.02
	3    1         1  0.02

Maximise out Tampering

	  Fire  prob
	0    0  0.98
	1    1  0.98

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Fire  prob
	0    0  0.98
	1    1  0.98

Eliminate variable: Fire

Factors to multiply containing variable: Fire

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Fire  prob
	0    0  0.98
	1    1  0.98

Result of multiplication: 

	  Fire      prob
	0    0  0.009702
	1    1  0.008820

Storing factor for backtracking to find value of Fire

	  Fire      prob
	0    0  0.009702
	1    1  0.008820

New List of Factors: 

	  Fire      prob
	0    0  0.009702
	1    1  0.008820

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	  Fire      prob
	0    0  0.009702
	1    1  0.008820

Finding MAP instantiation for Fire

MAP assignment for variable Fire is 0

Popped this factor from the backtracking stack:

	  Fire Tampering  prob
	0    0         0  0.98
	1    1         0  0.98
	2    0         1  0.02
	3    1         1  0.02

Finding MAP instantiation for Tampering

MAP assignment for variable Tampering is 0

Final Map Instantiation:

Fire->0

Tampering->0

Elimination Order: ['JohnCalls', 'MaryCalls', 'Earthquake', 'Alarm']

MAP Variables: ['Alarm']

Observed Variables: {'Burglary': 'True'}

Original Factors: 

	  Burglary  prob
	0     True  0.01
	1    False  0.99

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Burglary Earthquake   prob
	0   True     True       True  0.950
	1  False     True       True  0.050
	2   True    False       True  0.290
	3  False    False       True  0.710
	4   True     True      False  0.940
	5  False     True      False  0.060
	6   True    False      False  0.001
	7  False    False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Factors with evidence applied: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Eliminate variable: JohnCalls

Factors to multiply containing variable: JohnCalls

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Result of multiplication: 

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Sum out JohnCalls

	   Alarm  prob
	0  False   1.0
	1   True   1.0

New List of Factors: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

	   Alarm  prob
	0  False   1.0
	1   True   1.0

Eliminate variable: MaryCalls

Factors to multiply containing variable: MaryCalls

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Result of multiplication: 

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Sum out MaryCalls

	   Alarm  prob
	0  False   1.0
	1   True   1.0

New List of Factors: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

Eliminate variable: Earthquake

Factors to multiply containing variable: Earthquake

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

Result of multiplication: 

	   Alarm Earthquake    prob
	0   True       True  0.0190
	1  False       True  0.0010
	2   True      False  0.9212
	3  False      False  0.0588

Sum out Earthquake

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

New List of Factors: 

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Result of multiplication: 

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Storing factor for backtracking to find value of Alarm

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

New List of Factors: 

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Finding MAP instantiation for Alarm

MAP assignment for variable Alarm is True

Final Map Instantiation:

Alarm->True

Elimination Order: ['JohnCalls', 'MaryCalls', 'Earthquake', 'Alarm']

MAP Variables: ['Alarm']

Observed Variables: {'Burglary': 'False'}

Original Factors: 

	  Burglary  prob
	0     True  0.01
	1    False  0.99

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Burglary Earthquake   prob
	0   True     True       True  0.950
	1  False     True       True  0.050
	2   True    False       True  0.290
	3  False    False       True  0.710
	4   True     True      False  0.940
	5  False     True      False  0.060
	6   True    False      False  0.001
	7  False    False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Factors with evidence applied: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Eliminate variable: JohnCalls

Factors to multiply containing variable: JohnCalls

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Result of multiplication: 

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Sum out JohnCalls

	   Alarm  prob
	0  False   1.0
	1   True   1.0

New List of Factors: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

	   Alarm  prob
	0  False   1.0
	1   True   1.0

Eliminate variable: MaryCalls

Factors to multiply containing variable: MaryCalls

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Result of multiplication: 

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Sum out MaryCalls

	   Alarm  prob
	0  False   1.0
	1   True   1.0

New List of Factors: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

Eliminate variable: Earthquake

Factors to multiply containing variable: Earthquake

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

Result of multiplication: 

	   Alarm Earthquake     prob
	0   True       True  0.00580
	1  False       True  0.01420
	2   True      False  0.00098
	3  False      False  0.97902

Sum out Earthquake

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

New List of Factors: 

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

Result of multiplication: 

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

Storing factor for backtracking to find value of Alarm

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

New List of Factors: 

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

Finding MAP instantiation for Alarm

MAP assignment for variable Alarm is False

Final Map Instantiation:

Alarm->False

Elimination Order: ['Alarm', 'Leaving', 'Fire', 'Report', 'Tampering']

MAP Variables: ['Tampering', 'Report']

Observed Variables: {'Smoke': '1'}

Original Factors: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Factors with evidence applied: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

Result of multiplication: 

	   Alarm Tampering Fire Leaving      prob
	0      0         0    0       0  0.998900
	1      0         0    0       1  0.001000
	2      1         0    0       0  0.000012
	3      1         0    0       1  0.000088
	4      0         1    0       0  0.149850
	5      0         1    0       1  0.000150
	6      1         1    0       0  0.102000
	7      1         1    0       1  0.748000
	8      0         0    1       0  0.009990
	9      0         0    1       1  0.000010
	10     1         0    1       0  0.118800
	11     1         0    1       1  0.871200
	12     0         1    1       0  0.499500
	13     0         1    1       1  0.000500
	14     1         1    1       0  0.060000
	15     1         1    1       1  0.440000

Sum out Alarm

	  Tampering Fire Leaving      prob
	0         0    0       0  0.998912
	1         0    0       1  0.001088
	2         0    1       0  0.128790
	3         0    1       1  0.871210
	4         1    0       0  0.251850
	5         1    0       1  0.748150
	6         1    1       0  0.559500
	7         1    1       1  0.440500

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering Fire Leaving      prob
	0         0    0       0  0.998912
	1         0    0       1  0.001088
	2         0    1       0  0.128790
	3         0    1       1  0.871210
	4         1    0       0  0.251850
	5         1    0       1  0.748150
	6         1    1       0  0.559500
	7         1    1       1  0.440500

Eliminate variable: Leaving

Factors to multiply containing variable: Leaving

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Tampering Fire Leaving      prob
	0         0    0       0  0.998912
	1         0    0       1  0.001088
	2         0    1       0  0.128790
	3         0    1       1  0.871210
	4         1    0       0  0.251850
	5         1    0       1  0.748150
	6         1    1       0  0.559500
	7         1    1       1  0.440500

Result of multiplication: 

	   Tampering Leaving Fire Report      prob
	0          0       0    0      0  0.988923
	1          0       0    1      0  0.127502
	2          1       0    0      0  0.249331
	3          1       0    1      0  0.553905
	4          0       0    0      1  0.009989
	5          0       0    1      1  0.001288
	6          1       0    0      1  0.002518
	7          1       0    1      1  0.005595
	8          0       1    0      0  0.000272
	9          0       1    1      0  0.217802
	10         1       1    0      0  0.187037
	11         1       1    1      0  0.110125
	12         0       1    0      1  0.000816
	13         0       1    1      1  0.653407
	14         1       1    0      1  0.561113
	15         1       1    1      1  0.330375

Sum out Leaving

	  Tampering Fire Report      prob
	0         0    0      0  0.989195
	1         0    0      1  0.010805
	2         0    1      0  0.345305
	3         0    1      1  0.654695
	4         1    0      0  0.436369
	5         1    0      1  0.563631
	6         1    1      0  0.664030
	7         1    1      1  0.335970

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering Fire Report      prob
	0         0    0      0  0.989195
	1         0    0      1  0.010805
	2         0    1      0  0.345305
	3         0    1      1  0.654695
	4         1    0      0  0.436369
	5         1    0      1  0.563631
	6         1    1      0  0.664030
	7         1    1      1  0.335970

Eliminate variable: Fire

Factors to multiply containing variable: Fire

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering Fire Report      prob
	0         0    0      0  0.989195
	1         0    0      1  0.010805
	2         0    1      0  0.345305
	3         0    1      1  0.654695
	4         1    0      0  0.436369
	5         1    0      1  0.563631
	6         1    1      0  0.664030
	7         1    1      1  0.335970

Result of multiplication: 

	  Tampering Fire Report      prob
	0         0    0      0  0.009793
	1         0    0      1  0.000107
	2         1    0      0  0.004320
	3         1    0      1  0.005580
	4         0    1      0  0.003108
	5         0    1      1  0.005892
	6         1    1      0  0.005976
	7         1    1      1  0.003024

Sum out Fire

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Eliminate variable: Report

Factors to multiply containing variable: Report

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Result of multiplication: 

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Storing factor for backtracking to find value of Report

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Maximise out Report

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

Eliminate variable: Tampering

Factors to multiply containing variable: Tampering

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

Result of multiplication: 

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Storing factor for backtracking to find value of Tampering

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

New List of Factors: 

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Finding MAP instantiation for Tampering

MAP assignment for variable Tampering is 0

Popped this factor from the backtracking stack:

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Finding MAP instantiation for Report

MAP assignment for variable Report is 0

Final Map Instantiation:

Tampering->0

Report->0

Elimination Order: ['Smoke', 'Alarm', 'Leaving', 'Fire', 'Report', 'Tampering']

MAP Variables: ['Tampering', 'Report']

Observed Variables: {}

Original Factors: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Factors with evidence applied: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Eliminate variable: Smoke

Factors to multiply containing variable: Smoke

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

Result of multiplication: 

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

Sum out Smoke

	  Fire  prob
	0    0   1.0
	1    1   1.0

New List of Factors: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire  prob
	0    0   1.0
	1    1   1.0

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

Result of multiplication: 

	   Alarm Tampering Fire Leaving      prob
	0      0         0    0       0  0.998900
	1      0         0    0       1  0.001000
	2      1         0    0       0  0.000012
	3      1         0    0       1  0.000088
	4      0         1    0       0  0.149850
	5      0         1    0       1  0.000150
	6      1         1    0       0  0.102000
	7      1         1    0       1  0.748000
	8      0         0    1       0  0.009990
	9      0         0    1       1  0.000010
	10     1         0    1       0  0.118800
	11     1         0    1       1  0.871200
	12     0         1    1       0  0.499500
	13     0         1    1       1  0.000500
	14     1         1    1       0  0.060000
	15     1         1    1       1  0.440000

Sum out Alarm

	  Tampering Fire Leaving      prob
	0         0    0       0  0.998912
	1         0    0       1  0.001088
	2         0    1       0  0.128790
	3         0    1       1  0.871210
	4         1    0       0  0.251850
	5         1    0       1  0.748150
	6         1    1       0  0.559500
	7         1    1       1  0.440500

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire  prob
	0    0   1.0
	1    1   1.0

	  Tampering Fire Leaving      prob
	0         0    0       0  0.998912
	1         0    0       1  0.001088
	2         0    1       0  0.128790
	3         0    1       1  0.871210
	4         1    0       0  0.251850
	5         1    0       1  0.748150
	6         1    1       0  0.559500
	7         1    1       1  0.440500

Eliminate variable: Leaving

Factors to multiply containing variable: Leaving

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Tampering Fire Leaving      prob
	0         0    0       0  0.998912
	1         0    0       1  0.001088
	2         0    1       0  0.128790
	3         0    1       1  0.871210
	4         1    0       0  0.251850
	5         1    0       1  0.748150
	6         1    1       0  0.559500
	7         1    1       1  0.440500

Result of multiplication: 

	   Tampering Leaving Fire Report      prob
	0          0       0    0      0  0.988923
	1          0       0    1      0  0.127502
	2          1       0    0      0  0.249331
	3          1       0    1      0  0.553905
	4          0       0    0      1  0.009989
	5          0       0    1      1  0.001288
	6          1       0    0      1  0.002518
	7          1       0    1      1  0.005595
	8          0       1    0      0  0.000272
	9          0       1    1      0  0.217802
	10         1       1    0      0  0.187037
	11         1       1    1      0  0.110125
	12         0       1    0      1  0.000816
	13         0       1    1      1  0.653407
	14         1       1    0      1  0.561113
	15         1       1    1      1  0.330375

Sum out Leaving

	  Tampering Fire Report      prob
	0         0    0      0  0.989195
	1         0    0      1  0.010805
	2         0    1      0  0.345305
	3         0    1      1  0.654695
	4         1    0      0  0.436369
	5         1    0      1  0.563631
	6         1    1      0  0.664030
	7         1    1      1  0.335970

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire  prob
	0    0   1.0
	1    1   1.0

	  Tampering Fire Report      prob
	0         0    0      0  0.989195
	1         0    0      1  0.010805
	2         0    1      0  0.345305
	3         0    1      1  0.654695
	4         1    0      0  0.436369
	5         1    0      1  0.563631
	6         1    1      0  0.664030
	7         1    1      1  0.335970

Eliminate variable: Fire

Factors to multiply containing variable: Fire

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	0    0   1.0
	1    1   1.0

	  Tampering Fire Report      prob
	0         0    0      0  0.989195
	1         0    0      1  0.010805
	2         0    1      0  0.345305
	3         0    1      1  0.654695
	4         1    0      0  0.436369
	5         1    0      1  0.563631
	6         1    1      0  0.664030
	7         1    1      1  0.335970

Result of multiplication: 

	  Tampering Fire Report      prob
	0         0    0      0  0.979303
	1         0    0      1  0.010697
	2         1    0      0  0.432005
	3         1    0      1  0.557995
	4         0    1      0  0.003453
	5         0    1      1  0.006547
	6         1    1      0  0.006640
	7         1    1      1  0.003360

Sum out Fire

	  Tampering Report      prob
	0         0      0  0.982756
	1         0      1  0.017244
	2         1      0  0.438646
	3         1      1  0.561354

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering Report      prob
	0         0      0  0.982756
	1         0      1  0.017244
	2         1      0  0.438646
	3         1      1  0.561354

Eliminate variable: Report

Factors to multiply containing variable: Report

	  Tampering Report      prob
	0         0      0  0.982756
	1         0      1  0.017244
	2         1      0  0.438646
	3         1      1  0.561354

Result of multiplication: 

	  Tampering Report      prob
	0         0      0  0.982756
	1         0      1  0.017244
	2         1      0  0.438646
	3         1      1  0.561354

Storing factor for backtracking to find value of Report

	  Tampering Report      prob
	0         0      0  0.982756
	1         0      1  0.017244
	2         1      0  0.438646
	3         1      1  0.561354

Maximise out Report

	  Tampering      prob
	0         0  0.982756
	1         1  0.561354

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.982756
	1         1  0.561354

Eliminate variable: Tampering

Factors to multiply containing variable: Tampering

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.982756
	1         1  0.561354

Result of multiplication: 

	  Tampering      prob
	0         0  0.963101
	1         1  0.011227

Storing factor for backtracking to find value of Tampering

	  Tampering      prob
	0         0  0.963101
	1         1  0.011227

New List of Factors: 

	  Tampering      prob
	0         0  0.963101
	1         1  0.011227

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	  Tampering      prob
	0         0  0.963101
	1         1  0.011227

Finding MAP instantiation for Tampering

MAP assignment for variable Tampering is 0

Popped this factor from the backtracking stack:

	  Tampering Report      prob
	0         0      0  0.982756
	1         0      1  0.017244
	2         1      0  0.438646
	3         1      1  0.561354

Finding MAP instantiation for Report

MAP assignment for variable Report is 0

Final Map Instantiation:

Tampering->0

Report->0

Elimination Order: ['Report', 'Alarm', 'Leaving', 'Tampering', 'Fire']

MAP Variables: ['Tampering', 'Fire']

Observed Variables: {'Smoke': '1'}

Original Factors: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Factors with evidence applied: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Eliminate variable: Report

Factors to multiply containing variable: Report

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

Result of multiplication: 

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

Sum out Report

	  Leaving  prob
	0       0   1.0
	1       1   1.0

New List of Factors: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Leaving  prob
	0       0   1.0
	1       1   1.0

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

Result of multiplication: 

	   Alarm Tampering Fire Leaving      prob
	0      0         0    0       0  0.998900
	1      0         0    0       1  0.001000
	2      1         0    0       0  0.000012
	3      1         0    0       1  0.000088
	4      0         1    0       0  0.149850
	5      0         1    0       1  0.000150
	6      1         1    0       0  0.102000
	7      1         1    0       1  0.748000
	8      0         0    1       0  0.009990
	9      0         0    1       1  0.000010
	10     1         0    1       0  0.118800
	11     1         0    1       1  0.871200
	12     0         1    1       0  0.499500
	13     0         1    1       1  0.000500
	14     1         1    1       0  0.060000
	15     1         1    1       1  0.440000

Sum out Alarm

	  Tampering Fire Leaving      prob
	0         0    0       0  0.998912
	1         0    0       1  0.001088
	2         0    1       0  0.128790
	3         0    1       1  0.871210
	4         1    0       0  0.251850
	5         1    0       1  0.748150
	6         1    1       0  0.559500
	7         1    1       1  0.440500

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Leaving  prob
	0       0   1.0
	1       1   1.0

	  Tampering Fire Leaving      prob
	0         0    0       0  0.998912
	1         0    0       1  0.001088
	2         0    1       0  0.128790
	3         0    1       1  0.871210
	4         1    0       0  0.251850
	5         1    0       1  0.748150
	6         1    1       0  0.559500
	7         1    1       1  0.440500

Eliminate variable: Leaving

Factors to multiply containing variable: Leaving

	  Leaving  prob
	0       0   1.0
	1       1   1.0

	  Tampering Fire Leaving      prob
	0         0    0       0  0.998912
	1         0    0       1  0.001088
	2         0    1       0  0.128790
	3         0    1       1  0.871210
	4         1    0       0  0.251850
	5         1    0       1  0.748150
	6         1    1       0  0.559500
	7         1    1       1  0.440500

Result of multiplication: 

	  Tampering Fire Leaving      prob
	0         0    0       0  0.998912
	1         0    1       0  0.128790
	2         1    0       0  0.251850
	3         1    1       0  0.559500
	4         0    0       1  0.001088
	5         0    1       1  0.871210
	6         1    0       1  0.748150
	7         1    1       1  0.440500

Sum out Leaving

	  Tampering Fire  prob
	0         0    0   1.0
	1         0    1   1.0
	2         1    0   1.0
	3         1    1   1.0

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering Fire  prob
	0         0    0   1.0
	1         0    1   1.0
	2         1    0   1.0
	3         1    1   1.0

Eliminate variable: Tampering

Factors to multiply containing variable: Tampering

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering Fire  prob
	0         0    0   1.0
	1         0    1   1.0
	2         1    0   1.0
	3         1    1   1.0

Result of multiplication: 

	  Tampering Fire  prob
	0         0    0  0.98
	1         0    1  0.98
	2         1    0  0.02
	3         1    1  0.02

Storing factor for backtracking to find value of Tampering

	  Tampering Fire  prob
	0         0    0  0.98
	1         0    1  0.98
	2         1    0  0.02
	3         1    1  0.02

Maximise out Tampering

	  Fire  prob
	0    0  0.98
	1    1  0.98

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Fire  prob
	0    0  0.98
	1    1  0.98

Eliminate variable: Fire

Factors to multiply containing variable: Fire

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Fire  prob
	0    0  0.98
	1    1  0.98

Result of multiplication: 

	  Fire      prob
	0    0  0.009702
	1    1  0.008820

Storing factor for backtracking to find value of Fire

	  Fire      prob
	0    0  0.009702
	1    1  0.008820

New List of Factors: 

	  Fire      prob
	0    0  0.009702
	1    1  0.008820

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	  Fire      prob
	0    0  0.009702
	1    1  0.008820

Finding MAP instantiation for Fire

MAP assignment for variable Fire is 0

Popped this factor from the backtracking stack:

	  Tampering Fire  prob
	0         0    0  0.98
	1         0    1  0.98
	2         1    0  0.02
	3         1    1  0.02

Finding MAP instantiation for Tampering

MAP assignment for variable Tampering is 0

Final Map Instantiation:

Fire->0

Tampering->0

Elimination Order: ['JohnCalls', 'MaryCalls', 'Earthquake', 'Alarm']

MAP Variables: ['Alarm']

Observed Variables: {'Burglary': 'True'}

Original Factors: 

	  Burglary  prob
	0     True  0.01
	1    False  0.99

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Burglary Earthquake   prob
	0   True     True       True  0.950
	1  False     True       True  0.050
	2   True    False       True  0.290
	3  False    False       True  0.710
	4   True     True      False  0.940
	5  False     True      False  0.060
	6   True    False      False  0.001
	7  False    False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Factors with evidence applied: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Eliminate variable: JohnCalls

Factors to multiply containing variable: JohnCalls

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Result of multiplication: 

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Sum out JohnCalls

	   Alarm  prob
	0  False   1.0
	1   True   1.0

New List of Factors: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

	   Alarm  prob
	0  False   1.0
	1   True   1.0

Eliminate variable: MaryCalls

Factors to multiply containing variable: MaryCalls

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Result of multiplication: 

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Sum out MaryCalls

	   Alarm  prob
	0  False   1.0
	1   True   1.0

New List of Factors: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

Eliminate variable: Earthquake

Factors to multiply containing variable: Earthquake

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

Result of multiplication: 

	   Alarm Earthquake    prob
	0   True       True  0.0190
	1  False       True  0.0010
	2   True      False  0.9212
	3  False      False  0.0588

Sum out Earthquake

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

New List of Factors: 

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Result of multiplication: 

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Storing factor for backtracking to find value of Alarm

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

New List of Factors: 

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Finding MAP instantiation for Alarm

MAP assignment for variable Alarm is True

Final Map Instantiation:

Alarm->True

Elimination Order: ['JohnCalls', 'MaryCalls', 'Earthquake', 'Alarm']

MAP Variables: ['Alarm']

Observed Variables: {'Burglary': 'False'}

Original Factors: 

	  Burglary  prob
	0     True  0.01
	1    False  0.99

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Burglary Earthquake   prob
	0   True     True       True  0.950
	1  False     True       True  0.050
	2   True    False       True  0.290
	3  False    False       True  0.710
	4   True     True      False  0.940
	5  False     True      False  0.060
	6   True    False      False  0.001
	7  False    False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Factors with evidence applied: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Eliminate variable: JohnCalls

Factors to multiply containing variable: JohnCalls

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Result of multiplication: 

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Sum out JohnCalls

	   Alarm  prob
	0  False   1.0
	1   True   1.0

New List of Factors: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

	   Alarm  prob
	0  False   1.0
	1   True   1.0

Eliminate variable: MaryCalls

Factors to multiply containing variable: MaryCalls

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Result of multiplication: 

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Sum out MaryCalls

	   Alarm  prob
	0  False   1.0
	1   True   1.0

New List of Factors: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

Eliminate variable: Earthquake

Factors to multiply containing variable: Earthquake

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

Result of multiplication: 

	   Alarm Earthquake     prob
	0   True       True  0.00580
	1  False       True  0.01420
	2   True      False  0.00098
	3  False      False  0.97902

Sum out Earthquake

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

New List of Factors: 

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

Result of multiplication: 

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

Storing factor for backtracking to find value of Alarm

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

New List of Factors: 

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

Finding MAP instantiation for Alarm

MAP assignment for variable Alarm is False

Final Map Instantiation:

Alarm->False

Elimination Order: ['Alarm', 'Leaving', 'Fire', 'Report', 'Tampering']

MAP Variables: ['Tampering', 'Report']

Observed Variables: {'Smoke': '1'}

Original Factors: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Factors with evidence applied: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

Result of multiplication: 

	   Tampering Leaving Alarm Fire      prob
	0          0       0     0    0  0.998900
	1          0       1     0    0  0.001000
	2          0       0     1    0  0.000012
	3          0       1     1    0  0.000088
	4          1       0     0    0  0.149850
	5          1       1     0    0  0.000150
	6          1       0     1    0  0.102000
	7          1       1     1    0  0.748000
	8          0       0     0    1  0.009990
	9          0       1     0    1  0.000010
	10         0       0     1    1  0.118800
	11         0       1     1    1  0.871200
	12         1       0     0    1  0.499500
	13         1       1     0    1  0.000500
	14         1       0     1    1  0.060000
	15         1       1     1    1  0.440000

Sum out Alarm

	  Tampering Leaving Fire      prob
	0         0       0    0  0.998912
	1         0       0    1  0.128790
	2         0       1    0  0.001088
	3         0       1    1  0.871210
	4         1       0    0  0.251850
	5         1       0    1  0.559500
	6         1       1    0  0.748150
	7         1       1    1  0.440500

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering Leaving Fire      prob
	0         0       0    0  0.998912
	1         0       0    1  0.128790
	2         0       1    0  0.001088
	3         0       1    1  0.871210
	4         1       0    0  0.251850
	5         1       0    1  0.559500
	6         1       1    0  0.748150
	7         1       1    1  0.440500

Eliminate variable: Leaving

Factors to multiply containing variable: Leaving

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Tampering Leaving Fire      prob
	0         0       0    0  0.998912
	1         0       0    1  0.128790
	2         0       1    0  0.001088
	3         0       1    1  0.871210
	4         1       0    0  0.251850
	5         1       0    1  0.559500
	6         1       1    0  0.748150
	7         1       1    1  0.440500

Result of multiplication: 

	   Tampering Report Leaving Fire      prob
	0          0      0       0    0  0.988923
	1          0      0       0    1  0.127502
	2          1      0       0    0  0.249331
	3          1      0       0    1  0.553905
	4          0      1       0    0  0.009989
	5          0      1       0    1  0.001288
	6          1      1       0    0  0.002518
	7          1      1       0    1  0.005595
	8          0      0       1    0  0.000272
	9          0      0       1    1  0.217802
	10         1      0       1    0  0.187037
	11         1      0       1    1  0.110125
	12         0      1       1    0  0.000816
	13         0      1       1    1  0.653407
	14         1      1       1    0  0.561113
	15         1      1       1    1  0.330375

Sum out Leaving

	  Tampering Report Fire      prob
	0         0      0    0  0.989195
	1         0      0    1  0.345305
	2         0      1    0  0.010805
	3         0      1    1  0.654695
	4         1      0    0  0.436369
	5         1      0    1  0.664030
	6         1      1    0  0.563631
	7         1      1    1  0.335970

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering Report Fire      prob
	0         0      0    0  0.989195
	1         0      0    1  0.345305
	2         0      1    0  0.010805
	3         0      1    1  0.654695
	4         1      0    0  0.436369
	5         1      0    1  0.664030
	6         1      1    0  0.563631
	7         1      1    1  0.335970

Eliminate variable: Fire

Factors to multiply containing variable: Fire

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering Report Fire      prob
	0         0      0    0  0.989195
	1         0      0    1  0.345305
	2         0      1    0  0.010805
	3         0      1    1  0.654695
	4         1      0    0  0.436369
	5         1      0    1  0.664030
	6         1      1    0  0.563631
	7         1      1    1  0.335970

Result of multiplication: 

	  Tampering Report Fire      prob
	0         0      0    0  0.009793
	1         0      1    0  0.000107
	2         1      0    0  0.004320
	3         1      1    0  0.005580
	4         0      0    1  0.003108
	5         0      1    1  0.005892
	6         1      0    1  0.005976
	7         1      1    1  0.003024

Sum out Fire

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Eliminate variable: Report

Factors to multiply containing variable: Report

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Result of multiplication: 

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Storing factor for backtracking to find value of Report

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Maximise out Report

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

Eliminate variable: Tampering

Factors to multiply containing variable: Tampering

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

Result of multiplication: 

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Storing factor for backtracking to find value of Tampering

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

New List of Factors: 

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Finding MAP instantiation for Tampering

MAP assignment for variable Tampering is 0

Popped this factor from the backtracking stack:

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Finding MAP instantiation for Report

MAP assignment for variable Report is 0

Final Map Instantiation:

Tampering->0

Report->0

Elimination Order: ['Smoke', 'Alarm', 'Leaving', 'Fire', 'Report', 'Tampering']

MAP Variables: ['Tampering', 'Report']

Observed Variables: {}

Original Factors: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Factors with evidence applied: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Eliminate variable: Smoke

Factors to multiply containing variable: Smoke

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

Result of multiplication: 

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

Sum out Smoke

	  Fire  prob
	0    0   1.0
	1    1   1.0

New List of Factors: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire  prob
	0    0   1.0
	1    1   1.0

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

Result of multiplication: 

	   Tampering Leaving Alarm Fire      prob
	0          0       0     0    0  0.998900
	1          0       1     0    0  0.001000
	2          0       0     1    0  0.000012
	3          0       1     1    0  0.000088
	4          1       0     0    0  0.149850
	5          1       1     0    0  0.000150
	6          1       0     1    0  0.102000
	7          1       1     1    0  0.748000
	8          0       0     0    1  0.009990
	9          0       1     0    1  0.000010
	10         0       0     1    1  0.118800
	11         0       1     1    1  0.871200
	12         1       0     0    1  0.499500
	13         1       1     0    1  0.000500
	14         1       0     1    1  0.060000
	15         1       1     1    1  0.440000

Sum out Alarm

	  Tampering Leaving Fire      prob
	0         0       0    0  0.998912
	1         0       0    1  0.128790
	2         0       1    0  0.001088
	3         0       1    1  0.871210
	4         1       0    0  0.251850
	5         1       0    1  0.559500
	6         1       1    0  0.748150
	7         1       1    1  0.440500

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire  prob
	0    0   1.0
	1    1   1.0

	  Tampering Leaving Fire      prob
	0         0       0    0  0.998912
	1         0       0    1  0.128790
	2         0       1    0  0.001088
	3         0       1    1  0.871210
	4         1       0    0  0.251850
	5         1       0    1  0.559500
	6         1       1    0  0.748150
	7         1       1    1  0.440500

Eliminate variable: Leaving

Factors to multiply containing variable: Leaving

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Tampering Leaving Fire      prob
	0         0       0    0  0.998912
	1         0       0    1  0.128790
	2         0       1    0  0.001088
	3         0       1    1  0.871210
	4         1       0    0  0.251850
	5         1       0    1  0.559500
	6         1       1    0  0.748150
	7         1       1    1  0.440500

Result of multiplication: 

	   Tampering Report Leaving Fire      prob
	0          0      0       0    0  0.988923
	1          0      0       0    1  0.127502
	2          1      0       0    0  0.249331
	3          1      0       0    1  0.553905
	4          0      1       0    0  0.009989
	5          0      1       0    1  0.001288
	6          1      1       0    0  0.002518
	7          1      1       0    1  0.005595
	8          0      0       1    0  0.000272
	9          0      0       1    1  0.217802
	10         1      0       1    0  0.187037
	11         1      0       1    1  0.110125
	12         0      1       1    0  0.000816
	13         0      1       1    1  0.653407
	14         1      1       1    0  0.561113
	15         1      1       1    1  0.330375

Sum out Leaving

	  Tampering Report Fire      prob
	0         0      0    0  0.989195
	1         0      0    1  0.345305
	2         0      1    0  0.010805
	3         0      1    1  0.654695
	4         1      0    0  0.436369
	5         1      0    1  0.664030
	6         1      1    0  0.563631
	7         1      1    1  0.335970

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire  prob
	0    0   1.0
	1    1   1.0

	  Tampering Report Fire      prob
	0         0      0    0  0.989195
	1         0      0    1  0.345305
	2         0      1    0  0.010805
	3         0      1    1  0.654695
	4         1      0    0  0.436369
	5         1      0    1  0.664030
	6         1      1    0  0.563631
	7         1      1    1  0.335970

Eliminate variable: Fire

Factors to multiply containing variable: Fire

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	0    0   1.0
	1    1   1.0

	  Tampering Report Fire      prob
	0         0      0    0  0.989195
	1         0      0    1  0.345305
	2         0      1    0  0.010805
	3         0      1    1  0.654695
	4         1      0    0  0.436369
	5         1      0    1  0.664030
	6         1      1    0  0.563631
	7         1      1    1  0.335970

Result of multiplication: 

	  Tampering Report Fire      prob
	0         0      0    0  0.979303
	1         0      1    0  0.010697
	2         1      0    0  0.432005
	3         1      1    0  0.557995
	4         0      0    1  0.003453
	5         0      1    1  0.006547
	6         1      0    1  0.006640
	7         1      1    1  0.003360

Sum out Fire

	  Tampering Report      prob
	0         0      0  0.982756
	1         0      1  0.017244
	2         1      0  0.438646
	3         1      1  0.561354

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering Report      prob
	0         0      0  0.982756
	1         0      1  0.017244
	2         1      0  0.438646
	3         1      1  0.561354

Eliminate variable: Report

Factors to multiply containing variable: Report

	  Tampering Report      prob
	0         0      0  0.982756
	1         0      1  0.017244
	2         1      0  0.438646
	3         1      1  0.561354

Result of multiplication: 

	  Tampering Report      prob
	0         0      0  0.982756
	1         0      1  0.017244
	2         1      0  0.438646
	3         1      1  0.561354

Storing factor for backtracking to find value of Report

	  Tampering Report      prob
	0         0      0  0.982756
	1         0      1  0.017244
	2         1      0  0.438646
	3         1      1  0.561354

Maximise out Report

	  Tampering      prob
	0         0  0.982756
	1         1  0.561354

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.982756
	1         1  0.561354

Eliminate variable: Tampering

Factors to multiply containing variable: Tampering

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.982756
	1         1  0.561354

Result of multiplication: 

	  Tampering      prob
	0         0  0.963101
	1         1  0.011227

Storing factor for backtracking to find value of Tampering

	  Tampering      prob
	0         0  0.963101
	1         1  0.011227

New List of Factors: 

	  Tampering      prob
	0         0  0.963101
	1         1  0.011227

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	  Tampering      prob
	0         0  0.963101
	1         1  0.011227

Finding MAP instantiation for Tampering

MAP assignment for variable Tampering is 0

Popped this factor from the backtracking stack:

	  Tampering Report      prob
	0         0      0  0.982756
	1         0      1  0.017244
	2         1      0  0.438646
	3         1      1  0.561354

Finding MAP instantiation for Report

MAP assignment for variable Report is 0

Final Map Instantiation:

Tampering->0

Report->0

Elimination Order: ['Alarm', 'Leaving', 'Fire', 'Report', 'Tampering']

MAP Variables: ['Tampering', 'Report']

Observed Variables: {'Smoke': '1'}

Original Factors: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Factors with evidence applied: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

Result of multiplication: 

	   Tampering Leaving Alarm Fire      prob
	0          0       0     0    0  0.998900
	1          0       1     0    0  0.001000
	2          0       0     1    0  0.000012
	3          0       1     1    0  0.000088
	4          1       0     0    0  0.149850
	5          1       1     0    0  0.000150
	6          1       0     1    0  0.102000
	7          1       1     1    0  0.748000
	8          0       0     0    1  0.009990
	9          0       1     0    1  0.000010
	10         0       0     1    1  0.118800
	11         0       1     1    1  0.871200
	12         1       0     0    1  0.499500
	13         1       1     0    1  0.000500
	14         1       0     1    1  0.060000
	15         1       1     1    1  0.440000

Sum out Alarm

	  Tampering Leaving Fire      prob
	0         0       0    0  0.998912
	1         0       0    1  0.128790
	2         0       1    0  0.001088
	3         0       1    1  0.871210
	4         1       0    0  0.251850
	5         1       0    1  0.559500
	6         1       1    0  0.748150
	7         1       1    1  0.440500

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering Leaving Fire      prob
	0         0       0    0  0.998912
	1         0       0    1  0.128790
	2         0       1    0  0.001088
	3         0       1    1  0.871210
	4         1       0    0  0.251850
	5         1       0    1  0.559500
	6         1       1    0  0.748150
	7         1       1    1  0.440500

Eliminate variable: Leaving

Factors to multiply containing variable: Leaving

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Tampering Leaving Fire      prob
	0         0       0    0  0.998912
	1         0       0    1  0.128790
	2         0       1    0  0.001088
	3         0       1    1  0.871210
	4         1       0    0  0.251850
	5         1       0    1  0.559500
	6         1       1    0  0.748150
	7         1       1    1  0.440500

Result of multiplication: 

	   Tampering Report Leaving Fire      prob
	0          0      0       0    0  0.988923
	1          0      0       0    1  0.127502
	2          1      0       0    0  0.249331
	3          1      0       0    1  0.553905
	4          0      1       0    0  0.009989
	5          0      1       0    1  0.001288
	6          1      1       0    0  0.002518
	7          1      1       0    1  0.005595
	8          0      0       1    0  0.000272
	9          0      0       1    1  0.217802
	10         1      0       1    0  0.187037
	11         1      0       1    1  0.110125
	12         0      1       1    0  0.000816
	13         0      1       1    1  0.653407
	14         1      1       1    0  0.561113
	15         1      1       1    1  0.330375

Sum out Leaving

	  Tampering Report Fire      prob
	0         0      0    0  0.989195
	1         0      0    1  0.345305
	2         0      1    0  0.010805
	3         0      1    1  0.654695
	4         1      0    0  0.436369
	5         1      0    1  0.664030
	6         1      1    0  0.563631
	7         1      1    1  0.335970

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering Report Fire      prob
	0         0      0    0  0.989195
	1         0      0    1  0.345305
	2         0      1    0  0.010805
	3         0      1    1  0.654695
	4         1      0    0  0.436369
	5         1      0    1  0.664030
	6         1      1    0  0.563631
	7         1      1    1  0.335970

Eliminate variable: Fire

Factors to multiply containing variable: Fire

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering Report Fire      prob
	0         0      0    0  0.989195
	1         0      0    1  0.345305
	2         0      1    0  0.010805
	3         0      1    1  0.654695
	4         1      0    0  0.436369
	5         1      0    1  0.664030
	6         1      1    0  0.563631
	7         1      1    1  0.335970

Result of multiplication: 

	  Tampering Report Fire      prob
	0         0      0    0  0.009793
	1         0      1    0  0.000107
	2         1      0    0  0.004320
	3         1      1    0  0.005580
	4         0      0    1  0.003108
	5         0      1    1  0.005892
	6         1      0    1  0.005976
	7         1      1    1  0.003024

Sum out Fire

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Eliminate variable: Report

Factors to multiply containing variable: Report

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Result of multiplication: 

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Storing factor for backtracking to find value of Report

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Maximise out Report

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

Eliminate variable: Tampering

Factors to multiply containing variable: Tampering

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

Result of multiplication: 

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Storing factor for backtracking to find value of Tampering

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

New List of Factors: 

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Finding MAP instantiation for Tampering

MAP assignment for variable Tampering is 0

Popped this factor from the backtracking stack:

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Finding MAP instantiation for Report

MAP assignment for variable Report is 0

Final Map Instantiation:

Tampering->0

Report->0

Elimination Order: ['JohnCalls', 'MaryCalls', 'Earthquake', 'Alarm']

MAP Variables: ['Alarm']

Observed Variables: {'Burglary': 'True'}

Original Factors: 

	  Burglary  prob
	0     True  0.01
	1    False  0.99

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Burglary Earthquake   prob
	0   True     True       True  0.950
	1  False     True       True  0.050
	2   True    False       True  0.290
	3  False    False       True  0.710
	4   True     True      False  0.940
	5  False     True      False  0.060
	6   True    False      False  0.001
	7  False    False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Factors with evidence applied: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Eliminate variable: JohnCalls

Factors to multiply containing variable: JohnCalls

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Result of multiplication: 

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Sum out JohnCalls

	   Alarm  prob
	0  False   1.0
	1   True   1.0

New List of Factors: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

	   Alarm  prob
	0  False   1.0
	1   True   1.0

Eliminate variable: MaryCalls

Factors to multiply containing variable: MaryCalls

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Result of multiplication: 

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Sum out MaryCalls

	   Alarm  prob
	0  False   1.0
	1   True   1.0

New List of Factors: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

Eliminate variable: Earthquake

Factors to multiply containing variable: Earthquake

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

Result of multiplication: 

	  Earthquake  Alarm    prob
	0       True   True  0.0190
	1       True  False  0.0010
	2      False   True  0.9212
	3      False  False  0.0588

Sum out Earthquake

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

New List of Factors: 

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Result of multiplication: 

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Storing factor for backtracking to find value of Alarm

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

New List of Factors: 

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Finding MAP instantiation for Alarm

MAP assignment for variable Alarm is True

Final Map Instantiation:

Alarm->True

Elimination Order: ['JohnCalls', 'MaryCalls', 'Earthquake', 'Alarm']

MAP Variables: ['Alarm']

Observed Variables: {'Burglary': 'False'}

Original Factors: 

	  Burglary  prob
	0     True  0.01
	1    False  0.99

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Burglary Earthquake   prob
	0   True     True       True  0.950
	1  False     True       True  0.050
	2   True    False       True  0.290
	3  False    False       True  0.710
	4   True     True      False  0.940
	5  False     True      False  0.060
	6   True    False      False  0.001
	7  False    False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Factors with evidence applied: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Eliminate variable: JohnCalls

Factors to multiply containing variable: JohnCalls

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Result of multiplication: 

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Sum out JohnCalls

	   Alarm  prob
	0  False   1.0
	1   True   1.0

New List of Factors: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

	   Alarm  prob
	0  False   1.0
	1   True   1.0

Eliminate variable: MaryCalls

Factors to multiply containing variable: MaryCalls

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Result of multiplication: 

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Sum out MaryCalls

	   Alarm  prob
	0  False   1.0
	1   True   1.0

New List of Factors: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

Eliminate variable: Earthquake

Factors to multiply containing variable: Earthquake

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

Result of multiplication: 

	  Earthquake  Alarm     prob
	0       True   True  0.00580
	1       True  False  0.01420
	2      False   True  0.00098
	3      False  False  0.97902

Sum out Earthquake

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

New List of Factors: 

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

Result of multiplication: 

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

Storing factor for backtracking to find value of Alarm

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

New List of Factors: 

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

Finding MAP instantiation for Alarm

MAP assignment for variable Alarm is False

Final Map Instantiation:

Alarm->False

Elimination Order: ['Alarm', 'Leaving', 'Fire', 'Report', 'Tampering']

MAP Variables: ['Tampering', 'Report']

Observed Variables: {'Smoke': '1'}

Original Factors: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Factors with evidence applied: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

Result of multiplication: 

	   Fire Leaving Tampering Alarm      prob
	0     0       0         0     0  0.998900
	1     0       1         0     0  0.001000
	2     0       0         0     1  0.000012
	3     0       1         0     1  0.000088
	4     0       0         1     0  0.149850
	5     0       1         1     0  0.000150
	6     0       0         1     1  0.102000
	7     0       1         1     1  0.748000
	8     1       0         0     0  0.009990
	9     1       1         0     0  0.000010
	10    1       0         0     1  0.118800
	11    1       1         0     1  0.871200
	12    1       0         1     0  0.499500
	13    1       1         1     0  0.000500
	14    1       0         1     1  0.060000
	15    1       1         1     1  0.440000

Sum out Alarm

	  Fire Leaving Tampering      prob
	0    0       0         0  0.998912
	1    0       0         1  0.251850
	2    0       1         0  0.001088
	3    0       1         1  0.748150
	4    1       0         0  0.128790
	5    1       0         1  0.559500
	6    1       1         0  0.871210
	7    1       1         1  0.440500

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire Leaving Tampering      prob
	0    0       0         0  0.998912
	1    0       0         1  0.251850
	2    0       1         0  0.001088
	3    0       1         1  0.748150
	4    1       0         0  0.128790
	5    1       0         1  0.559500
	6    1       1         0  0.871210
	7    1       1         1  0.440500

Eliminate variable: Leaving

Factors to multiply containing variable: Leaving

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Fire Leaving Tampering      prob
	0    0       0         0  0.998912
	1    0       0         1  0.251850
	2    0       1         0  0.001088
	3    0       1         1  0.748150
	4    1       0         0  0.128790
	5    1       0         1  0.559500
	6    1       1         0  0.871210
	7    1       1         1  0.440500

Result of multiplication: 

	   Fire Leaving Tampering Report      prob
	0     0       0         0      0  0.988923
	1     0       0         1      0  0.249331
	2     1       0         0      0  0.127502
	3     1       0         1      0  0.553905
	4     0       0         0      1  0.009989
	5     0       0         1      1  0.002518
	6     1       0         0      1  0.001288
	7     1       0         1      1  0.005595
	8     0       1         0      0  0.000272
	9     0       1         1      0  0.187037
	10    1       1         0      0  0.217802
	11    1       1         1      0  0.110125
	12    0       1         0      1  0.000816
	13    0       1         1      1  0.561113
	14    1       1         0      1  0.653407
	15    1       1         1      1  0.330375

Sum out Leaving

	  Fire Tampering Report      prob
	0    0         0      0  0.989195
	1    0         0      1  0.010805
	2    0         1      0  0.436369
	3    0         1      1  0.563631
	4    1         0      0  0.345305
	5    1         0      1  0.654695
	6    1         1      0  0.664030
	7    1         1      1  0.335970

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire Tampering Report      prob
	0    0         0      0  0.989195
	1    0         0      1  0.010805
	2    0         1      0  0.436369
	3    0         1      1  0.563631
	4    1         0      0  0.345305
	5    1         0      1  0.654695
	6    1         1      0  0.664030
	7    1         1      1  0.335970

Eliminate variable: Fire

Factors to multiply containing variable: Fire

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Fire Tampering Report      prob
	0    0         0      0  0.989195
	1    0         0      1  0.010805
	2    0         1      0  0.436369
	3    0         1      1  0.563631
	4    1         0      0  0.345305
	5    1         0      1  0.654695
	6    1         1      0  0.664030
	7    1         1      1  0.335970

Result of multiplication: 

	  Fire Tampering Report      prob
	0    0         0      0  0.009793
	1    0         0      1  0.000107
	2    0         1      0  0.004320
	3    0         1      1  0.005580
	4    1         0      0  0.003108
	5    1         0      1  0.005892
	6    1         1      0  0.005976
	7    1         1      1  0.003024

Sum out Fire

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Eliminate variable: Report

Factors to multiply containing variable: Report

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Result of multiplication: 

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Storing factor for backtracking to find value of Report

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Maximise out Report

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

Eliminate variable: Tampering

Factors to multiply containing variable: Tampering

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

Result of multiplication: 

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Storing factor for backtracking to find value of Tampering

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

New List of Factors: 

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Finding MAP instantiation for Tampering

MAP assignment for variable Tampering is 0

Popped this factor from the backtracking stack:

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Finding MAP instantiation for Report

MAP assignment for variable Report is 0

Final Map Instantiation:

Tampering->0

Report->0

Elimination Order: ['Smoke', 'Alarm', 'Leaving', 'Fire', 'Report', 'Tampering']

MAP Variables: ['Tampering', 'Report']

Observed Variables: {}

Original Factors: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Factors with evidence applied: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Eliminate variable: Smoke

Factors to multiply containing variable: Smoke

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

Result of multiplication: 

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

Sum out Smoke

	  Fire  prob
	0    0   1.0
	1    1   1.0

New List of Factors: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire  prob
	0    0   1.0
	1    1   1.0

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

Result of multiplication: 

	   Fire Leaving Tampering Alarm      prob
	0     0       0         0     0  0.998900
	1     0       1         0     0  0.001000
	2     0       0         0     1  0.000012
	3     0       1         0     1  0.000088
	4     0       0         1     0  0.149850
	5     0       1         1     0  0.000150
	6     0       0         1     1  0.102000
	7     0       1         1     1  0.748000
	8     1       0         0     0  0.009990
	9     1       1         0     0  0.000010
	10    1       0         0     1  0.118800
	11    1       1         0     1  0.871200
	12    1       0         1     0  0.499500
	13    1       1         1     0  0.000500
	14    1       0         1     1  0.060000
	15    1       1         1     1  0.440000

Sum out Alarm

	  Fire Leaving Tampering      prob
	0    0       0         0  0.998912
	1    0       0         1  0.251850
	2    0       1         0  0.001088
	3    0       1         1  0.748150
	4    1       0         0  0.128790
	5    1       0         1  0.559500
	6    1       1         0  0.871210
	7    1       1         1  0.440500

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire  prob
	0    0   1.0
	1    1   1.0

	  Fire Leaving Tampering      prob
	0    0       0         0  0.998912
	1    0       0         1  0.251850
	2    0       1         0  0.001088
	3    0       1         1  0.748150
	4    1       0         0  0.128790
	5    1       0         1  0.559500
	6    1       1         0  0.871210
	7    1       1         1  0.440500

Eliminate variable: Leaving

Factors to multiply containing variable: Leaving

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Fire Leaving Tampering      prob
	0    0       0         0  0.998912
	1    0       0         1  0.251850
	2    0       1         0  0.001088
	3    0       1         1  0.748150
	4    1       0         0  0.128790
	5    1       0         1  0.559500
	6    1       1         0  0.871210
	7    1       1         1  0.440500

Result of multiplication: 

	   Fire Leaving Tampering Report      prob
	0     0       0         0      0  0.988923
	1     0       0         1      0  0.249331
	2     1       0         0      0  0.127502
	3     1       0         1      0  0.553905
	4     0       0         0      1  0.009989
	5     0       0         1      1  0.002518
	6     1       0         0      1  0.001288
	7     1       0         1      1  0.005595
	8     0       1         0      0  0.000272
	9     0       1         1      0  0.187037
	10    1       1         0      0  0.217802
	11    1       1         1      0  0.110125
	12    0       1         0      1  0.000816
	13    0       1         1      1  0.561113
	14    1       1         0      1  0.653407
	15    1       1         1      1  0.330375

Sum out Leaving

	  Fire Tampering Report      prob
	0    0         0      0  0.989195
	1    0         0      1  0.010805
	2    0         1      0  0.436369
	3    0         1      1  0.563631
	4    1         0      0  0.345305
	5    1         0      1  0.654695
	6    1         1      0  0.664030
	7    1         1      1  0.335970

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire  prob
	0    0   1.0
	1    1   1.0

	  Fire Tampering Report      prob
	0    0         0      0  0.989195
	1    0         0      1  0.010805
	2    0         1      0  0.436369
	3    0         1      1  0.563631
	4    1         0      0  0.345305
	5    1         0      1  0.654695
	6    1         1      0  0.664030
	7    1         1      1  0.335970

Eliminate variable: Fire

Factors to multiply containing variable: Fire

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	0    0   1.0
	1    1   1.0

	  Fire Tampering Report      prob
	0    0         0      0  0.989195
	1    0         0      1  0.010805
	2    0         1      0  0.436369
	3    0         1      1  0.563631
	4    1         0      0  0.345305
	5    1         0      1  0.654695
	6    1         1      0  0.664030
	7    1         1      1  0.335970

Result of multiplication: 

	  Fire Tampering Report      prob
	0    0         0      0  0.979303
	1    0         0      1  0.010697
	2    0         1      0  0.432005
	3    0         1      1  0.557995
	4    1         0      0  0.003453
	5    1         0      1  0.006547
	6    1         1      0  0.006640
	7    1         1      1  0.003360

Sum out Fire

	  Tampering Report      prob
	0         0      0  0.982756
	1         0      1  0.017244
	2         1      0  0.438646
	3         1      1  0.561354

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering Report      prob
	0         0      0  0.982756
	1         0      1  0.017244
	2         1      0  0.438646
	3         1      1  0.561354

Eliminate variable: Report

Factors to multiply containing variable: Report

	  Tampering Report      prob
	0         0      0  0.982756
	1         0      1  0.017244
	2         1      0  0.438646
	3         1      1  0.561354

Result of multiplication: 

	  Tampering Report      prob
	0         0      0  0.982756
	1         0      1  0.017244
	2         1      0  0.438646
	3         1      1  0.561354

Storing factor for backtracking to find value of Report

	  Tampering Report      prob
	0         0      0  0.982756
	1         0      1  0.017244
	2         1      0  0.438646
	3         1      1  0.561354

Maximise out Report

	  Tampering      prob
	0         0  0.982756
	1         1  0.561354

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.982756
	1         1  0.561354

Eliminate variable: Tampering

Factors to multiply containing variable: Tampering

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.982756
	1         1  0.561354

Result of multiplication: 

	  Tampering      prob
	0         0  0.963101
	1         1  0.011227

Storing factor for backtracking to find value of Tampering

	  Tampering      prob
	0         0  0.963101
	1         1  0.011227

New List of Factors: 

	  Tampering      prob
	0         0  0.963101
	1         1  0.011227

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	  Tampering      prob
	0         0  0.963101
	1         1  0.011227

Finding MAP instantiation for Tampering

MAP assignment for variable Tampering is 0

Popped this factor from the backtracking stack:

	  Tampering Report      prob
	0         0      0  0.982756
	1         0      1  0.017244
	2         1      0  0.438646
	3         1      1  0.561354

Finding MAP instantiation for Report

MAP assignment for variable Report is 0

Final Map Instantiation:

Tampering->0

Report->0

Elimination Order: ['Alarm', 'Leaving', 'Fire', 'Report', 'Tampering']

MAP Variables: ['Tampering', 'Report']

Observed Variables: {'Smoke': '1'}

Original Factors: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Factors with evidence applied: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

Result of multiplication: 

	   Fire Leaving Tampering Alarm      prob
	0     0       0         0     0  0.998900
	1     0       1         0     0  0.001000
	2     0       0         0     1  0.000012
	3     0       1         0     1  0.000088
	4     0       0         1     0  0.149850
	5     0       1         1     0  0.000150
	6     0       0         1     1  0.102000
	7     0       1         1     1  0.748000
	8     1       0         0     0  0.009990
	9     1       1         0     0  0.000010
	10    1       0         0     1  0.118800
	11    1       1         0     1  0.871200
	12    1       0         1     0  0.499500
	13    1       1         1     0  0.000500
	14    1       0         1     1  0.060000
	15    1       1         1     1  0.440000

Sum out Alarm

	  Fire Leaving Tampering      prob
	0    0       0         0  0.998912
	1    0       0         1  0.251850
	2    0       1         0  0.001088
	3    0       1         1  0.748150
	4    1       0         0  0.128790
	5    1       0         1  0.559500
	6    1       1         0  0.871210
	7    1       1         1  0.440500

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire Leaving Tampering      prob
	0    0       0         0  0.998912
	1    0       0         1  0.251850
	2    0       1         0  0.001088
	3    0       1         1  0.748150
	4    1       0         0  0.128790
	5    1       0         1  0.559500
	6    1       1         0  0.871210
	7    1       1         1  0.440500

Eliminate variable: Leaving

Factors to multiply containing variable: Leaving

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Fire Leaving Tampering      prob
	0    0       0         0  0.998912
	1    0       0         1  0.251850
	2    0       1         0  0.001088
	3    0       1         1  0.748150
	4    1       0         0  0.128790
	5    1       0         1  0.559500
	6    1       1         0  0.871210
	7    1       1         1  0.440500

Result of multiplication: 

	   Fire Leaving Tampering Report      prob
	0     0       0         0      0  0.988923
	1     0       0         1      0  0.249331
	2     1       0         0      0  0.127502
	3     1       0         1      0  0.553905
	4     0       0         0      1  0.009989
	5     0       0         1      1  0.002518
	6     1       0         0      1  0.001288
	7     1       0         1      1  0.005595
	8     0       1         0      0  0.000272
	9     0       1         1      0  0.187037
	10    1       1         0      0  0.217802
	11    1       1         1      0  0.110125
	12    0       1         0      1  0.000816
	13    0       1         1      1  0.561113
	14    1       1         0      1  0.653407
	15    1       1         1      1  0.330375

Sum out Leaving

	  Fire Tampering Report      prob
	0    0         0      0  0.989195
	1    0         0      1  0.010805
	2    0         1      0  0.436369
	3    0         1      1  0.563631
	4    1         0      0  0.345305
	5    1         0      1  0.654695
	6    1         1      0  0.664030
	7    1         1      1  0.335970

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire Tampering Report      prob
	0    0         0      0  0.989195
	1    0         0      1  0.010805
	2    0         1      0  0.436369
	3    0         1      1  0.563631
	4    1         0      0  0.345305
	5    1         0      1  0.654695
	6    1         1      0  0.664030
	7    1         1      1  0.335970

Eliminate variable: Fire

Factors to multiply containing variable: Fire

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Fire Tampering Report      prob
	0    0         0      0  0.989195
	1    0         0      1  0.010805
	2    0         1      0  0.436369
	3    0         1      1  0.563631
	4    1         0      0  0.345305
	5    1         0      1  0.654695
	6    1         1      0  0.664030
	7    1         1      1  0.335970

Result of multiplication: 

	  Fire Tampering Report      prob
	0    0         0      0  0.009793
	1    0         0      1  0.000107
	2    0         1      0  0.004320
	3    0         1      1  0.005580
	4    1         0      0  0.003108
	5    1         0      1  0.005892
	6    1         1      0  0.005976
	7    1         1      1  0.003024

Sum out Fire

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Eliminate variable: Report

Factors to multiply containing variable: Report

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Result of multiplication: 

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Storing factor for backtracking to find value of Report

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Maximise out Report

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

Eliminate variable: Tampering

Factors to multiply containing variable: Tampering

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

Result of multiplication: 

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Storing factor for backtracking to find value of Tampering

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

New List of Factors: 

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Finding MAP instantiation for Tampering

MAP assignment for variable Tampering is 0

Popped this factor from the backtracking stack:

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Finding MAP instantiation for Report

MAP assignment for variable Report is 0

Final Map Instantiation:

Tampering->0

Report->0

Elimination Order: ['JohnCalls', 'MaryCalls', 'Earthquake', 'Alarm']

MAP Variables: ['Alarm']

Observed Variables: {'Burglary': 'True'}

Original Factors: 

	  Burglary  prob
	0     True  0.01
	1    False  0.99

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Burglary Earthquake   prob
	0   True     True       True  0.950
	1  False     True       True  0.050
	2   True    False       True  0.290
	3  False    False       True  0.710
	4   True     True      False  0.940
	5  False     True      False  0.060
	6   True    False      False  0.001
	7  False    False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Factors with evidence applied: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Eliminate variable: JohnCalls

Factors to multiply containing variable: JohnCalls

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Result of multiplication: 

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Sum out JohnCalls

	   Alarm  prob
	0  False   1.0
	1   True   1.0

New List of Factors: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

	   Alarm  prob
	0  False   1.0
	1   True   1.0

Eliminate variable: MaryCalls

Factors to multiply containing variable: MaryCalls

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Result of multiplication: 

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Sum out MaryCalls

	   Alarm  prob
	0  False   1.0
	1   True   1.0

New List of Factors: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

Eliminate variable: Earthquake

Factors to multiply containing variable: Earthquake

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

Result of multiplication: 

	  Earthquake  Alarm    prob
	0       True   True  0.0190
	1       True  False  0.0010
	2      False   True  0.9212
	3      False  False  0.0588

Sum out Earthquake

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

New List of Factors: 

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Result of multiplication: 

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Storing factor for backtracking to find value of Alarm

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

New List of Factors: 

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Finding MAP instantiation for Alarm

MAP assignment for variable Alarm is True

Final Map Instantiation:

Alarm->True

Elimination Order: ['MaryCalls', 'Earthquake', 'JohnCalls', 'Alarm']

MAP Variables: ['Alarm', 'JohnCalls']

Observed Variables: {'Burglary': 'False'}

Original Factors: 

	  Burglary  prob
	0     True  0.01
	1    False  0.99

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Burglary Earthquake   prob
	0   True     True       True  0.950
	1  False     True       True  0.050
	2   True    False       True  0.290
	3  False    False       True  0.710
	4   True     True      False  0.940
	5  False     True      False  0.060
	6   True    False      False  0.001
	7  False    False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Factors with evidence applied: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Eliminate variable: MaryCalls

Factors to multiply containing variable: MaryCalls

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Result of multiplication: 

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Sum out MaryCalls

	   Alarm  prob
	0  False   1.0
	1   True   1.0

New List of Factors: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	   Alarm  prob
	0  False   1.0
	1   True   1.0

Eliminate variable: Earthquake

Factors to multiply containing variable: Earthquake

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

Result of multiplication: 

	  Earthquake  Alarm     prob
	0       True   True  0.00580
	1       True  False  0.01420
	2      False   True  0.00098
	3      False  False  0.97902

Sum out Earthquake

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

New List of Factors: 

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

Eliminate variable: JohnCalls

Factors to multiply containing variable: JohnCalls

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Result of multiplication: 

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Storing factor for backtracking to find value of JohnCalls

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Maximise out JohnCalls

	   Alarm  prob
	0  False  0.95
	1   True  0.90

New List of Factors: 

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

	   Alarm  prob
	0  False  0.95
	1   True  0.90

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

	   Alarm  prob
	0  False  0.95
	1   True  0.90

Result of multiplication: 

	   Alarm      prob
	0  False  0.943559
	1   True  0.006102

Storing factor for backtracking to find value of Alarm

	   Alarm      prob
	0  False  0.943559
	1   True  0.006102

New List of Factors: 

	   Alarm      prob
	0  False  0.943559
	1   True  0.006102

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	   Alarm      prob
	0  False  0.943559
	1   True  0.006102

Finding MAP instantiation for Alarm

MAP assignment for variable Alarm is False

Popped this factor from the backtracking stack:

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Finding MAP instantiation for JohnCalls

Elimination Order: ['Alarm', 'Leaving', 'Fire', 'Report', 'Tampering']

MAP Variables: ['Tampering', 'Report']

Observed Variables: {'Smoke': '1'}

Original Factors: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Factors with evidence applied: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

Result of multiplication: 

	   Tampering Alarm Leaving Fire      prob
	0          0     0       0    0  0.998900
	1          0     0       1    0  0.001000
	2          0     1       0    0  0.000012
	3          0     1       1    0  0.000088
	4          1     0       0    0  0.149850
	5          1     0       1    0  0.000150
	6          1     1       0    0  0.102000
	7          1     1       1    0  0.748000
	8          0     0       0    1  0.009990
	9          0     0       1    1  0.000010
	10         0     1       0    1  0.118800
	11         0     1       1    1  0.871200
	12         1     0       0    1  0.499500
	13         1     0       1    1  0.000500
	14         1     1       0    1  0.060000
	15         1     1       1    1  0.440000

Sum out Alarm

	  Tampering Leaving Fire      prob
	0         0       0    0  0.998912
	1         0       0    1  0.128790
	2         0       1    0  0.001088
	3         0       1    1  0.871210
	4         1       0    0  0.251850
	5         1       0    1  0.559500
	6         1       1    0  0.748150
	7         1       1    1  0.440500

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering Leaving Fire      prob
	0         0       0    0  0.998912
	1         0       0    1  0.128790
	2         0       1    0  0.001088
	3         0       1    1  0.871210
	4         1       0    0  0.251850
	5         1       0    1  0.559500
	6         1       1    0  0.748150
	7         1       1    1  0.440500

Eliminate variable: Leaving

Factors to multiply containing variable: Leaving

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Tampering Leaving Fire      prob
	0         0       0    0  0.998912
	1         0       0    1  0.128790
	2         0       1    0  0.001088
	3         0       1    1  0.871210
	4         1       0    0  0.251850
	5         1       0    1  0.559500
	6         1       1    0  0.748150
	7         1       1    1  0.440500

Result of multiplication: 

	   Tampering Report Leaving Fire      prob
	0          0      0       0    0  0.988923
	1          0      0       0    1  0.127502
	2          1      0       0    0  0.249331
	3          1      0       0    1  0.553905
	4          0      1       0    0  0.009989
	5          0      1       0    1  0.001288
	6          1      1       0    0  0.002518
	7          1      1       0    1  0.005595
	8          0      0       1    0  0.000272
	9          0      0       1    1  0.217802
	10         1      0       1    0  0.187037
	11         1      0       1    1  0.110125
	12         0      1       1    0  0.000816
	13         0      1       1    1  0.653407
	14         1      1       1    0  0.561113
	15         1      1       1    1  0.330375

Sum out Leaving

	  Tampering Report Fire      prob
	0         0      0    0  0.989195
	1         0      0    1  0.345305
	2         0      1    0  0.010805
	3         0      1    1  0.654695
	4         1      0    0  0.436369
	5         1      0    1  0.664030
	6         1      1    0  0.563631
	7         1      1    1  0.335970

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering Report Fire      prob
	0         0      0    0  0.989195
	1         0      0    1  0.345305
	2         0      1    0  0.010805
	3         0      1    1  0.654695
	4         1      0    0  0.436369
	5         1      0    1  0.664030
	6         1      1    0  0.563631
	7         1      1    1  0.335970

Eliminate variable: Fire

Factors to multiply containing variable: Fire

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering Report Fire      prob
	0         0      0    0  0.989195
	1         0      0    1  0.345305
	2         0      1    0  0.010805
	3         0      1    1  0.654695
	4         1      0    0  0.436369
	5         1      0    1  0.664030
	6         1      1    0  0.563631
	7         1      1    1  0.335970

Result of multiplication: 

	  Tampering Report Fire      prob
	0         0      0    0  0.009793
	1         0      1    0  0.000107
	2         1      0    0  0.004320
	3         1      1    0  0.005580
	4         0      0    1  0.003108
	5         0      1    1  0.005892
	6         1      0    1  0.005976
	7         1      1    1  0.003024

Sum out Fire

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Eliminate variable: Report

Factors to multiply containing variable: Report

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Result of multiplication: 

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Storing factor for backtracking to find value of Report

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Maximise out Report

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

Eliminate variable: Tampering

Factors to multiply containing variable: Tampering

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

Result of multiplication: 

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Storing factor for backtracking to find value of Tampering

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

New List of Factors: 

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Finding MAP instantiation for Tampering

MAP assignment for variable Tampering is 0

Popped this factor from the backtracking stack:

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Finding MAP instantiation for Report

MAP assignment for variable Report is 0

Final Map Instantiation:

Tampering->0

Report->0

Elimination Order: ['Smoke', 'Alarm', 'Leaving', 'Fire', 'Report', 'Tampering']

MAP Variables: ['Tampering', 'Report']

Observed Variables: {}

Original Factors: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Factors with evidence applied: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Eliminate variable: Smoke

Factors to multiply containing variable: Smoke

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

Result of multiplication: 

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

Sum out Smoke

	  Fire  prob
	0    0   1.0
	1    1   1.0

New List of Factors: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire  prob
	0    0   1.0
	1    1   1.0

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

Result of multiplication: 

	   Tampering Alarm Leaving Fire      prob
	0          0     0       0    0  0.998900
	1          0     0       1    0  0.001000
	2          0     1       0    0  0.000012
	3          0     1       1    0  0.000088
	4          1     0       0    0  0.149850
	5          1     0       1    0  0.000150
	6          1     1       0    0  0.102000
	7          1     1       1    0  0.748000
	8          0     0       0    1  0.009990
	9          0     0       1    1  0.000010
	10         0     1       0    1  0.118800
	11         0     1       1    1  0.871200
	12         1     0       0    1  0.499500
	13         1     0       1    1  0.000500
	14         1     1       0    1  0.060000
	15         1     1       1    1  0.440000

Sum out Alarm

	  Tampering Leaving Fire      prob
	0         0       0    0  0.998912
	1         0       0    1  0.128790
	2         0       1    0  0.001088
	3         0       1    1  0.871210
	4         1       0    0  0.251850
	5         1       0    1  0.559500
	6         1       1    0  0.748150
	7         1       1    1  0.440500

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire  prob
	0    0   1.0
	1    1   1.0

	  Tampering Leaving Fire      prob
	0         0       0    0  0.998912
	1         0       0    1  0.128790
	2         0       1    0  0.001088
	3         0       1    1  0.871210
	4         1       0    0  0.251850
	5         1       0    1  0.559500
	6         1       1    0  0.748150
	7         1       1    1  0.440500

Eliminate variable: Leaving

Factors to multiply containing variable: Leaving

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Tampering Leaving Fire      prob
	0         0       0    0  0.998912
	1         0       0    1  0.128790
	2         0       1    0  0.001088
	3         0       1    1  0.871210
	4         1       0    0  0.251850
	5         1       0    1  0.559500
	6         1       1    0  0.748150
	7         1       1    1  0.440500

Result of multiplication: 

	   Tampering Report Leaving Fire      prob
	0          0      0       0    0  0.988923
	1          0      0       0    1  0.127502
	2          1      0       0    0  0.249331
	3          1      0       0    1  0.553905
	4          0      1       0    0  0.009989
	5          0      1       0    1  0.001288
	6          1      1       0    0  0.002518
	7          1      1       0    1  0.005595
	8          0      0       1    0  0.000272
	9          0      0       1    1  0.217802
	10         1      0       1    0  0.187037
	11         1      0       1    1  0.110125
	12         0      1       1    0  0.000816
	13         0      1       1    1  0.653407
	14         1      1       1    0  0.561113
	15         1      1       1    1  0.330375

Sum out Leaving

	  Tampering Report Fire      prob
	0         0      0    0  0.989195
	1         0      0    1  0.345305
	2         0      1    0  0.010805
	3         0      1    1  0.654695
	4         1      0    0  0.436369
	5         1      0    1  0.664030
	6         1      1    0  0.563631
	7         1      1    1  0.335970

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire  prob
	0    0   1.0
	1    1   1.0

	  Tampering Report Fire      prob
	0         0      0    0  0.989195
	1         0      0    1  0.345305
	2         0      1    0  0.010805
	3         0      1    1  0.654695
	4         1      0    0  0.436369
	5         1      0    1  0.664030
	6         1      1    0  0.563631
	7         1      1    1  0.335970

Eliminate variable: Fire

Factors to multiply containing variable: Fire

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	0    0   1.0
	1    1   1.0

	  Tampering Report Fire      prob
	0         0      0    0  0.989195
	1         0      0    1  0.345305
	2         0      1    0  0.010805
	3         0      1    1  0.654695
	4         1      0    0  0.436369
	5         1      0    1  0.664030
	6         1      1    0  0.563631
	7         1      1    1  0.335970

Result of multiplication: 

	  Tampering Report Fire      prob
	0         0      0    0  0.979303
	1         0      1    0  0.010697
	2         1      0    0  0.432005
	3         1      1    0  0.557995
	4         0      0    1  0.003453
	5         0      1    1  0.006547
	6         1      0    1  0.006640
	7         1      1    1  0.003360

Sum out Fire

	  Tampering Report      prob
	0         0      0  0.982756
	1         0      1  0.017244
	2         1      0  0.438646
	3         1      1  0.561354

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering Report      prob
	0         0      0  0.982756
	1         0      1  0.017244
	2         1      0  0.438646
	3         1      1  0.561354

Eliminate variable: Report

Factors to multiply containing variable: Report

	  Tampering Report      prob
	0         0      0  0.982756
	1         0      1  0.017244
	2         1      0  0.438646
	3         1      1  0.561354

Result of multiplication: 

	  Tampering Report      prob
	0         0      0  0.982756
	1         0      1  0.017244
	2         1      0  0.438646
	3         1      1  0.561354

Storing factor for backtracking to find value of Report

	  Tampering Report      prob
	0         0      0  0.982756
	1         0      1  0.017244
	2         1      0  0.438646
	3         1      1  0.561354

Maximise out Report

	  Tampering      prob
	0         0  0.982756
	1         1  0.561354

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.982756
	1         1  0.561354

Eliminate variable: Tampering

Factors to multiply containing variable: Tampering

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.982756
	1         1  0.561354

Result of multiplication: 

	  Tampering      prob
	0         0  0.963101
	1         1  0.011227

Storing factor for backtracking to find value of Tampering

	  Tampering      prob
	0         0  0.963101
	1         1  0.011227

New List of Factors: 

	  Tampering      prob
	0         0  0.963101
	1         1  0.011227

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	  Tampering      prob
	0         0  0.963101
	1         1  0.011227

Finding MAP instantiation for Tampering

MAP assignment for variable Tampering is 0

Popped this factor from the backtracking stack:

	  Tampering Report      prob
	0         0      0  0.982756
	1         0      1  0.017244
	2         1      0  0.438646
	3         1      1  0.561354

Finding MAP instantiation for Report

MAP assignment for variable Report is 0

Final Map Instantiation:

Tampering->0

Report->0

Elimination Order: ['Alarm', 'Leaving', 'Fire', 'Report', 'Tampering']

MAP Variables: ['Tampering', 'Report']

Observed Variables: {'Smoke': '1'}

Original Factors: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Factors with evidence applied: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

Result of multiplication: 

	   Tampering Alarm Leaving Fire      prob
	0          0     0       0    0  0.998900
	1          0     0       1    0  0.001000
	2          0     1       0    0  0.000012
	3          0     1       1    0  0.000088
	4          1     0       0    0  0.149850
	5          1     0       1    0  0.000150
	6          1     1       0    0  0.102000
	7          1     1       1    0  0.748000
	8          0     0       0    1  0.009990
	9          0     0       1    1  0.000010
	10         0     1       0    1  0.118800
	11         0     1       1    1  0.871200
	12         1     0       0    1  0.499500
	13         1     0       1    1  0.000500
	14         1     1       0    1  0.060000
	15         1     1       1    1  0.440000

Sum out Alarm

	  Tampering Leaving Fire      prob
	0         0       0    0  0.998912
	1         0       0    1  0.128790
	2         0       1    0  0.001088
	3         0       1    1  0.871210
	4         1       0    0  0.251850
	5         1       0    1  0.559500
	6         1       1    0  0.748150
	7         1       1    1  0.440500

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering Leaving Fire      prob
	0         0       0    0  0.998912
	1         0       0    1  0.128790
	2         0       1    0  0.001088
	3         0       1    1  0.871210
	4         1       0    0  0.251850
	5         1       0    1  0.559500
	6         1       1    0  0.748150
	7         1       1    1  0.440500

Eliminate variable: Leaving

Factors to multiply containing variable: Leaving

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Tampering Leaving Fire      prob
	0         0       0    0  0.998912
	1         0       0    1  0.128790
	2         0       1    0  0.001088
	3         0       1    1  0.871210
	4         1       0    0  0.251850
	5         1       0    1  0.559500
	6         1       1    0  0.748150
	7         1       1    1  0.440500

Result of multiplication: 

	   Tampering Report Leaving Fire      prob
	0          0      0       0    0  0.988923
	1          0      0       0    1  0.127502
	2          1      0       0    0  0.249331
	3          1      0       0    1  0.553905
	4          0      1       0    0  0.009989
	5          0      1       0    1  0.001288
	6          1      1       0    0  0.002518
	7          1      1       0    1  0.005595
	8          0      0       1    0  0.000272
	9          0      0       1    1  0.217802
	10         1      0       1    0  0.187037
	11         1      0       1    1  0.110125
	12         0      1       1    0  0.000816
	13         0      1       1    1  0.653407
	14         1      1       1    0  0.561113
	15         1      1       1    1  0.330375

Sum out Leaving

	  Tampering Report Fire      prob
	0         0      0    0  0.989195
	1         0      0    1  0.345305
	2         0      1    0  0.010805
	3         0      1    1  0.654695
	4         1      0    0  0.436369
	5         1      0    1  0.664030
	6         1      1    0  0.563631
	7         1      1    1  0.335970

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering Report Fire      prob
	0         0      0    0  0.989195
	1         0      0    1  0.345305
	2         0      1    0  0.010805
	3         0      1    1  0.654695
	4         1      0    0  0.436369
	5         1      0    1  0.664030
	6         1      1    0  0.563631
	7         1      1    1  0.335970

Eliminate variable: Fire

Factors to multiply containing variable: Fire

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering Report Fire      prob
	0         0      0    0  0.989195
	1         0      0    1  0.345305
	2         0      1    0  0.010805
	3         0      1    1  0.654695
	4         1      0    0  0.436369
	5         1      0    1  0.664030
	6         1      1    0  0.563631
	7         1      1    1  0.335970

Result of multiplication: 

	  Tampering Report Fire      prob
	0         0      0    0  0.009793
	1         0      1    0  0.000107
	2         1      0    0  0.004320
	3         1      1    0  0.005580
	4         0      0    1  0.003108
	5         0      1    1  0.005892
	6         1      0    1  0.005976
	7         1      1    1  0.003024

Sum out Fire

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Eliminate variable: Report

Factors to multiply containing variable: Report

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Result of multiplication: 

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Storing factor for backtracking to find value of Report

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Maximise out Report

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

Eliminate variable: Tampering

Factors to multiply containing variable: Tampering

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

Result of multiplication: 

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Storing factor for backtracking to find value of Tampering

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

New List of Factors: 

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Finding MAP instantiation for Tampering

MAP assignment for variable Tampering is 0

Popped this factor from the backtracking stack:

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Finding MAP instantiation for Report

MAP assignment for variable Report is 0

Final Map Instantiation:

Tampering->0

Report->0

Elimination Order: ['JohnCalls', 'MaryCalls', 'Earthquake', 'Alarm']

MAP Variables: ['Alarm']

Observed Variables: {'Burglary': 'True'}

Original Factors: 

	  Burglary  prob
	0     True  0.01
	1    False  0.99

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Burglary Earthquake   prob
	0   True     True       True  0.950
	1  False     True       True  0.050
	2   True    False       True  0.290
	3  False    False       True  0.710
	4   True     True      False  0.940
	5  False     True      False  0.060
	6   True    False      False  0.001
	7  False    False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Factors with evidence applied: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Eliminate variable: JohnCalls

Factors to multiply containing variable: JohnCalls

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Result of multiplication: 

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Sum out JohnCalls

	   Alarm  prob
	0  False   1.0
	1   True   1.0

New List of Factors: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

	   Alarm  prob
	0  False   1.0
	1   True   1.0

Eliminate variable: MaryCalls

Factors to multiply containing variable: MaryCalls

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Result of multiplication: 

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Sum out MaryCalls

	   Alarm  prob
	0  False   1.0
	1   True   1.0

New List of Factors: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

Eliminate variable: Earthquake

Factors to multiply containing variable: Earthquake

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

Result of multiplication: 

	  Earthquake  Alarm    prob
	0       True   True  0.0190
	1       True  False  0.0010
	2      False   True  0.9212
	3      False  False  0.0588

Sum out Earthquake

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

New List of Factors: 

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Result of multiplication: 

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Storing factor for backtracking to find value of Alarm

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

New List of Factors: 

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Finding MAP instantiation for Alarm

MAP assignment for variable Alarm is True

Final Map Instantiation:

Alarm->True

Elimination Order: ['MaryCalls', 'Earthquake', 'JohnCalls', 'Alarm']

MAP Variables: ['Alarm', 'JohnCalls']

Observed Variables: {'Burglary': 'False'}

Original Factors: 

	  Burglary  prob
	0     True  0.01
	1    False  0.99

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Burglary Earthquake   prob
	0   True     True       True  0.950
	1  False     True       True  0.050
	2   True    False       True  0.290
	3  False    False       True  0.710
	4   True     True      False  0.940
	5  False     True      False  0.060
	6   True    False      False  0.001
	7  False    False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Factors with evidence applied: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Eliminate variable: MaryCalls

Factors to multiply containing variable: MaryCalls

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Result of multiplication: 

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Sum out MaryCalls

	   Alarm  prob
	0  False   1.0
	1   True   1.0

New List of Factors: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	   Alarm  prob
	0  False   1.0
	1   True   1.0

Eliminate variable: Earthquake

Factors to multiply containing variable: Earthquake

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

Result of multiplication: 

	  Earthquake  Alarm     prob
	0       True   True  0.00580
	1       True  False  0.01420
	2      False   True  0.00098
	3      False  False  0.97902

Sum out Earthquake

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

New List of Factors: 

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

Eliminate variable: JohnCalls

Factors to multiply containing variable: JohnCalls

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Result of multiplication: 

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Storing factor for backtracking to find value of JohnCalls

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Maximise out JohnCalls

	   Alarm  prob
	0  False  0.95
	1   True  0.90

New List of Factors: 

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

	   Alarm  prob
	0  False  0.95
	1   True  0.90

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

	   Alarm  prob
	0  False  0.95
	1   True  0.90

Result of multiplication: 

	   Alarm      prob
	0  False  0.943559
	1   True  0.006102

Storing factor for backtracking to find value of Alarm

	   Alarm      prob
	0  False  0.943559
	1   True  0.006102

New List of Factors: 

	   Alarm      prob
	0  False  0.943559
	1   True  0.006102

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	   Alarm      prob
	0  False  0.943559
	1   True  0.006102

Finding MAP instantiation for Alarm

MAP assignment for variable Alarm is False

Popped this factor from the backtracking stack:

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Finding MAP instantiation for JohnCalls

Elimination Order: ['MaryCalls', 'Earthquake', 'JohnCalls', 'Alarm']

MAP Variables: ['Alarm', 'JohnCalls']

Observed Variables: {'Burglary': 'False'}

Original Factors: 

	  Burglary  prob
	0     True  0.01
	1    False  0.99

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Burglary Earthquake   prob
	0   True     True       True  0.950
	1  False     True       True  0.050
	2   True    False       True  0.290
	3  False    False       True  0.710
	4   True     True      False  0.940
	5  False     True      False  0.060
	6   True    False      False  0.001
	7  False    False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Factors with evidence applied: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Eliminate variable: MaryCalls

Factors to multiply containing variable: MaryCalls

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Result of multiplication: 

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Sum out MaryCalls

	   Alarm  prob
	0  False   1.0
	1   True   1.0

New List of Factors: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	   Alarm  prob
	0  False   1.0
	1   True   1.0

Eliminate variable: Earthquake

Factors to multiply containing variable: Earthquake

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

Result of multiplication: 

	  Earthquake  Alarm     prob
	0       True   True  0.00580
	1       True  False  0.01420
	2      False   True  0.00098
	3      False  False  0.97902

Sum out Earthquake

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

New List of Factors: 

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

Eliminate variable: JohnCalls

Factors to multiply containing variable: JohnCalls

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Result of multiplication: 

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Storing factor for backtracking to find value of JohnCalls

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Maximise out JohnCalls

	   Alarm  prob
	0  False  0.95
	1   True  0.90

New List of Factors: 

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

	   Alarm  prob
	0  False  0.95
	1   True  0.90

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

	   Alarm  prob
	0  False  0.95
	1   True  0.90

Result of multiplication: 

	   Alarm      prob
	0  False  0.943559
	1   True  0.006102

Storing factor for backtracking to find value of Alarm

	   Alarm      prob
	0  False  0.943559
	1   True  0.006102

New List of Factors: 

	   Alarm      prob
	0  False  0.943559
	1   True  0.006102

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	   Alarm      prob
	0  False  0.943559
	1   True  0.006102

Finding MAP instantiation for Alarm

MAP assignment for variable Alarm is False

Popped this factor from the backtracking stack:

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Finding MAP instantiation for JohnCalls

Elimination Order: ['MaryCalls', 'Earthquake', 'JohnCalls', 'Alarm']

MAP Variables: ['Alarm', 'JohnCalls']

Observed Variables: {'Burglary': 'False'}

Original Factors: 

	  Burglary  prob
	0     True  0.01
	1    False  0.99

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Burglary Earthquake   prob
	0   True     True       True  0.950
	1  False     True       True  0.050
	2   True    False       True  0.290
	3  False    False       True  0.710
	4   True     True      False  0.940
	5  False     True      False  0.060
	6   True    False      False  0.001
	7  False    False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Factors with evidence applied: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Eliminate variable: MaryCalls

Factors to multiply containing variable: MaryCalls

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Result of multiplication: 

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Sum out MaryCalls

	   Alarm  prob
	0  False   1.0
	1   True   1.0

New List of Factors: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	   Alarm  prob
	0  False   1.0
	1   True   1.0

Eliminate variable: Earthquake

Factors to multiply containing variable: Earthquake

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

Result of multiplication: 

	  Earthquake  Alarm     prob
	0       True   True  0.00580
	1       True  False  0.01420
	2      False   True  0.00098
	3      False  False  0.97902

Sum out Earthquake

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

New List of Factors: 

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

Eliminate variable: JohnCalls

Factors to multiply containing variable: JohnCalls

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Result of multiplication: 

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Storing factor for backtracking to find value of JohnCalls

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Maximise out JohnCalls

	   Alarm  prob
	0  False  0.95
	1   True  0.90

New List of Factors: 

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

	   Alarm  prob
	0  False  0.95
	1   True  0.90

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

	   Alarm  prob
	0  False  0.95
	1   True  0.90

Result of multiplication: 

	   Alarm      prob
	0  False  0.943559
	1   True  0.006102

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Elimination Order: ['MaryCalls', 'Earthquake', 'JohnCalls', 'Alarm']

MAP Variables: ['Alarm', 'JohnCalls']

Observed Variables: {'Burglary': 'False'}

Original Factors: 

	  Burglary  prob
	0     True  0.01
	1    False  0.99

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Burglary Earthquake   prob
	0   True     True       True  0.950
	1  False     True       True  0.050
	2   True    False       True  0.290
	3  False    False       True  0.710
	4   True     True      False  0.940
	5  False     True      False  0.060
	6   True    False      False  0.001
	7  False    False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Factors with evidence applied: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Eliminate variable: MaryCalls

Factors to multiply containing variable: MaryCalls

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Result of multiplication: 

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Sum out MaryCalls

	   Alarm  prob
	0  False   1.0
	1   True   1.0

New List of Factors: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	   Alarm  prob
	0  False   1.0
	1   True   1.0

Eliminate variable: Earthquake

Factors to multiply containing variable: Earthquake

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

Result of multiplication: 

	   Alarm Earthquake     prob
	0   True       True  0.00580
	1  False       True  0.01420
	2   True      False  0.00098
	3  False      False  0.97902

Sum out Earthquake

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

New List of Factors: 

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

Eliminate variable: JohnCalls

Factors to multiply containing variable: JohnCalls

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Result of multiplication: 

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Storing factor for backtracking to find value of JohnCalls

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Maximise out JohnCalls

	   Alarm  prob
	0  False  0.95
	1   True  0.90

New List of Factors: 

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

	   Alarm  prob
	0  False  0.95
	1   True  0.90

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

	   Alarm  prob
	0  False  0.95
	1   True  0.90

Result of multiplication: 

	   Alarm      prob
	0  False  0.943559
	1   True  0.006102

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Finding MAP instantiation for JohnCalls

MAP assignment for variable JohnCalls is False

Final Map Instantiation:

JohnCalls->False

Elimination Order: ['JohnCalls', 'MaryCalls', 'Earthquake', 'Alarm']

MAP Variables: ['Alarm']

Observed Variables: {'Burglary': 'True'}

Original Factors: 

	  Burglary  prob
	0     True  0.01
	1    False  0.99

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Burglary Earthquake   prob
	0   True     True       True  0.950
	1  False     True       True  0.050
	2   True    False       True  0.290
	3  False    False       True  0.710
	4   True     True      False  0.940
	5  False     True      False  0.060
	6   True    False      False  0.001
	7  False    False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Factors with evidence applied: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Eliminate variable: JohnCalls

Factors to multiply containing variable: JohnCalls

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Result of multiplication: 

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Sum out JohnCalls

	   Alarm  prob
	0  False   1.0
	1   True   1.0

New List of Factors: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

	   Alarm  prob
	0  False   1.0
	1   True   1.0

Eliminate variable: MaryCalls

Factors to multiply containing variable: MaryCalls

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Result of multiplication: 

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Sum out MaryCalls

	   Alarm  prob
	0  False   1.0
	1   True   1.0

New List of Factors: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

Eliminate variable: Earthquake

Factors to multiply containing variable: Earthquake

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

Result of multiplication: 

	  Earthquake  Alarm    prob
	0       True   True  0.0190
	1       True  False  0.0010
	2      False   True  0.9212
	3      False  False  0.0588

Sum out Earthquake

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

New List of Factors: 

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Result of multiplication: 

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Final Map Instantiation:

Elimination Order: ['MaryCalls', 'Earthquake', 'JohnCalls', 'Alarm']

MAP Variables: ['Alarm', 'JohnCalls']

Observed Variables: {'Burglary': 'False'}

Original Factors: 

	  Burglary  prob
	0     True  0.01
	1    False  0.99

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Burglary Earthquake   prob
	0   True     True       True  0.950
	1  False     True       True  0.050
	2   True    False       True  0.290
	3  False    False       True  0.710
	4   True     True      False  0.940
	5  False     True      False  0.060
	6   True    False      False  0.001
	7  False    False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Factors with evidence applied: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Eliminate variable: MaryCalls

Factors to multiply containing variable: MaryCalls

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Result of multiplication: 

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Sum out MaryCalls

	   Alarm  prob
	0  False   1.0
	1   True   1.0

New List of Factors: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	   Alarm  prob
	0  False   1.0
	1   True   1.0

Eliminate variable: Earthquake

Factors to multiply containing variable: Earthquake

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

Result of multiplication: 

	  Earthquake  Alarm     prob
	0       True   True  0.00580
	1       True  False  0.01420
	2      False   True  0.00098
	3      False  False  0.97902

Sum out Earthquake

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

New List of Factors: 

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

Eliminate variable: JohnCalls

Factors to multiply containing variable: JohnCalls

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Result of multiplication: 

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Storing factor for backtracking to find value of JohnCalls

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Maximise out JohnCalls

	   Alarm  prob
	0  False  0.95
	1   True  0.90

New List of Factors: 

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

	   Alarm  prob
	0  False  0.95
	1   True  0.90

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

	   Alarm  prob
	0  False  0.95
	1   True  0.90

Result of multiplication: 

	   Alarm      prob
	0  False  0.943559
	1   True  0.006102

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Finding MAP instantiation for JohnCalls

MAP assignment for variable JohnCalls is False

Final Map Instantiation:

JohnCalls->False

Elimination Order: ['JohnCalls', 'MaryCalls', 'Earthquake', 'Alarm']

MAP Variables: ['Alarm']

Observed Variables: {'Burglary': 'True'}

Original Factors: 

	  Burglary  prob
	0     True  0.01
	1    False  0.99

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Burglary Earthquake   prob
	0   True     True       True  0.950
	1  False     True       True  0.050
	2   True    False       True  0.290
	3  False    False       True  0.710
	4   True     True      False  0.940
	5  False     True      False  0.060
	6   True    False      False  0.001
	7  False    False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Factors with evidence applied: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Eliminate variable: JohnCalls

Factors to multiply containing variable: JohnCalls

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Result of multiplication: 

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Sum out JohnCalls

	   Alarm  prob
	0  False   1.0
	1   True   1.0

New List of Factors: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

	   Alarm  prob
	0  False   1.0
	1   True   1.0

Eliminate variable: MaryCalls

Factors to multiply containing variable: MaryCalls

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Result of multiplication: 

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Sum out MaryCalls

	   Alarm  prob
	0  False   1.0
	1   True   1.0

New List of Factors: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

Eliminate variable: Earthquake

Factors to multiply containing variable: Earthquake

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

Result of multiplication: 

	   Alarm Earthquake    prob
	0   True       True  0.0190
	1  False       True  0.0010
	2   True      False  0.9212
	3  False      False  0.0588

Sum out Earthquake

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

New List of Factors: 

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Result of multiplication: 

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Storing factor for backtracking to find value of Alarm

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

New List of Factors: 

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Finding MAP instantiation for Alarm

MAP assignment for variable Alarm is True

Final Map Instantiation:

Alarm->True

Elimination Order: ['MaryCalls', 'Earthquake', 'JohnCalls', 'Alarm']

MAP Variables: ['Alarm', 'JohnCalls']

Observed Variables: {'Burglary': 'False'}

Original Factors: 

	  Burglary  prob
	0     True  0.01
	1    False  0.99

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Burglary Earthquake   prob
	0   True     True       True  0.950
	1  False     True       True  0.050
	2   True    False       True  0.290
	3  False    False       True  0.710
	4   True     True      False  0.940
	5  False     True      False  0.060
	6   True    False      False  0.001
	7  False    False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Factors with evidence applied: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Eliminate variable: MaryCalls

Factors to multiply containing variable: MaryCalls

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Result of multiplication: 

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Sum out MaryCalls

	   Alarm  prob
	0  False   1.0
	1   True   1.0

New List of Factors: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	   Alarm  prob
	0  False   1.0
	1   True   1.0

Eliminate variable: Earthquake

Factors to multiply containing variable: Earthquake

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

Result of multiplication: 

	   Alarm Earthquake     prob
	0   True       True  0.00580
	1  False       True  0.01420
	2   True      False  0.00098
	3  False      False  0.97902

Sum out Earthquake

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

New List of Factors: 

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

Eliminate variable: JohnCalls

Factors to multiply containing variable: JohnCalls

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Result of multiplication: 

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Storing factor for backtracking to find value of JohnCalls

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Maximise out JohnCalls

	   Alarm  prob
	0  False  0.95
	1   True  0.90

New List of Factors: 

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

	   Alarm  prob
	0  False  0.95
	1   True  0.90

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

	   Alarm  prob
	0  False  0.95
	1   True  0.90

Result of multiplication: 

	   Alarm      prob
	0  False  0.943559
	1   True  0.006102

Storing factor for backtracking to find value of Alarm

	   Alarm      prob
	0  False  0.943559
	1   True  0.006102

New List of Factors: 

	   Alarm      prob
	0  False  0.943559
	1   True  0.006102

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	   Alarm      prob
	0  False  0.943559
	1   True  0.006102

Finding MAP instantiation for Alarm

MAP assignment for variable Alarm is False

Popped this factor from the backtracking stack:

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Finding MAP instantiation for JohnCalls

Elimination Order: ['JohnCalls', 'MaryCalls', 'Earthquake', 'Alarm']

MAP Variables: ['Alarm']

Observed Variables: {'Burglary': 'True'}

Original Factors: 

	  Burglary  prob
	0     True  0.01
	1    False  0.99

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Burglary Earthquake   prob
	0   True     True       True  0.950
	1  False     True       True  0.050
	2   True    False       True  0.290
	3  False    False       True  0.710
	4   True     True      False  0.940
	5  False     True      False  0.060
	6   True    False      False  0.001
	7  False    False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Factors with evidence applied: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Eliminate variable: JohnCalls

Factors to multiply containing variable: JohnCalls

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Result of multiplication: 

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Sum out JohnCalls

	   Alarm  prob
	0  False   1.0
	1   True   1.0

New List of Factors: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

	   Alarm  prob
	0  False   1.0
	1   True   1.0

Eliminate variable: MaryCalls

Factors to multiply containing variable: MaryCalls

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Result of multiplication: 

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Sum out MaryCalls

	   Alarm  prob
	0  False   1.0
	1   True   1.0

New List of Factors: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

Eliminate variable: Earthquake

Factors to multiply containing variable: Earthquake

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

Result of multiplication: 

	   Alarm Earthquake    prob
	0   True       True  0.0190
	1  False       True  0.0010
	2   True      False  0.9212
	3  False      False  0.0588

Sum out Earthquake

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

New List of Factors: 

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Result of multiplication: 

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Storing factor for backtracking to find value of Alarm

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

New List of Factors: 

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Finding MAP instantiation for Alarm

MAP assignment for variable Alarm is True

Final Map Instantiation:

Alarm->True

Elimination Order: ['MaryCalls', 'Earthquake', 'JohnCalls', 'Alarm']

MAP Variables: ['Alarm', 'JohnCalls']

Observed Variables: {'Burglary': 'False'}

Original Factors: 

	  Burglary  prob
	0     True  0.01
	1    False  0.99

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Burglary Earthquake   prob
	0   True     True       True  0.950
	1  False     True       True  0.050
	2   True    False       True  0.290
	3  False    False       True  0.710
	4   True     True      False  0.940
	5  False     True      False  0.060
	6   True    False      False  0.001
	7  False    False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Factors with evidence applied: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Eliminate variable: MaryCalls

Factors to multiply containing variable: MaryCalls

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Result of multiplication: 

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Sum out MaryCalls

	   Alarm  prob
	0  False   1.0
	1   True   1.0

New List of Factors: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	   Alarm  prob
	0  False   1.0
	1   True   1.0

Eliminate variable: Earthquake

Factors to multiply containing variable: Earthquake

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

Result of multiplication: 

	   Alarm Earthquake     prob
	0   True       True  0.00580
	1  False       True  0.01420
	2   True      False  0.00098
	3  False      False  0.97902

Sum out Earthquake

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

New List of Factors: 

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

Eliminate variable: JohnCalls

Factors to multiply containing variable: JohnCalls

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Result of multiplication: 

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Storing factor for backtracking to find value of JohnCalls

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Maximise out JohnCalls

	   Alarm  prob
	0  False  0.95
	1   True  0.90

New List of Factors: 

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

	   Alarm  prob
	0  False  0.95
	1   True  0.90

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

	   Alarm  prob
	0  False  0.95
	1   True  0.90

Result of multiplication: 

	   Alarm      prob
	0  False  0.943559
	1   True  0.006102

Storing factor for backtracking to find value of Alarm

	   Alarm      prob
	0  False  0.943559
	1   True  0.006102

New List of Factors: 

	   Alarm      prob
	0  False  0.943559
	1   True  0.006102

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	   Alarm      prob
	0  False  0.943559
	1   True  0.006102

Finding MAP instantiation for Alarm

MAP assignment for variable Alarm is False

Popped this factor from the backtracking stack:

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Finding MAP instantiation for JohnCalls

Elimination Order: ['JohnCalls', 'MaryCalls', 'Earthquake', 'Alarm']

MAP Variables: ['Alarm']

Observed Variables: {'Burglary': 'True'}

Original Factors: 

	  Burglary  prob
	0     True  0.01
	1    False  0.99

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Burglary Earthquake   prob
	0   True     True       True  0.950
	1  False     True       True  0.050
	2   True    False       True  0.290
	3  False    False       True  0.710
	4   True     True      False  0.940
	5  False     True      False  0.060
	6   True    False      False  0.001
	7  False    False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Factors with evidence applied: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Eliminate variable: JohnCalls

Factors to multiply containing variable: JohnCalls

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Result of multiplication: 

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Sum out JohnCalls

	   Alarm  prob
	0  False   1.0
	1   True   1.0

New List of Factors: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

	   Alarm  prob
	0  False   1.0
	1   True   1.0

Eliminate variable: MaryCalls

Factors to multiply containing variable: MaryCalls

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Result of multiplication: 

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Sum out MaryCalls

	   Alarm  prob
	0  False   1.0
	1   True   1.0

New List of Factors: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

Eliminate variable: Earthquake

Factors to multiply containing variable: Earthquake

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

Result of multiplication: 

	   Alarm Earthquake    prob
	0   True       True  0.0190
	1  False       True  0.0010
	2   True      False  0.9212
	3  False      False  0.0588

Sum out Earthquake

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

New List of Factors: 

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Result of multiplication: 

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Storing factor for backtracking to find value of Alarm

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

New List of Factors: 

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Finding MAP instantiation for Alarm

MAP assignment for variable Alarm is True

Final Map Instantiation:

Alarm->True

Elimination Order: ['MaryCalls', 'Earthquake', 'JohnCalls', 'Alarm']

MAP Variables: ['Alarm', 'JohnCalls']

Observed Variables: {'Burglary': 'False'}

Original Factors: 

	  Burglary  prob
	0     True  0.01
	1    False  0.99

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Burglary Earthquake   prob
	0   True     True       True  0.950
	1  False     True       True  0.050
	2   True    False       True  0.290
	3  False    False       True  0.710
	4   True     True      False  0.940
	5  False     True      False  0.060
	6   True    False      False  0.001
	7  False    False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Factors with evidence applied: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Eliminate variable: MaryCalls

Factors to multiply containing variable: MaryCalls

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Result of multiplication: 

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Sum out MaryCalls

	   Alarm  prob
	0  False   1.0
	1   True   1.0

New List of Factors: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	   Alarm  prob
	0  False   1.0
	1   True   1.0

Eliminate variable: Earthquake

Factors to multiply containing variable: Earthquake

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

Result of multiplication: 

	   Alarm Earthquake     prob
	0   True       True  0.00580
	1  False       True  0.01420
	2   True      False  0.00098
	3  False      False  0.97902

Sum out Earthquake

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

New List of Factors: 

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

Eliminate variable: JohnCalls

Factors to multiply containing variable: JohnCalls

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Result of multiplication: 

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Storing factor for backtracking to find value of JohnCalls

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Maximise out JohnCalls

	   Alarm  prob
	0  False  0.95
	1   True  0.90

New List of Factors: 

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

	   Alarm  prob
	0  False  0.95
	1   True  0.90

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

	   Alarm  prob
	0  False  0.95
	1   True  0.90

Result of multiplication: 

	   Alarm      prob
	0  False  0.943559
	1   True  0.006102

Storing factor for backtracking to find value of Alarm

	   Alarm      prob
	0  False  0.943559
	1   True  0.006102

New List of Factors: 

	   Alarm      prob
	0  False  0.943559
	1   True  0.006102

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	   Alarm      prob
	0  False  0.943559
	1   True  0.006102

Finding MAP instantiation for Alarm

MAP assignment for variable Alarm is False

Popped this factor from the backtracking stack:

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Finding MAP instantiation for JohnCalls

Elimination Order: ['JohnCalls', 'MaryCalls', 'Earthquake', 'Alarm']

MAP Variables: ['Alarm']

Observed Variables: {'Burglary': 'True'}

Original Factors: 

	  Burglary  prob
	0     True  0.01
	1    False  0.99

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Burglary Earthquake   prob
	0   True     True       True  0.950
	1  False     True       True  0.050
	2   True    False       True  0.290
	3  False    False       True  0.710
	4   True     True      False  0.940
	5  False     True      False  0.060
	6   True    False      False  0.001
	7  False    False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Factors with evidence applied: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Eliminate variable: JohnCalls

Factors to multiply containing variable: JohnCalls

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Result of multiplication: 

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Sum out JohnCalls

	   Alarm  prob
	0  False   1.0
	1   True   1.0

New List of Factors: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

	   Alarm  prob
	0  False   1.0
	1   True   1.0

Eliminate variable: MaryCalls

Factors to multiply containing variable: MaryCalls

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Result of multiplication: 

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Sum out MaryCalls

	   Alarm  prob
	0  False   1.0
	1   True   1.0

New List of Factors: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

Eliminate variable: Earthquake

Factors to multiply containing variable: Earthquake

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

Result of multiplication: 

	   Alarm Earthquake    prob
	0   True       True  0.0190
	1  False       True  0.0010
	2   True      False  0.9212
	3  False      False  0.0588

Sum out Earthquake

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

New List of Factors: 

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Result of multiplication: 

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Storing factor for backtracking to find value of Alarm

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

New List of Factors: 

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Finding MAP instantiation for Alarm

MAP assignment for variable Alarm is True

Final Map Instantiation:

Alarm->True

Elimination Order: ['MaryCalls', 'Earthquake', 'JohnCalls', 'Alarm']

MAP Variables: ['Alarm', 'JohnCalls']

Observed Variables: {'Burglary': 'False'}

Original Factors: 

	  Burglary  prob
	0     True  0.01
	1    False  0.99

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Burglary Earthquake   prob
	0   True     True       True  0.950
	1  False     True       True  0.050
	2   True    False       True  0.290
	3  False    False       True  0.710
	4   True     True      False  0.940
	5  False     True      False  0.060
	6   True    False      False  0.001
	7  False    False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Factors with evidence applied: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Eliminate variable: MaryCalls

Factors to multiply containing variable: MaryCalls

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Result of multiplication: 

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Sum out MaryCalls

	   Alarm  prob
	0  False   1.0
	1   True   1.0

New List of Factors: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	   Alarm  prob
	0  False   1.0
	1   True   1.0

Eliminate variable: Earthquake

Factors to multiply containing variable: Earthquake

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

Result of multiplication: 

	   Alarm Earthquake     prob
	0   True       True  0.00580
	1  False       True  0.01420
	2   True      False  0.00098
	3  False      False  0.97902

Sum out Earthquake

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

New List of Factors: 

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

Eliminate variable: JohnCalls

Factors to multiply containing variable: JohnCalls

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Result of multiplication: 

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Storing factor for backtracking to find value of JohnCalls

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Maximise out JohnCalls

	   Alarm  prob
	0  False  0.95
	1   True  0.90

New List of Factors: 

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

	   Alarm  prob
	0  False  0.95
	1   True  0.90

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

	   Alarm  prob
	0  False  0.95
	1   True  0.90

Result of multiplication: 

	   Alarm      prob
	0  False  0.943559
	1   True  0.006102

Storing factor for backtracking to find value of Alarm

	   Alarm      prob
	0  False  0.943559
	1   True  0.006102

New List of Factors: 

	   Alarm      prob
	0  False  0.943559
	1   True  0.006102

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	   Alarm      prob
	0  False  0.943559
	1   True  0.006102

Finding MAP instantiation for Alarm

MAP assignment for variable Alarm is False

Popped this factor from the backtracking stack:

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Finding MAP instantiation for JohnCalls

Elimination Order: ['JohnCalls', 'MaryCalls', 'Earthquake', 'Alarm']

MAP Variables: ['Alarm']

Observed Variables: {'Burglary': 'True'}

Original Factors: 

	  Burglary  prob
	0     True  0.01
	1    False  0.99

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Burglary Earthquake   prob
	0   True     True       True  0.950
	1  False     True       True  0.050
	2   True    False       True  0.290
	3  False    False       True  0.710
	4   True     True      False  0.940
	5  False     True      False  0.060
	6   True    False      False  0.001
	7  False    False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Factors with evidence applied: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Eliminate variable: JohnCalls

Factors to multiply containing variable: JohnCalls

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Result of multiplication: 

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Sum out JohnCalls

	   Alarm  prob
	0  False   1.0
	1   True   1.0

New List of Factors: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

	   Alarm  prob
	0  False   1.0
	1   True   1.0

Eliminate variable: MaryCalls

Factors to multiply containing variable: MaryCalls

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Result of multiplication: 

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Sum out MaryCalls

	   Alarm  prob
	0  False   1.0
	1   True   1.0

New List of Factors: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

Eliminate variable: Earthquake

Factors to multiply containing variable: Earthquake

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

Result of multiplication: 

	   Alarm Earthquake    prob
	0   True       True  0.0190
	1  False       True  0.0010
	2   True      False  0.9212
	3  False      False  0.0588

Sum out Earthquake

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

New List of Factors: 

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Result of multiplication: 

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Storing factor for backtracking to find value of Alarm

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

New List of Factors: 

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Finding MAP instantiation for Alarm

MAP assignment for variable Alarm is True

Final Map Instantiation:

Alarm->True

Elimination Order: ['MaryCalls', 'Earthquake', 'JohnCalls', 'Alarm']

MAP Variables: ['Alarm', 'JohnCalls']

Observed Variables: {'Burglary': 'False'}

Original Factors: 

	  Burglary  prob
	0     True  0.01
	1    False  0.99

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Burglary Earthquake   prob
	0   True     True       True  0.950
	1  False     True       True  0.050
	2   True    False       True  0.290
	3  False    False       True  0.710
	4   True     True      False  0.940
	5  False     True      False  0.060
	6   True    False      False  0.001
	7  False    False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Factors with evidence applied: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Eliminate variable: MaryCalls

Factors to multiply containing variable: MaryCalls

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Result of multiplication: 

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Sum out MaryCalls

	   Alarm  prob
	0  False   1.0
	1   True   1.0

New List of Factors: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	   Alarm  prob
	0  False   1.0
	1   True   1.0

Eliminate variable: Earthquake

Factors to multiply containing variable: Earthquake

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

Result of multiplication: 

	   Alarm Earthquake     prob
	0   True       True  0.00580
	1  False       True  0.01420
	2   True      False  0.00098
	3  False      False  0.97902

Sum out Earthquake

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

New List of Factors: 

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

Eliminate variable: JohnCalls

Factors to multiply containing variable: JohnCalls

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Result of multiplication: 

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Storing factor for backtracking to find value of JohnCalls

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Maximise out JohnCalls

	   Alarm  prob
	0  False  0.95
	1   True  0.90

New List of Factors: 

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

	   Alarm  prob
	0  False  0.95
	1   True  0.90

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

	   Alarm  prob
	0  False  0.95
	1   True  0.90

Result of multiplication: 

	   Alarm      prob
	0  False  0.943559
	1   True  0.006102

Storing factor for backtracking to find value of Alarm

	   Alarm      prob
	0  False  0.943559
	1   True  0.006102

New List of Factors: 

	   Alarm      prob
	0  False  0.943559
	1   True  0.006102

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	   Alarm      prob
	0  False  0.943559
	1   True  0.006102

Finding MAP instantiation for Alarm

MAP assignment for variable Alarm is False

Popped this factor from the backtracking stack:

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Finding MAP instantiation for JohnCalls

Elimination Order: ['JohnCalls', 'MaryCalls', 'Earthquake', 'Alarm']

MAP Variables: ['Alarm']

Observed Variables: {'Burglary': 'True'}

Original Factors: 

	  Burglary  prob
	0     True  0.01
	1    False  0.99

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Burglary Earthquake   prob
	0   True     True       True  0.950
	1  False     True       True  0.050
	2   True    False       True  0.290
	3  False    False       True  0.710
	4   True     True      False  0.940
	5  False     True      False  0.060
	6   True    False      False  0.001
	7  False    False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Factors with evidence applied: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Eliminate variable: JohnCalls

Factors to multiply containing variable: JohnCalls

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Result of multiplication: 

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Sum out JohnCalls

	   Alarm  prob
	0  False   1.0
	1   True   1.0

New List of Factors: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

	   Alarm  prob
	0  False   1.0
	1   True   1.0

Eliminate variable: MaryCalls

Factors to multiply containing variable: MaryCalls

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Result of multiplication: 

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Sum out MaryCalls

	   Alarm  prob
	0  False   1.0
	1   True   1.0

New List of Factors: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

Eliminate variable: Earthquake

Factors to multiply containing variable: Earthquake

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

Result of multiplication: 

	   Alarm Earthquake    prob
	0   True       True  0.0190
	1  False       True  0.0010
	2   True      False  0.9212
	3  False      False  0.0588

Sum out Earthquake

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

New List of Factors: 

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Result of multiplication: 

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Storing factor for backtracking to find value of Alarm

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

New List of Factors: 

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Finding MAP instantiation for Alarm

MAP assignment for variable Alarm is True

Final Map Instantiation:

Alarm->True

Elimination Order: ['MaryCalls', 'Earthquake', 'JohnCalls', 'Alarm']

MAP Variables: ['Alarm', 'JohnCalls']

Observed Variables: {'Burglary': 'False'}

Original Factors: 

	  Burglary  prob
	0     True  0.01
	1    False  0.99

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Burglary Earthquake   prob
	0   True     True       True  0.950
	1  False     True       True  0.050
	2   True    False       True  0.290
	3  False    False       True  0.710
	4   True     True      False  0.940
	5  False     True      False  0.060
	6   True    False      False  0.001
	7  False    False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Factors with evidence applied: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Eliminate variable: MaryCalls

Factors to multiply containing variable: MaryCalls

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Result of multiplication: 

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Sum out MaryCalls

	   Alarm  prob
	0  False   1.0
	1   True   1.0

New List of Factors: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	   Alarm  prob
	0  False   1.0
	1   True   1.0

Eliminate variable: Earthquake

Factors to multiply containing variable: Earthquake

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

Result of multiplication: 

	   Alarm Earthquake     prob
	0   True       True  0.00580
	1  False       True  0.01420
	2   True      False  0.00098
	3  False      False  0.97902

Sum out Earthquake

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

New List of Factors: 

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

Eliminate variable: JohnCalls

Factors to multiply containing variable: JohnCalls

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Result of multiplication: 

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Storing factor for backtracking to find value of JohnCalls

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Maximise out JohnCalls

	   Alarm  prob
	0  False  0.95
	1   True  0.90

New List of Factors: 

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

	   Alarm  prob
	0  False  0.95
	1   True  0.90

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

	   Alarm  prob
	0  False  0.95
	1   True  0.90

Result of multiplication: 

	   Alarm      prob
	0  False  0.943559
	1   True  0.006102

Storing factor for backtracking to find value of Alarm

	   Alarm      prob
	0  False  0.943559
	1   True  0.006102

New List of Factors: 

	   Alarm      prob
	0  False  0.943559
	1   True  0.006102

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	   Alarm      prob
	0  False  0.943559
	1   True  0.006102

Finding MAP instantiation for Alarm

MAP assignment for variable Alarm is False

Popped this factor from the backtracking stack:

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Finding MAP instantiation for JohnCalls

Elimination Order: ['Alarm', 'Leaving', 'Fire', 'Report', 'Tampering']

MAP Variables: ['Tampering', 'Report']

Observed Variables: {'Smoke': '1'}

Original Factors: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Factors with evidence applied: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

Result of multiplication: 

	   Fire Leaving Alarm Tampering      prob
	0     0       0     0         0  0.998900
	1     0       1     0         0  0.001000
	2     0       0     1         0  0.000012
	3     0       1     1         0  0.000088
	4     0       0     0         1  0.149850
	5     0       1     0         1  0.000150
	6     0       0     1         1  0.102000
	7     0       1     1         1  0.748000
	8     1       0     0         0  0.009990
	9     1       1     0         0  0.000010
	10    1       0     1         0  0.118800
	11    1       1     1         0  0.871200
	12    1       0     0         1  0.499500
	13    1       1     0         1  0.000500
	14    1       0     1         1  0.060000
	15    1       1     1         1  0.440000

Sum out Alarm

	  Fire Leaving Tampering      prob
	0    0       0         0  0.998912
	1    0       0         1  0.251850
	2    0       1         0  0.001088
	3    0       1         1  0.748150
	4    1       0         0  0.128790
	5    1       0         1  0.559500
	6    1       1         0  0.871210
	7    1       1         1  0.440500

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire Leaving Tampering      prob
	0    0       0         0  0.998912
	1    0       0         1  0.251850
	2    0       1         0  0.001088
	3    0       1         1  0.748150
	4    1       0         0  0.128790
	5    1       0         1  0.559500
	6    1       1         0  0.871210
	7    1       1         1  0.440500

Eliminate variable: Leaving

Factors to multiply containing variable: Leaving

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Fire Leaving Tampering      prob
	0    0       0         0  0.998912
	1    0       0         1  0.251850
	2    0       1         0  0.001088
	3    0       1         1  0.748150
	4    1       0         0  0.128790
	5    1       0         1  0.559500
	6    1       1         0  0.871210
	7    1       1         1  0.440500

Result of multiplication: 

	   Fire Tampering Report Leaving      prob
	0     0         0      0       0  0.988923
	1     0         1      0       0  0.249331
	2     1         0      0       0  0.127502
	3     1         1      0       0  0.553905
	4     0         0      1       0  0.009989
	5     0         1      1       0  0.002518
	6     1         0      1       0  0.001288
	7     1         1      1       0  0.005595
	8     0         0      0       1  0.000272
	9     0         1      0       1  0.187037
	10    1         0      0       1  0.217802
	11    1         1      0       1  0.110125
	12    0         0      1       1  0.000816
	13    0         1      1       1  0.561113
	14    1         0      1       1  0.653407
	15    1         1      1       1  0.330375

Sum out Leaving

	  Fire Tampering Report      prob
	0    0         0      0  0.989195
	1    0         0      1  0.010805
	2    0         1      0  0.436369
	3    0         1      1  0.563631
	4    1         0      0  0.345305
	5    1         0      1  0.654695
	6    1         1      0  0.664030
	7    1         1      1  0.335970

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire Tampering Report      prob
	0    0         0      0  0.989195
	1    0         0      1  0.010805
	2    0         1      0  0.436369
	3    0         1      1  0.563631
	4    1         0      0  0.345305
	5    1         0      1  0.654695
	6    1         1      0  0.664030
	7    1         1      1  0.335970

Eliminate variable: Fire

Factors to multiply containing variable: Fire

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Fire Tampering Report      prob
	0    0         0      0  0.989195
	1    0         0      1  0.010805
	2    0         1      0  0.436369
	3    0         1      1  0.563631
	4    1         0      0  0.345305
	5    1         0      1  0.654695
	6    1         1      0  0.664030
	7    1         1      1  0.335970

Result of multiplication: 

	  Fire Report Tampering      prob
	0    0      0         0  0.009793
	1    0      1         0  0.000107
	2    0      0         1  0.004320
	3    0      1         1  0.005580
	4    1      0         0  0.003108
	5    1      1         0  0.005892
	6    1      0         1  0.005976
	7    1      1         1  0.003024

Sum out Fire

	  Report Tampering      prob
	0      0         0  0.012901
	1      0         1  0.010296
	2      1         0  0.005999
	3      1         1  0.008604

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Report Tampering      prob
	0      0         0  0.012901
	1      0         1  0.010296
	2      1         0  0.005999
	3      1         1  0.008604

Eliminate variable: Report

Factors to multiply containing variable: Report

	  Report Tampering      prob
	0      0         0  0.012901
	1      0         1  0.010296
	2      1         0  0.005999
	3      1         1  0.008604

Result of multiplication: 

	  Report Tampering      prob
	0      0         0  0.012901
	1      0         1  0.010296
	2      1         0  0.005999
	3      1         1  0.008604

Storing factor for backtracking to find value of Report

	  Report Tampering      prob
	0      0         0  0.012901
	1      0         1  0.010296
	2      1         0  0.005999
	3      1         1  0.008604

Maximise out Report

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

Eliminate variable: Tampering

Factors to multiply containing variable: Tampering

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

Result of multiplication: 

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Storing factor for backtracking to find value of Tampering

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

New List of Factors: 

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Finding MAP instantiation for Tampering

MAP assignment for variable Tampering is 0

Popped this factor from the backtracking stack:

	  Report Tampering      prob
	0      0         0  0.012901
	1      0         1  0.010296
	2      1         0  0.005999
	3      1         1  0.008604

Finding MAP instantiation for Report

MAP assignment for variable Report is 0

Final Map Instantiation:

Tampering->0

Report->0

Elimination Order: ['Smoke', 'Alarm', 'Leaving', 'Fire', 'Report', 'Tampering']

MAP Variables: ['Tampering', 'Report']

Observed Variables: {}

Original Factors: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Factors with evidence applied: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Eliminate variable: Smoke

Factors to multiply containing variable: Smoke

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

Result of multiplication: 

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

Sum out Smoke

	  Fire  prob
	0    0   1.0
	1    1   1.0

New List of Factors: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire  prob
	0    0   1.0
	1    1   1.0

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

Result of multiplication: 

	   Fire Leaving Alarm Tampering      prob
	0     0       0     0         0  0.998900
	1     0       1     0         0  0.001000
	2     0       0     1         0  0.000012
	3     0       1     1         0  0.000088
	4     0       0     0         1  0.149850
	5     0       1     0         1  0.000150
	6     0       0     1         1  0.102000
	7     0       1     1         1  0.748000
	8     1       0     0         0  0.009990
	9     1       1     0         0  0.000010
	10    1       0     1         0  0.118800
	11    1       1     1         0  0.871200
	12    1       0     0         1  0.499500
	13    1       1     0         1  0.000500
	14    1       0     1         1  0.060000
	15    1       1     1         1  0.440000

Sum out Alarm

	  Fire Leaving Tampering      prob
	0    0       0         0  0.998912
	1    0       0         1  0.251850
	2    0       1         0  0.001088
	3    0       1         1  0.748150
	4    1       0         0  0.128790
	5    1       0         1  0.559500
	6    1       1         0  0.871210
	7    1       1         1  0.440500

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire  prob
	0    0   1.0
	1    1   1.0

	  Fire Leaving Tampering      prob
	0    0       0         0  0.998912
	1    0       0         1  0.251850
	2    0       1         0  0.001088
	3    0       1         1  0.748150
	4    1       0         0  0.128790
	5    1       0         1  0.559500
	6    1       1         0  0.871210
	7    1       1         1  0.440500

Eliminate variable: Leaving

Factors to multiply containing variable: Leaving

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Fire Leaving Tampering      prob
	0    0       0         0  0.998912
	1    0       0         1  0.251850
	2    0       1         0  0.001088
	3    0       1         1  0.748150
	4    1       0         0  0.128790
	5    1       0         1  0.559500
	6    1       1         0  0.871210
	7    1       1         1  0.440500

Result of multiplication: 

	   Fire Tampering Report Leaving      prob
	0     0         0      0       0  0.988923
	1     0         1      0       0  0.249331
	2     1         0      0       0  0.127502
	3     1         1      0       0  0.553905
	4     0         0      1       0  0.009989
	5     0         1      1       0  0.002518
	6     1         0      1       0  0.001288
	7     1         1      1       0  0.005595
	8     0         0      0       1  0.000272
	9     0         1      0       1  0.187037
	10    1         0      0       1  0.217802
	11    1         1      0       1  0.110125
	12    0         0      1       1  0.000816
	13    0         1      1       1  0.561113
	14    1         0      1       1  0.653407
	15    1         1      1       1  0.330375

Sum out Leaving

	  Fire Tampering Report      prob
	0    0         0      0  0.989195
	1    0         0      1  0.010805
	2    0         1      0  0.436369
	3    0         1      1  0.563631
	4    1         0      0  0.345305
	5    1         0      1  0.654695
	6    1         1      0  0.664030
	7    1         1      1  0.335970

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire  prob
	0    0   1.0
	1    1   1.0

	  Fire Tampering Report      prob
	0    0         0      0  0.989195
	1    0         0      1  0.010805
	2    0         1      0  0.436369
	3    0         1      1  0.563631
	4    1         0      0  0.345305
	5    1         0      1  0.654695
	6    1         1      0  0.664030
	7    1         1      1  0.335970

Eliminate variable: Fire

Factors to multiply containing variable: Fire

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	0    0   1.0
	1    1   1.0

	  Fire Tampering Report      prob
	0    0         0      0  0.989195
	1    0         0      1  0.010805
	2    0         1      0  0.436369
	3    0         1      1  0.563631
	4    1         0      0  0.345305
	5    1         0      1  0.654695
	6    1         1      0  0.664030
	7    1         1      1  0.335970

Result of multiplication: 

	  Fire Report Tampering      prob
	0    0      0         0  0.979303
	1    0      1         0  0.010697
	2    0      0         1  0.432005
	3    0      1         1  0.557995
	4    1      0         0  0.003453
	5    1      1         0  0.006547
	6    1      0         1  0.006640
	7    1      1         1  0.003360

Sum out Fire

	  Report Tampering      prob
	0      0         0  0.982756
	1      0         1  0.438646
	2      1         0  0.017244
	3      1         1  0.561354

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Report Tampering      prob
	0      0         0  0.982756
	1      0         1  0.438646
	2      1         0  0.017244
	3      1         1  0.561354

Eliminate variable: Report

Factors to multiply containing variable: Report

	  Report Tampering      prob
	0      0         0  0.982756
	1      0         1  0.438646
	2      1         0  0.017244
	3      1         1  0.561354

Result of multiplication: 

	  Report Tampering      prob
	0      0         0  0.982756
	1      0         1  0.438646
	2      1         0  0.017244
	3      1         1  0.561354

Storing factor for backtracking to find value of Report

	  Report Tampering      prob
	0      0         0  0.982756
	1      0         1  0.438646
	2      1         0  0.017244
	3      1         1  0.561354

Maximise out Report

	  Tampering      prob
	0         0  0.982756
	1         1  0.561354

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.982756
	1         1  0.561354

Eliminate variable: Tampering

Factors to multiply containing variable: Tampering

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.982756
	1         1  0.561354

Result of multiplication: 

	  Tampering      prob
	0         0  0.963101
	1         1  0.011227

Storing factor for backtracking to find value of Tampering

	  Tampering      prob
	0         0  0.963101
	1         1  0.011227

New List of Factors: 

	  Tampering      prob
	0         0  0.963101
	1         1  0.011227

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	  Tampering      prob
	0         0  0.963101
	1         1  0.011227

Finding MAP instantiation for Tampering

MAP assignment for variable Tampering is 0

Popped this factor from the backtracking stack:

	  Report Tampering      prob
	0      0         0  0.982756
	1      0         1  0.438646
	2      1         0  0.017244
	3      1         1  0.561354

Finding MAP instantiation for Report

MAP assignment for variable Report is 0

Final Map Instantiation:

Tampering->0

Report->0

Elimination Order: ['Alarm', 'Leaving', 'Fire', 'Report', 'Tampering']

MAP Variables: ['Tampering', 'Report']

Observed Variables: {'Smoke': '1'}

Original Factors: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Factors with evidence applied: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

Result of multiplication: 

	   Fire Leaving Alarm Tampering      prob
	0     0       0     0         0  0.998900
	1     0       1     0         0  0.001000
	2     0       0     1         0  0.000012
	3     0       1     1         0  0.000088
	4     0       0     0         1  0.149850
	5     0       1     0         1  0.000150
	6     0       0     1         1  0.102000
	7     0       1     1         1  0.748000
	8     1       0     0         0  0.009990
	9     1       1     0         0  0.000010
	10    1       0     1         0  0.118800
	11    1       1     1         0  0.871200
	12    1       0     0         1  0.499500
	13    1       1     0         1  0.000500
	14    1       0     1         1  0.060000
	15    1       1     1         1  0.440000

Sum out Alarm

	  Fire Leaving Tampering      prob
	0    0       0         0  0.998912
	1    0       0         1  0.251850
	2    0       1         0  0.001088
	3    0       1         1  0.748150
	4    1       0         0  0.128790
	5    1       0         1  0.559500
	6    1       1         0  0.871210
	7    1       1         1  0.440500

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire Leaving Tampering      prob
	0    0       0         0  0.998912
	1    0       0         1  0.251850
	2    0       1         0  0.001088
	3    0       1         1  0.748150
	4    1       0         0  0.128790
	5    1       0         1  0.559500
	6    1       1         0  0.871210
	7    1       1         1  0.440500

Eliminate variable: Leaving

Factors to multiply containing variable: Leaving

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Fire Leaving Tampering      prob
	0    0       0         0  0.998912
	1    0       0         1  0.251850
	2    0       1         0  0.001088
	3    0       1         1  0.748150
	4    1       0         0  0.128790
	5    1       0         1  0.559500
	6    1       1         0  0.871210
	7    1       1         1  0.440500

Result of multiplication: 

	   Fire Tampering Report Leaving      prob
	0     0         0      0       0  0.988923
	1     0         1      0       0  0.249331
	2     1         0      0       0  0.127502
	3     1         1      0       0  0.553905
	4     0         0      1       0  0.009989
	5     0         1      1       0  0.002518
	6     1         0      1       0  0.001288
	7     1         1      1       0  0.005595
	8     0         0      0       1  0.000272
	9     0         1      0       1  0.187037
	10    1         0      0       1  0.217802
	11    1         1      0       1  0.110125
	12    0         0      1       1  0.000816
	13    0         1      1       1  0.561113
	14    1         0      1       1  0.653407
	15    1         1      1       1  0.330375

Sum out Leaving

	  Fire Tampering Report      prob
	0    0         0      0  0.989195
	1    0         0      1  0.010805
	2    0         1      0  0.436369
	3    0         1      1  0.563631
	4    1         0      0  0.345305
	5    1         0      1  0.654695
	6    1         1      0  0.664030
	7    1         1      1  0.335970

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire Tampering Report      prob
	0    0         0      0  0.989195
	1    0         0      1  0.010805
	2    0         1      0  0.436369
	3    0         1      1  0.563631
	4    1         0      0  0.345305
	5    1         0      1  0.654695
	6    1         1      0  0.664030
	7    1         1      1  0.335970

Eliminate variable: Fire

Factors to multiply containing variable: Fire

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Fire Tampering Report      prob
	0    0         0      0  0.989195
	1    0         0      1  0.010805
	2    0         1      0  0.436369
	3    0         1      1  0.563631
	4    1         0      0  0.345305
	5    1         0      1  0.654695
	6    1         1      0  0.664030
	7    1         1      1  0.335970

Result of multiplication: 

	  Fire Report Tampering      prob
	0    0      0         0  0.009793
	1    0      1         0  0.000107
	2    0      0         1  0.004320
	3    0      1         1  0.005580
	4    1      0         0  0.003108
	5    1      1         0  0.005892
	6    1      0         1  0.005976
	7    1      1         1  0.003024

Sum out Fire

	  Report Tampering      prob
	0      0         0  0.012901
	1      0         1  0.010296
	2      1         0  0.005999
	3      1         1  0.008604

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Report Tampering      prob
	0      0         0  0.012901
	1      0         1  0.010296
	2      1         0  0.005999
	3      1         1  0.008604

Eliminate variable: Report

Factors to multiply containing variable: Report

	  Report Tampering      prob
	0      0         0  0.012901
	1      0         1  0.010296
	2      1         0  0.005999
	3      1         1  0.008604

Result of multiplication: 

	  Report Tampering      prob
	0      0         0  0.012901
	1      0         1  0.010296
	2      1         0  0.005999
	3      1         1  0.008604

Storing factor for backtracking to find value of Report

	  Report Tampering      prob
	0      0         0  0.012901
	1      0         1  0.010296
	2      1         0  0.005999
	3      1         1  0.008604

Maximise out Report

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

Eliminate variable: Tampering

Factors to multiply containing variable: Tampering

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

Result of multiplication: 

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Storing factor for backtracking to find value of Tampering

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

New List of Factors: 

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Finding MAP instantiation for Tampering

MAP assignment for variable Tampering is 0

Popped this factor from the backtracking stack:

	  Report Tampering      prob
	0      0         0  0.012901
	1      0         1  0.010296
	2      1         0  0.005999
	3      1         1  0.008604

Finding MAP instantiation for Report

MAP assignment for variable Report is 0

Final Map Instantiation:

Tampering->0

Report->0

Elimination Order: ['JohnCalls', 'MaryCalls', 'Earthquake', 'Alarm']

MAP Variables: ['Alarm']

Observed Variables: {'Burglary': 'True'}

Original Factors: 

	  Burglary  prob
	0     True  0.01
	1    False  0.99

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Burglary Earthquake   prob
	0   True     True       True  0.950
	1  False     True       True  0.050
	2   True    False       True  0.290
	3  False    False       True  0.710
	4   True     True      False  0.940
	5  False     True      False  0.060
	6   True    False      False  0.001
	7  False    False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Factors with evidence applied: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Eliminate variable: JohnCalls

Factors to multiply containing variable: JohnCalls

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Result of multiplication: 

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Sum out JohnCalls

	   Alarm  prob
	0  False   1.0
	1   True   1.0

New List of Factors: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

	   Alarm  prob
	0  False   1.0
	1   True   1.0

Eliminate variable: MaryCalls

Factors to multiply containing variable: MaryCalls

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Result of multiplication: 

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Sum out MaryCalls

	   Alarm  prob
	0  False   1.0
	1   True   1.0

New List of Factors: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

Eliminate variable: Earthquake

Factors to multiply containing variable: Earthquake

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

Result of multiplication: 

	  Earthquake  Alarm    prob
	0       True   True  0.0190
	1       True  False  0.0010
	2      False   True  0.9212
	3      False  False  0.0588

Sum out Earthquake

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

New List of Factors: 

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Result of multiplication: 

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Storing factor for backtracking to find value of Alarm

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

New List of Factors: 

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Finding MAP instantiation for Alarm

MAP assignment for variable Alarm is True

Final Map Instantiation:

Alarm->True

Elimination Order: ['MaryCalls', 'Earthquake', 'JohnCalls', 'Alarm']

MAP Variables: ['Alarm', 'JohnCalls']

Observed Variables: {'Burglary': 'False'}

Original Factors: 

	  Burglary  prob
	0     True  0.01
	1    False  0.99

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Burglary Earthquake   prob
	0   True     True       True  0.950
	1  False     True       True  0.050
	2   True    False       True  0.290
	3  False    False       True  0.710
	4   True     True      False  0.940
	5  False     True      False  0.060
	6   True    False      False  0.001
	7  False    False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Factors with evidence applied: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Eliminate variable: MaryCalls

Factors to multiply containing variable: MaryCalls

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Result of multiplication: 

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Sum out MaryCalls

	   Alarm  prob
	0  False   1.0
	1   True   1.0

New List of Factors: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	   Alarm  prob
	0  False   1.0
	1   True   1.0

Eliminate variable: Earthquake

Factors to multiply containing variable: Earthquake

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

Result of multiplication: 

	  Earthquake  Alarm     prob
	0       True   True  0.00580
	1       True  False  0.01420
	2      False   True  0.00098
	3      False  False  0.97902

Sum out Earthquake

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

New List of Factors: 

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

Eliminate variable: JohnCalls

Factors to multiply containing variable: JohnCalls

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Result of multiplication: 

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Storing factor for backtracking to find value of JohnCalls

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Maximise out JohnCalls

	   Alarm  prob
	0  False  0.95
	1   True  0.90

New List of Factors: 

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

	   Alarm  prob
	0  False  0.95
	1   True  0.90

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

	   Alarm  prob
	0  False  0.95
	1   True  0.90

Result of multiplication: 

	   Alarm      prob
	0  False  0.943559
	1   True  0.006102

Storing factor for backtracking to find value of Alarm

	   Alarm      prob
	0  False  0.943559
	1   True  0.006102

New List of Factors: 

	   Alarm      prob
	0  False  0.943559
	1   True  0.006102

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	   Alarm      prob
	0  False  0.943559
	1   True  0.006102

Finding MAP instantiation for Alarm

MAP assignment for variable Alarm is False

Popped this factor from the backtracking stack:

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Finding MAP instantiation for JohnCalls

Elimination Order: ['Alarm', 'Leaving', 'Fire', 'Report', 'Tampering']

MAP Variables: ['Tampering', 'Report']

Observed Variables: {'Smoke': '1'}

Original Factors: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Factors with evidence applied: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

Result of multiplication: 

	   Tampering Alarm Fire Leaving      prob
	0          0     0    0       0  0.998900
	1          0     0    0       1  0.001000
	2          0     1    0       0  0.000012
	3          0     1    0       1  0.000088
	4          1     0    0       0  0.149850
	5          1     0    0       1  0.000150
	6          1     1    0       0  0.102000
	7          1     1    0       1  0.748000
	8          0     0    1       0  0.009990
	9          0     0    1       1  0.000010
	10         0     1    1       0  0.118800
	11         0     1    1       1  0.871200
	12         1     0    1       0  0.499500
	13         1     0    1       1  0.000500
	14         1     1    1       0  0.060000
	15         1     1    1       1  0.440000

Sum out Alarm

	  Tampering Fire Leaving      prob
	0         0    0       0  0.998912
	1         0    0       1  0.001088
	2         0    1       0  0.128790
	3         0    1       1  0.871210
	4         1    0       0  0.251850
	5         1    0       1  0.748150
	6         1    1       0  0.559500
	7         1    1       1  0.440500

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering Fire Leaving      prob
	0         0    0       0  0.998912
	1         0    0       1  0.001088
	2         0    1       0  0.128790
	3         0    1       1  0.871210
	4         1    0       0  0.251850
	5         1    0       1  0.748150
	6         1    1       0  0.559500
	7         1    1       1  0.440500

Eliminate variable: Leaving

Factors to multiply containing variable: Leaving

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Tampering Fire Leaving      prob
	0         0    0       0  0.998912
	1         0    0       1  0.001088
	2         0    1       0  0.128790
	3         0    1       1  0.871210
	4         1    0       0  0.251850
	5         1    0       1  0.748150
	6         1    1       0  0.559500
	7         1    1       1  0.440500

Result of multiplication: 

	   Tampering Fire Report Leaving      prob
	0          0    0      0       0  0.988923
	1          0    1      0       0  0.127502
	2          1    0      0       0  0.249331
	3          1    1      0       0  0.553905
	4          0    0      1       0  0.009989
	5          0    1      1       0  0.001288
	6          1    0      1       0  0.002518
	7          1    1      1       0  0.005595
	8          0    0      0       1  0.000272
	9          0    1      0       1  0.217802
	10         1    0      0       1  0.187037
	11         1    1      0       1  0.110125
	12         0    0      1       1  0.000816
	13         0    1      1       1  0.653407
	14         1    0      1       1  0.561113
	15         1    1      1       1  0.330375

Sum out Leaving

	  Tampering Fire Report      prob
	0         0    0      0  0.989195
	1         0    0      1  0.010805
	2         0    1      0  0.345305
	3         0    1      1  0.654695
	4         1    0      0  0.436369
	5         1    0      1  0.563631
	6         1    1      0  0.664030
	7         1    1      1  0.335970

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering Fire Report      prob
	0         0    0      0  0.989195
	1         0    0      1  0.010805
	2         0    1      0  0.345305
	3         0    1      1  0.654695
	4         1    0      0  0.436369
	5         1    0      1  0.563631
	6         1    1      0  0.664030
	7         1    1      1  0.335970

Eliminate variable: Fire

Factors to multiply containing variable: Fire

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering Fire Report      prob
	0         0    0      0  0.989195
	1         0    0      1  0.010805
	2         0    1      0  0.345305
	3         0    1      1  0.654695
	4         1    0      0  0.436369
	5         1    0      1  0.563631
	6         1    1      0  0.664030
	7         1    1      1  0.335970

Result of multiplication: 

	  Tampering Fire Report      prob
	0         0    0      0  0.009793
	1         0    0      1  0.000107
	2         1    0      0  0.004320
	3         1    0      1  0.005580
	4         0    1      0  0.003108
	5         0    1      1  0.005892
	6         1    1      0  0.005976
	7         1    1      1  0.003024

Sum out Fire

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Eliminate variable: Report

Factors to multiply containing variable: Report

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Result of multiplication: 

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Storing factor for backtracking to find value of Report

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Maximise out Report

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

Eliminate variable: Tampering

Factors to multiply containing variable: Tampering

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

Result of multiplication: 

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Storing factor for backtracking to find value of Tampering

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

New List of Factors: 

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Finding MAP instantiation for Tampering

MAP assignment for variable Tampering is 0

Popped this factor from the backtracking stack:

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Finding MAP instantiation for Report

MAP assignment for variable Report is 0

Final Map Instantiation:

Tampering->0

Report->0

Elimination Order: ['Smoke', 'Alarm', 'Leaving', 'Fire', 'Report', 'Tampering']

MAP Variables: ['Tampering', 'Report']

Observed Variables: {}

Original Factors: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Factors with evidence applied: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Eliminate variable: Smoke

Factors to multiply containing variable: Smoke

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

Result of multiplication: 

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

Sum out Smoke

	  Fire  prob
	0    0   1.0
	1    1   1.0

New List of Factors: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire  prob
	0    0   1.0
	1    1   1.0

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

Result of multiplication: 

	   Tampering Alarm Fire Leaving      prob
	0          0     0    0       0  0.998900
	1          0     0    0       1  0.001000
	2          0     1    0       0  0.000012
	3          0     1    0       1  0.000088
	4          1     0    0       0  0.149850
	5          1     0    0       1  0.000150
	6          1     1    0       0  0.102000
	7          1     1    0       1  0.748000
	8          0     0    1       0  0.009990
	9          0     0    1       1  0.000010
	10         0     1    1       0  0.118800
	11         0     1    1       1  0.871200
	12         1     0    1       0  0.499500
	13         1     0    1       1  0.000500
	14         1     1    1       0  0.060000
	15         1     1    1       1  0.440000

Sum out Alarm

	  Tampering Fire Leaving      prob
	0         0    0       0  0.998912
	1         0    0       1  0.001088
	2         0    1       0  0.128790
	3         0    1       1  0.871210
	4         1    0       0  0.251850
	5         1    0       1  0.748150
	6         1    1       0  0.559500
	7         1    1       1  0.440500

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire  prob
	0    0   1.0
	1    1   1.0

	  Tampering Fire Leaving      prob
	0         0    0       0  0.998912
	1         0    0       1  0.001088
	2         0    1       0  0.128790
	3         0    1       1  0.871210
	4         1    0       0  0.251850
	5         1    0       1  0.748150
	6         1    1       0  0.559500
	7         1    1       1  0.440500

Eliminate variable: Leaving

Factors to multiply containing variable: Leaving

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Tampering Fire Leaving      prob
	0         0    0       0  0.998912
	1         0    0       1  0.001088
	2         0    1       0  0.128790
	3         0    1       1  0.871210
	4         1    0       0  0.251850
	5         1    0       1  0.748150
	6         1    1       0  0.559500
	7         1    1       1  0.440500

Result of multiplication: 

	   Tampering Fire Report Leaving      prob
	0          0    0      0       0  0.988923
	1          0    1      0       0  0.127502
	2          1    0      0       0  0.249331
	3          1    1      0       0  0.553905
	4          0    0      1       0  0.009989
	5          0    1      1       0  0.001288
	6          1    0      1       0  0.002518
	7          1    1      1       0  0.005595
	8          0    0      0       1  0.000272
	9          0    1      0       1  0.217802
	10         1    0      0       1  0.187037
	11         1    1      0       1  0.110125
	12         0    0      1       1  0.000816
	13         0    1      1       1  0.653407
	14         1    0      1       1  0.561113
	15         1    1      1       1  0.330375

Sum out Leaving

	  Tampering Fire Report      prob
	0         0    0      0  0.989195
	1         0    0      1  0.010805
	2         0    1      0  0.345305
	3         0    1      1  0.654695
	4         1    0      0  0.436369
	5         1    0      1  0.563631
	6         1    1      0  0.664030
	7         1    1      1  0.335970

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire  prob
	0    0   1.0
	1    1   1.0

	  Tampering Fire Report      prob
	0         0    0      0  0.989195
	1         0    0      1  0.010805
	2         0    1      0  0.345305
	3         0    1      1  0.654695
	4         1    0      0  0.436369
	5         1    0      1  0.563631
	6         1    1      0  0.664030
	7         1    1      1  0.335970

Eliminate variable: Fire

Factors to multiply containing variable: Fire

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	0    0   1.0
	1    1   1.0

	  Tampering Fire Report      prob
	0         0    0      0  0.989195
	1         0    0      1  0.010805
	2         0    1      0  0.345305
	3         0    1      1  0.654695
	4         1    0      0  0.436369
	5         1    0      1  0.563631
	6         1    1      0  0.664030
	7         1    1      1  0.335970

Result of multiplication: 

	  Tampering Fire Report      prob
	0         0    0      0  0.979303
	1         0    0      1  0.010697
	2         1    0      0  0.432005
	3         1    0      1  0.557995
	4         0    1      0  0.003453
	5         0    1      1  0.006547
	6         1    1      0  0.006640
	7         1    1      1  0.003360

Sum out Fire

	  Tampering Report      prob
	0         0      0  0.982756
	1         0      1  0.017244
	2         1      0  0.438646
	3         1      1  0.561354

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering Report      prob
	0         0      0  0.982756
	1         0      1  0.017244
	2         1      0  0.438646
	3         1      1  0.561354

Eliminate variable: Report

Factors to multiply containing variable: Report

	  Tampering Report      prob
	0         0      0  0.982756
	1         0      1  0.017244
	2         1      0  0.438646
	3         1      1  0.561354

Result of multiplication: 

	  Tampering Report      prob
	0         0      0  0.982756
	1         0      1  0.017244
	2         1      0  0.438646
	3         1      1  0.561354

Storing factor for backtracking to find value of Report

	  Tampering Report      prob
	0         0      0  0.982756
	1         0      1  0.017244
	2         1      0  0.438646
	3         1      1  0.561354

Maximise out Report

	  Tampering      prob
	0         0  0.982756
	1         1  0.561354

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.982756
	1         1  0.561354

Eliminate variable: Tampering

Factors to multiply containing variable: Tampering

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.982756
	1         1  0.561354

Result of multiplication: 

	  Tampering      prob
	0         0  0.963101
	1         1  0.011227

Storing factor for backtracking to find value of Tampering

	  Tampering      prob
	0         0  0.963101
	1         1  0.011227

New List of Factors: 

	  Tampering      prob
	0         0  0.963101
	1         1  0.011227

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	  Tampering      prob
	0         0  0.963101
	1         1  0.011227

Finding MAP instantiation for Tampering

MAP assignment for variable Tampering is 0

Popped this factor from the backtracking stack:

	  Tampering Report      prob
	0         0      0  0.982756
	1         0      1  0.017244
	2         1      0  0.438646
	3         1      1  0.561354

Finding MAP instantiation for Report

MAP assignment for variable Report is 0

Final Map Instantiation:

Tampering->0

Report->0

Elimination Order: ['Alarm', 'Leaving', 'Fire', 'Report', 'Tampering']

MAP Variables: ['Tampering', 'Report']

Observed Variables: {'Smoke': '1'}

Original Factors: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Factors with evidence applied: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

Result of multiplication: 

	   Tampering Alarm Fire Leaving      prob
	0          0     0    0       0  0.998900
	1          0     0    0       1  0.001000
	2          0     1    0       0  0.000012
	3          0     1    0       1  0.000088
	4          1     0    0       0  0.149850
	5          1     0    0       1  0.000150
	6          1     1    0       0  0.102000
	7          1     1    0       1  0.748000
	8          0     0    1       0  0.009990
	9          0     0    1       1  0.000010
	10         0     1    1       0  0.118800
	11         0     1    1       1  0.871200
	12         1     0    1       0  0.499500
	13         1     0    1       1  0.000500
	14         1     1    1       0  0.060000
	15         1     1    1       1  0.440000

Sum out Alarm

	  Tampering Fire Leaving      prob
	0         0    0       0  0.998912
	1         0    0       1  0.001088
	2         0    1       0  0.128790
	3         0    1       1  0.871210
	4         1    0       0  0.251850
	5         1    0       1  0.748150
	6         1    1       0  0.559500
	7         1    1       1  0.440500

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering Fire Leaving      prob
	0         0    0       0  0.998912
	1         0    0       1  0.001088
	2         0    1       0  0.128790
	3         0    1       1  0.871210
	4         1    0       0  0.251850
	5         1    0       1  0.748150
	6         1    1       0  0.559500
	7         1    1       1  0.440500

Eliminate variable: Leaving

Factors to multiply containing variable: Leaving

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Tampering Fire Leaving      prob
	0         0    0       0  0.998912
	1         0    0       1  0.001088
	2         0    1       0  0.128790
	3         0    1       1  0.871210
	4         1    0       0  0.251850
	5         1    0       1  0.748150
	6         1    1       0  0.559500
	7         1    1       1  0.440500

Result of multiplication: 

	   Tampering Fire Report Leaving      prob
	0          0    0      0       0  0.988923
	1          0    1      0       0  0.127502
	2          1    0      0       0  0.249331
	3          1    1      0       0  0.553905
	4          0    0      1       0  0.009989
	5          0    1      1       0  0.001288
	6          1    0      1       0  0.002518
	7          1    1      1       0  0.005595
	8          0    0      0       1  0.000272
	9          0    1      0       1  0.217802
	10         1    0      0       1  0.187037
	11         1    1      0       1  0.110125
	12         0    0      1       1  0.000816
	13         0    1      1       1  0.653407
	14         1    0      1       1  0.561113
	15         1    1      1       1  0.330375

Sum out Leaving

	  Tampering Fire Report      prob
	0         0    0      0  0.989195
	1         0    0      1  0.010805
	2         0    1      0  0.345305
	3         0    1      1  0.654695
	4         1    0      0  0.436369
	5         1    0      1  0.563631
	6         1    1      0  0.664030
	7         1    1      1  0.335970

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering Fire Report      prob
	0         0    0      0  0.989195
	1         0    0      1  0.010805
	2         0    1      0  0.345305
	3         0    1      1  0.654695
	4         1    0      0  0.436369
	5         1    0      1  0.563631
	6         1    1      0  0.664030
	7         1    1      1  0.335970

Eliminate variable: Fire

Factors to multiply containing variable: Fire

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering Fire Report      prob
	0         0    0      0  0.989195
	1         0    0      1  0.010805
	2         0    1      0  0.345305
	3         0    1      1  0.654695
	4         1    0      0  0.436369
	5         1    0      1  0.563631
	6         1    1      0  0.664030
	7         1    1      1  0.335970

Result of multiplication: 

	  Tampering Fire Report      prob
	0         0    0      0  0.009793
	1         0    0      1  0.000107
	2         1    0      0  0.004320
	3         1    0      1  0.005580
	4         0    1      0  0.003108
	5         0    1      1  0.005892
	6         1    1      0  0.005976
	7         1    1      1  0.003024

Sum out Fire

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Eliminate variable: Report

Factors to multiply containing variable: Report

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Result of multiplication: 

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Storing factor for backtracking to find value of Report

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Maximise out Report

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

Eliminate variable: Tampering

Factors to multiply containing variable: Tampering

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

Result of multiplication: 

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Storing factor for backtracking to find value of Tampering

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

New List of Factors: 

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Finding MAP instantiation for Tampering

MAP assignment for variable Tampering is 0

Popped this factor from the backtracking stack:

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Finding MAP instantiation for Report

MAP assignment for variable Report is 0

Final Map Instantiation:

Tampering->0

Report->0

Elimination Order: ['JohnCalls', 'MaryCalls', 'Earthquake', 'Alarm']

MAP Variables: ['Alarm']

Observed Variables: {'Burglary': 'True'}

Original Factors: 

	  Burglary  prob
	0     True  0.01
	1    False  0.99

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Burglary Earthquake   prob
	0   True     True       True  0.950
	1  False     True       True  0.050
	2   True    False       True  0.290
	3  False    False       True  0.710
	4   True     True      False  0.940
	5  False     True      False  0.060
	6   True    False      False  0.001
	7  False    False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Factors with evidence applied: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Eliminate variable: JohnCalls

Factors to multiply containing variable: JohnCalls

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Result of multiplication: 

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Sum out JohnCalls

	   Alarm  prob
	0  False   1.0
	1   True   1.0

New List of Factors: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

	   Alarm  prob
	0  False   1.0
	1   True   1.0

Eliminate variable: MaryCalls

Factors to multiply containing variable: MaryCalls

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Result of multiplication: 

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Sum out MaryCalls

	   Alarm  prob
	0  False   1.0
	1   True   1.0

New List of Factors: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

Eliminate variable: Earthquake

Factors to multiply containing variable: Earthquake

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

Result of multiplication: 

	   Alarm Earthquake    prob
	0   True       True  0.0190
	1  False       True  0.0010
	2   True      False  0.9212
	3  False      False  0.0588

Sum out Earthquake

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

New List of Factors: 

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Result of multiplication: 

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Storing factor for backtracking to find value of Alarm

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

New List of Factors: 

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Finding MAP instantiation for Alarm

MAP assignment for variable Alarm is True

Final Map Instantiation:

Alarm->True

Elimination Order: ['MaryCalls', 'Earthquake', 'JohnCalls', 'Alarm']

MAP Variables: ['Alarm', 'JohnCalls']

Observed Variables: {'Burglary': 'False'}

Original Factors: 

	  Burglary  prob
	0     True  0.01
	1    False  0.99

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Burglary Earthquake   prob
	0   True     True       True  0.950
	1  False     True       True  0.050
	2   True    False       True  0.290
	3  False    False       True  0.710
	4   True     True      False  0.940
	5  False     True      False  0.060
	6   True    False      False  0.001
	7  False    False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Factors with evidence applied: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Eliminate variable: MaryCalls

Factors to multiply containing variable: MaryCalls

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Result of multiplication: 

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Sum out MaryCalls

	   Alarm  prob
	0  False   1.0
	1   True   1.0

New List of Factors: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	   Alarm  prob
	0  False   1.0
	1   True   1.0

Eliminate variable: Earthquake

Factors to multiply containing variable: Earthquake

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

Result of multiplication: 

	   Alarm Earthquake     prob
	0   True       True  0.00580
	1  False       True  0.01420
	2   True      False  0.00098
	3  False      False  0.97902

Sum out Earthquake

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

New List of Factors: 

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

Eliminate variable: JohnCalls

Factors to multiply containing variable: JohnCalls

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Result of multiplication: 

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Storing factor for backtracking to find value of JohnCalls

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Maximise out JohnCalls

	   Alarm  prob
	0  False  0.95
	1   True  0.90

New List of Factors: 

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

	   Alarm  prob
	0  False  0.95
	1   True  0.90

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

	   Alarm  prob
	0  False  0.95
	1   True  0.90

Result of multiplication: 

	   Alarm      prob
	0  False  0.943559
	1   True  0.006102

Storing factor for backtracking to find value of Alarm

	   Alarm      prob
	0  False  0.943559
	1   True  0.006102

New List of Factors: 

	   Alarm      prob
	0  False  0.943559
	1   True  0.006102

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	   Alarm      prob
	0  False  0.943559
	1   True  0.006102

Finding MAP instantiation for Alarm

MAP assignment for variable Alarm is False

Popped this factor from the backtracking stack:

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Finding MAP instantiation for JohnCalls

Elimination Order: ['MaryCalls', 'Earthquake', 'JohnCalls', 'Alarm']

MAP Variables: ['Alarm', 'JohnCalls']

Observed Variables: {'Burglary': 'False'}

Original Factors: 

	  Burglary  prob
	0     True  0.01
	1    False  0.99

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Burglary Earthquake   prob
	0   True     True       True  0.950
	1  False     True       True  0.050
	2   True    False       True  0.290
	3  False    False       True  0.710
	4   True     True      False  0.940
	5  False     True      False  0.060
	6   True    False      False  0.001
	7  False    False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Factors with evidence applied: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Eliminate variable: MaryCalls

Factors to multiply containing variable: MaryCalls

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Result of multiplication: 

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Sum out MaryCalls

	   Alarm  prob
	0  False   1.0
	1   True   1.0

New List of Factors: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	   Alarm  prob
	0  False   1.0
	1   True   1.0

Eliminate variable: Earthquake

Factors to multiply containing variable: Earthquake

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

Result of multiplication: 

	   Alarm Earthquake     prob
	0   True       True  0.00580
	1  False       True  0.01420
	2   True      False  0.00098
	3  False      False  0.97902

Sum out Earthquake

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

New List of Factors: 

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

Eliminate variable: JohnCalls

Factors to multiply containing variable: JohnCalls

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Result of multiplication: 

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Storing factor for backtracking to find value of JohnCalls

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Maximise out JohnCalls

	   Alarm  prob
	0  False  0.95
	1   True  0.90

New List of Factors: 

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

	   Alarm  prob
	0  False  0.95
	1   True  0.90

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

	   Alarm  prob
	0  False  0.95
	1   True  0.90

Result of multiplication: 

	   Alarm      prob
	0  False  0.943559
	1   True  0.006102

Storing factor for backtracking to find value of Alarm

	   Alarm      prob
	0  False  0.943559
	1   True  0.006102

New List of Factors: 

	   Alarm      prob
	0  False  0.943559
	1   True  0.006102

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	   Alarm      prob
	0  False  0.943559
	1   True  0.006102

Finding MAP instantiation for Alarm

MAP assignment for variable Alarm is False

Popped this factor from the backtracking stack:

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Finding MAP instantiation for JohnCalls

Elimination Order: ['Alarm', 'Leaving', 'Fire', 'Report', 'Tampering']

MAP Variables: ['Tampering', 'Report']

Observed Variables: {'Smoke': '1'}

Original Factors: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Factors with evidence applied: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

Result of multiplication: 

	   Fire Alarm Leaving Tampering      prob
	0     0     0       0         0  0.998900
	1     0     0       1         0  0.001000
	2     0     1       0         0  0.000012
	3     0     1       1         0  0.000088
	4     0     0       0         1  0.149850
	5     0     0       1         1  0.000150
	6     0     1       0         1  0.102000
	7     0     1       1         1  0.748000
	8     1     0       0         0  0.009990
	9     1     0       1         0  0.000010
	10    1     1       0         0  0.118800
	11    1     1       1         0  0.871200
	12    1     0       0         1  0.499500
	13    1     0       1         1  0.000500
	14    1     1       0         1  0.060000
	15    1     1       1         1  0.440000

Sum out Alarm

	  Fire Leaving Tampering      prob
	0    0       0         0  0.998912
	1    0       0         1  0.251850
	2    0       1         0  0.001088
	3    0       1         1  0.748150
	4    1       0         0  0.128790
	5    1       0         1  0.559500
	6    1       1         0  0.871210
	7    1       1         1  0.440500

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire Leaving Tampering      prob
	0    0       0         0  0.998912
	1    0       0         1  0.251850
	2    0       1         0  0.001088
	3    0       1         1  0.748150
	4    1       0         0  0.128790
	5    1       0         1  0.559500
	6    1       1         0  0.871210
	7    1       1         1  0.440500

Eliminate variable: Leaving

Factors to multiply containing variable: Leaving

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Fire Leaving Tampering      prob
	0    0       0         0  0.998912
	1    0       0         1  0.251850
	2    0       1         0  0.001088
	3    0       1         1  0.748150
	4    1       0         0  0.128790
	5    1       0         1  0.559500
	6    1       1         0  0.871210
	7    1       1         1  0.440500

Result of multiplication: 

	   Fire Tampering Leaving Report      prob
	0     0         0       0      0  0.988923
	1     0         1       0      0  0.249331
	2     1         0       0      0  0.127502
	3     1         1       0      0  0.553905
	4     0         0       0      1  0.009989
	5     0         1       0      1  0.002518
	6     1         0       0      1  0.001288
	7     1         1       0      1  0.005595
	8     0         0       1      0  0.000272
	9     0         1       1      0  0.187037
	10    1         0       1      0  0.217802
	11    1         1       1      0  0.110125
	12    0         0       1      1  0.000816
	13    0         1       1      1  0.561113
	14    1         0       1      1  0.653407
	15    1         1       1      1  0.330375

Sum out Leaving

	  Fire Tampering Report      prob
	0    0         0      0  0.989195
	1    0         0      1  0.010805
	2    0         1      0  0.436369
	3    0         1      1  0.563631
	4    1         0      0  0.345305
	5    1         0      1  0.654695
	6    1         1      0  0.664030
	7    1         1      1  0.335970

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire Tampering Report      prob
	0    0         0      0  0.989195
	1    0         0      1  0.010805
	2    0         1      0  0.436369
	3    0         1      1  0.563631
	4    1         0      0  0.345305
	5    1         0      1  0.654695
	6    1         1      0  0.664030
	7    1         1      1  0.335970

Eliminate variable: Fire

Factors to multiply containing variable: Fire

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Fire Tampering Report      prob
	0    0         0      0  0.989195
	1    0         0      1  0.010805
	2    0         1      0  0.436369
	3    0         1      1  0.563631
	4    1         0      0  0.345305
	5    1         0      1  0.654695
	6    1         1      0  0.664030
	7    1         1      1  0.335970

Result of multiplication: 

	  Fire Tampering Report      prob
	0    0         0      0  0.009793
	1    0         0      1  0.000107
	2    0         1      0  0.004320
	3    0         1      1  0.005580
	4    1         0      0  0.003108
	5    1         0      1  0.005892
	6    1         1      0  0.005976
	7    1         1      1  0.003024

Sum out Fire

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Eliminate variable: Report

Factors to multiply containing variable: Report

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Result of multiplication: 

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Storing factor for backtracking to find value of Report

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Maximise out Report

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

Eliminate variable: Tampering

Factors to multiply containing variable: Tampering

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

Result of multiplication: 

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Storing factor for backtracking to find value of Tampering

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

New List of Factors: 

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Finding MAP instantiation for Tampering

MAP assignment for variable Tampering is 0

Popped this factor from the backtracking stack:

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Finding MAP instantiation for Report

MAP assignment for variable Report is 0

Final Map Instantiation:

Tampering->0

Report->0

Elimination Order: ['Smoke', 'Alarm', 'Leaving', 'Fire', 'Report', 'Tampering']

MAP Variables: ['Tampering', 'Report']

Observed Variables: {}

Original Factors: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Factors with evidence applied: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Eliminate variable: Smoke

Factors to multiply containing variable: Smoke

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

Result of multiplication: 

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

Sum out Smoke

	  Fire  prob
	0    0   1.0
	1    1   1.0

New List of Factors: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire  prob
	0    0   1.0
	1    1   1.0

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

Result of multiplication: 

	   Fire Alarm Leaving Tampering      prob
	0     0     0       0         0  0.998900
	1     0     0       1         0  0.001000
	2     0     1       0         0  0.000012
	3     0     1       1         0  0.000088
	4     0     0       0         1  0.149850
	5     0     0       1         1  0.000150
	6     0     1       0         1  0.102000
	7     0     1       1         1  0.748000
	8     1     0       0         0  0.009990
	9     1     0       1         0  0.000010
	10    1     1       0         0  0.118800
	11    1     1       1         0  0.871200
	12    1     0       0         1  0.499500
	13    1     0       1         1  0.000500
	14    1     1       0         1  0.060000
	15    1     1       1         1  0.440000

Sum out Alarm

	  Fire Leaving Tampering      prob
	0    0       0         0  0.998912
	1    0       0         1  0.251850
	2    0       1         0  0.001088
	3    0       1         1  0.748150
	4    1       0         0  0.128790
	5    1       0         1  0.559500
	6    1       1         0  0.871210
	7    1       1         1  0.440500

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire  prob
	0    0   1.0
	1    1   1.0

	  Fire Leaving Tampering      prob
	0    0       0         0  0.998912
	1    0       0         1  0.251850
	2    0       1         0  0.001088
	3    0       1         1  0.748150
	4    1       0         0  0.128790
	5    1       0         1  0.559500
	6    1       1         0  0.871210
	7    1       1         1  0.440500

Eliminate variable: Leaving

Factors to multiply containing variable: Leaving

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Fire Leaving Tampering      prob
	0    0       0         0  0.998912
	1    0       0         1  0.251850
	2    0       1         0  0.001088
	3    0       1         1  0.748150
	4    1       0         0  0.128790
	5    1       0         1  0.559500
	6    1       1         0  0.871210
	7    1       1         1  0.440500

Result of multiplication: 

	   Fire Tampering Leaving Report      prob
	0     0         0       0      0  0.988923
	1     0         1       0      0  0.249331
	2     1         0       0      0  0.127502
	3     1         1       0      0  0.553905
	4     0         0       0      1  0.009989
	5     0         1       0      1  0.002518
	6     1         0       0      1  0.001288
	7     1         1       0      1  0.005595
	8     0         0       1      0  0.000272
	9     0         1       1      0  0.187037
	10    1         0       1      0  0.217802
	11    1         1       1      0  0.110125
	12    0         0       1      1  0.000816
	13    0         1       1      1  0.561113
	14    1         0       1      1  0.653407
	15    1         1       1      1  0.330375

Sum out Leaving

	  Fire Tampering Report      prob
	0    0         0      0  0.989195
	1    0         0      1  0.010805
	2    0         1      0  0.436369
	3    0         1      1  0.563631
	4    1         0      0  0.345305
	5    1         0      1  0.654695
	6    1         1      0  0.664030
	7    1         1      1  0.335970

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire  prob
	0    0   1.0
	1    1   1.0

	  Fire Tampering Report      prob
	0    0         0      0  0.989195
	1    0         0      1  0.010805
	2    0         1      0  0.436369
	3    0         1      1  0.563631
	4    1         0      0  0.345305
	5    1         0      1  0.654695
	6    1         1      0  0.664030
	7    1         1      1  0.335970

Eliminate variable: Fire

Factors to multiply containing variable: Fire

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	0    0   1.0
	1    1   1.0

	  Fire Tampering Report      prob
	0    0         0      0  0.989195
	1    0         0      1  0.010805
	2    0         1      0  0.436369
	3    0         1      1  0.563631
	4    1         0      0  0.345305
	5    1         0      1  0.654695
	6    1         1      0  0.664030
	7    1         1      1  0.335970

Result of multiplication: 

	  Fire Tampering Report      prob
	0    0         0      0  0.979303
	1    0         0      1  0.010697
	2    0         1      0  0.432005
	3    0         1      1  0.557995
	4    1         0      0  0.003453
	5    1         0      1  0.006547
	6    1         1      0  0.006640
	7    1         1      1  0.003360

Sum out Fire

	  Tampering Report      prob
	0         0      0  0.982756
	1         0      1  0.017244
	2         1      0  0.438646
	3         1      1  0.561354

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering Report      prob
	0         0      0  0.982756
	1         0      1  0.017244
	2         1      0  0.438646
	3         1      1  0.561354

Eliminate variable: Report

Factors to multiply containing variable: Report

	  Tampering Report      prob
	0         0      0  0.982756
	1         0      1  0.017244
	2         1      0  0.438646
	3         1      1  0.561354

Result of multiplication: 

	  Tampering Report      prob
	0         0      0  0.982756
	1         0      1  0.017244
	2         1      0  0.438646
	3         1      1  0.561354

Storing factor for backtracking to find value of Report

	  Tampering Report      prob
	0         0      0  0.982756
	1         0      1  0.017244
	2         1      0  0.438646
	3         1      1  0.561354

Maximise out Report

	  Tampering      prob
	0         0  0.982756
	1         1  0.561354

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.982756
	1         1  0.561354

Eliminate variable: Tampering

Factors to multiply containing variable: Tampering

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.982756
	1         1  0.561354

Result of multiplication: 

	  Tampering      prob
	0         0  0.963101
	1         1  0.011227

Storing factor for backtracking to find value of Tampering

	  Tampering      prob
	0         0  0.963101
	1         1  0.011227

New List of Factors: 

	  Tampering      prob
	0         0  0.963101
	1         1  0.011227

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	  Tampering      prob
	0         0  0.963101
	1         1  0.011227

Finding MAP instantiation for Tampering

MAP assignment for variable Tampering is 0

Popped this factor from the backtracking stack:

	  Tampering Report      prob
	0         0      0  0.982756
	1         0      1  0.017244
	2         1      0  0.438646
	3         1      1  0.561354

Finding MAP instantiation for Report

MAP assignment for variable Report is 0

Final Map Instantiation:

Tampering->0

Report->0

Elimination Order: ['Alarm', 'Leaving', 'Fire', 'Report', 'Tampering']

MAP Variables: ['Tampering', 'Report']

Observed Variables: {'Smoke': '1'}

Original Factors: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Factors with evidence applied: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

Result of multiplication: 

	   Fire Alarm Leaving Tampering      prob
	0     0     0       0         0  0.998900
	1     0     0       1         0  0.001000
	2     0     1       0         0  0.000012
	3     0     1       1         0  0.000088
	4     0     0       0         1  0.149850
	5     0     0       1         1  0.000150
	6     0     1       0         1  0.102000
	7     0     1       1         1  0.748000
	8     1     0       0         0  0.009990
	9     1     0       1         0  0.000010
	10    1     1       0         0  0.118800
	11    1     1       1         0  0.871200
	12    1     0       0         1  0.499500
	13    1     0       1         1  0.000500
	14    1     1       0         1  0.060000
	15    1     1       1         1  0.440000

Sum out Alarm

	  Fire Leaving Tampering      prob
	0    0       0         0  0.998912
	1    0       0         1  0.251850
	2    0       1         0  0.001088
	3    0       1         1  0.748150
	4    1       0         0  0.128790
	5    1       0         1  0.559500
	6    1       1         0  0.871210
	7    1       1         1  0.440500

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire Leaving Tampering      prob
	0    0       0         0  0.998912
	1    0       0         1  0.251850
	2    0       1         0  0.001088
	3    0       1         1  0.748150
	4    1       0         0  0.128790
	5    1       0         1  0.559500
	6    1       1         0  0.871210
	7    1       1         1  0.440500

Eliminate variable: Leaving

Factors to multiply containing variable: Leaving

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Fire Leaving Tampering      prob
	0    0       0         0  0.998912
	1    0       0         1  0.251850
	2    0       1         0  0.001088
	3    0       1         1  0.748150
	4    1       0         0  0.128790
	5    1       0         1  0.559500
	6    1       1         0  0.871210
	7    1       1         1  0.440500

Result of multiplication: 

	   Fire Tampering Leaving Report      prob
	0     0         0       0      0  0.988923
	1     0         1       0      0  0.249331
	2     1         0       0      0  0.127502
	3     1         1       0      0  0.553905
	4     0         0       0      1  0.009989
	5     0         1       0      1  0.002518
	6     1         0       0      1  0.001288
	7     1         1       0      1  0.005595
	8     0         0       1      0  0.000272
	9     0         1       1      0  0.187037
	10    1         0       1      0  0.217802
	11    1         1       1      0  0.110125
	12    0         0       1      1  0.000816
	13    0         1       1      1  0.561113
	14    1         0       1      1  0.653407
	15    1         1       1      1  0.330375

Sum out Leaving

	  Fire Tampering Report      prob
	0    0         0      0  0.989195
	1    0         0      1  0.010805
	2    0         1      0  0.436369
	3    0         1      1  0.563631
	4    1         0      0  0.345305
	5    1         0      1  0.654695
	6    1         1      0  0.664030
	7    1         1      1  0.335970

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire Tampering Report      prob
	0    0         0      0  0.989195
	1    0         0      1  0.010805
	2    0         1      0  0.436369
	3    0         1      1  0.563631
	4    1         0      0  0.345305
	5    1         0      1  0.654695
	6    1         1      0  0.664030
	7    1         1      1  0.335970

Eliminate variable: Fire

Factors to multiply containing variable: Fire

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Fire Tampering Report      prob
	0    0         0      0  0.989195
	1    0         0      1  0.010805
	2    0         1      0  0.436369
	3    0         1      1  0.563631
	4    1         0      0  0.345305
	5    1         0      1  0.654695
	6    1         1      0  0.664030
	7    1         1      1  0.335970

Result of multiplication: 

	  Fire Tampering Report      prob
	0    0         0      0  0.009793
	1    0         0      1  0.000107
	2    0         1      0  0.004320
	3    0         1      1  0.005580
	4    1         0      0  0.003108
	5    1         0      1  0.005892
	6    1         1      0  0.005976
	7    1         1      1  0.003024

Sum out Fire

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Eliminate variable: Report

Factors to multiply containing variable: Report

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Result of multiplication: 

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Storing factor for backtracking to find value of Report

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Maximise out Report

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

Eliminate variable: Tampering

Factors to multiply containing variable: Tampering

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

Result of multiplication: 

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Storing factor for backtracking to find value of Tampering

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

New List of Factors: 

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Finding MAP instantiation for Tampering

MAP assignment for variable Tampering is 0

Popped this factor from the backtracking stack:

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Finding MAP instantiation for Report

MAP assignment for variable Report is 0

Final Map Instantiation:

Tampering->0

Report->0

Elimination Order: ['JohnCalls', 'MaryCalls', 'Earthquake', 'Alarm']

MAP Variables: ['Alarm']

Observed Variables: {'Burglary': 'True'}

Original Factors: 

	  Burglary  prob
	0     True  0.01
	1    False  0.99

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Burglary Earthquake   prob
	0   True     True       True  0.950
	1  False     True       True  0.050
	2   True    False       True  0.290
	3  False    False       True  0.710
	4   True     True      False  0.940
	5  False     True      False  0.060
	6   True    False      False  0.001
	7  False    False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Factors with evidence applied: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Eliminate variable: JohnCalls

Factors to multiply containing variable: JohnCalls

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Result of multiplication: 

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Sum out JohnCalls

	   Alarm  prob
	0  False   1.0
	1   True   1.0

New List of Factors: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

	   Alarm  prob
	0  False   1.0
	1   True   1.0

Eliminate variable: MaryCalls

Factors to multiply containing variable: MaryCalls

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Result of multiplication: 

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Sum out MaryCalls

	   Alarm  prob
	0  False   1.0
	1   True   1.0

New List of Factors: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

Eliminate variable: Earthquake

Factors to multiply containing variable: Earthquake

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

Result of multiplication: 

	  Earthquake  Alarm    prob
	0       True   True  0.0190
	1       True  False  0.0010
	2      False   True  0.9212
	3      False  False  0.0588

Sum out Earthquake

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

New List of Factors: 

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Result of multiplication: 

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Storing factor for backtracking to find value of Alarm

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

New List of Factors: 

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Finding MAP instantiation for Alarm

MAP assignment for variable Alarm is True

Final Map Instantiation:

Alarm->True

Elimination Order: ['MaryCalls', 'Earthquake', 'JohnCalls', 'Alarm']

MAP Variables: ['Alarm', 'JohnCalls']

Observed Variables: {'Burglary': 'False'}

Original Factors: 

	  Burglary  prob
	0     True  0.01
	1    False  0.99

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Burglary Earthquake   prob
	0   True     True       True  0.950
	1  False     True       True  0.050
	2   True    False       True  0.290
	3  False    False       True  0.710
	4   True     True      False  0.940
	5  False     True      False  0.060
	6   True    False      False  0.001
	7  False    False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Factors with evidence applied: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Eliminate variable: MaryCalls

Factors to multiply containing variable: MaryCalls

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Result of multiplication: 

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Sum out MaryCalls

	   Alarm  prob
	0  False   1.0
	1   True   1.0

New List of Factors: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	   Alarm  prob
	0  False   1.0
	1   True   1.0

Eliminate variable: Earthquake

Factors to multiply containing variable: Earthquake

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake   prob
	2   True       True  0.290
	3  False       True  0.710
	6   True      False  0.001
	7  False      False  0.999

Result of multiplication: 

	  Earthquake  Alarm     prob
	0       True   True  0.00580
	1       True  False  0.01420
	2      False   True  0.00098
	3      False  False  0.97902

Sum out Earthquake

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

New List of Factors: 

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

Eliminate variable: JohnCalls

Factors to multiply containing variable: JohnCalls

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Result of multiplication: 

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Storing factor for backtracking to find value of JohnCalls

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Maximise out JohnCalls

	   Alarm  prob
	0  False  0.95
	1   True  0.90

New List of Factors: 

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

	   Alarm  prob
	0  False  0.95
	1   True  0.90

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm     prob
	0  False  0.99322
	1   True  0.00678

	   Alarm  prob
	0  False  0.95
	1   True  0.90

Result of multiplication: 

	   Alarm      prob
	0  False  0.943559
	1   True  0.006102

Storing factor for backtracking to find value of Alarm

	   Alarm      prob
	0  False  0.943559
	1   True  0.006102

New List of Factors: 

	   Alarm      prob
	0  False  0.943559
	1   True  0.006102

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	   Alarm      prob
	0  False  0.943559
	1   True  0.006102

Finding MAP instantiation for Alarm

MAP assignment for variable Alarm is False

Popped this factor from the backtracking stack:

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Finding MAP instantiation for JohnCalls

MAP assignment for variable JohnCalls is False

Final Map Instantiation:

Alarm->False

JohnCalls->False

Elimination Order: ['Alarm', 'Leaving', 'Fire', 'Report', 'Tampering']

MAP Variables: ['Tampering', 'Report']

Observed Variables: {'Smoke': '1'}

Original Factors: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Factors with evidence applied: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

Result of multiplication: 

	   Fire Alarm Tampering Leaving      prob
	0     0     0         0       0  0.998900
	1     0     0         0       1  0.001000
	2     0     1         0       0  0.000012
	3     0     1         0       1  0.000088
	4     0     0         1       0  0.149850
	5     0     0         1       1  0.000150
	6     0     1         1       0  0.102000
	7     0     1         1       1  0.748000
	8     1     0         0       0  0.009990
	9     1     0         0       1  0.000010
	10    1     1         0       0  0.118800
	11    1     1         0       1  0.871200
	12    1     0         1       0  0.499500
	13    1     0         1       1  0.000500
	14    1     1         1       0  0.060000
	15    1     1         1       1  0.440000

Sum out Alarm

	  Fire Tampering Leaving      prob
	0    0         0       0  0.998912
	1    0         0       1  0.001088
	2    0         1       0  0.251850
	3    0         1       1  0.748150
	4    1         0       0  0.128790
	5    1         0       1  0.871210
	6    1         1       0  0.559500
	7    1         1       1  0.440500

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire Tampering Leaving      prob
	0    0         0       0  0.998912
	1    0         0       1  0.001088
	2    0         1       0  0.251850
	3    0         1       1  0.748150
	4    1         0       0  0.128790
	5    1         0       1  0.871210
	6    1         1       0  0.559500
	7    1         1       1  0.440500

Eliminate variable: Leaving

Factors to multiply containing variable: Leaving

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Fire Tampering Leaving      prob
	0    0         0       0  0.998912
	1    0         0       1  0.001088
	2    0         1       0  0.251850
	3    0         1       1  0.748150
	4    1         0       0  0.128790
	5    1         0       1  0.871210
	6    1         1       0  0.559500
	7    1         1       1  0.440500

Result of multiplication: 

	   Report Fire Tampering Leaving      prob
	0       0    0         0       0  0.988923
	1       0    0         1       0  0.249331
	2       0    1         0       0  0.127502
	3       0    1         1       0  0.553905
	4       1    0         0       0  0.009989
	5       1    0         1       0  0.002518
	6       1    1         0       0  0.001288
	7       1    1         1       0  0.005595
	8       0    0         0       1  0.000272
	9       0    0         1       1  0.187037
	10      0    1         0       1  0.217802
	11      0    1         1       1  0.110125
	12      1    0         0       1  0.000816
	13      1    0         1       1  0.561113
	14      1    1         0       1  0.653407
	15      1    1         1       1  0.330375

Sum out Leaving

	  Report Fire Tampering      prob
	0      0    0         0  0.989195
	1      0    0         1  0.436369
	2      0    1         0  0.345305
	3      0    1         1  0.664030
	4      1    0         0  0.010805
	5      1    0         1  0.563631
	6      1    1         0  0.654695
	7      1    1         1  0.335970

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Report Fire Tampering      prob
	0      0    0         0  0.989195
	1      0    0         1  0.436369
	2      0    1         0  0.345305
	3      0    1         1  0.664030
	4      1    0         0  0.010805
	5      1    0         1  0.563631
	6      1    1         0  0.654695
	7      1    1         1  0.335970

Eliminate variable: Fire

Factors to multiply containing variable: Fire

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Report Fire Tampering      prob
	0      0    0         0  0.989195
	1      0    0         1  0.436369
	2      0    1         0  0.345305
	3      0    1         1  0.664030
	4      1    0         0  0.010805
	5      1    0         1  0.563631
	6      1    1         0  0.654695
	7      1    1         1  0.335970

Result of multiplication: 

	  Report Fire Tampering      prob
	0      0    0         0  0.009793
	1      0    0         1  0.004320
	2      1    0         0  0.000107
	3      1    0         1  0.005580
	4      0    1         0  0.003108
	5      0    1         1  0.005976
	6      1    1         0  0.005892
	7      1    1         1  0.003024

Sum out Fire

	  Report Tampering      prob
	0      0         0  0.012901
	1      0         1  0.010296
	2      1         0  0.005999
	3      1         1  0.008604

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Report Tampering      prob
	0      0         0  0.012901
	1      0         1  0.010296
	2      1         0  0.005999
	3      1         1  0.008604

Eliminate variable: Report

Factors to multiply containing variable: Report

	  Report Tampering      prob
	0      0         0  0.012901
	1      0         1  0.010296
	2      1         0  0.005999
	3      1         1  0.008604

Result of multiplication: 

	  Report Tampering      prob
	0      0         0  0.012901
	1      0         1  0.010296
	2      1         0  0.005999
	3      1         1  0.008604

Storing factor for backtracking to find value of Report

	  Report Tampering      prob
	0      0         0  0.012901
	1      0         1  0.010296
	2      1         0  0.005999
	3      1         1  0.008604

Maximise out Report

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

Eliminate variable: Tampering

Factors to multiply containing variable: Tampering

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

Result of multiplication: 

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Storing factor for backtracking to find value of Tampering

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

New List of Factors: 

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Finding MAP instantiation for Tampering

MAP assignment for variable Tampering is 0

Popped this factor from the backtracking stack:

	  Report Tampering      prob
	0      0         0  0.012901
	1      0         1  0.010296
	2      1         0  0.005999
	3      1         1  0.008604

Finding MAP instantiation for Report

MAP assignment for variable Report is 0

Final Map Instantiation:

Tampering->0

Report->0

Elimination Order: ['Smoke', 'Alarm', 'Leaving', 'Fire', 'Report', 'Tampering']

MAP Variables: ['Tampering', 'Report']

Observed Variables: {}

Original Factors: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Factors with evidence applied: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Eliminate variable: Smoke

Factors to multiply containing variable: Smoke

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

Result of multiplication: 

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

Sum out Smoke

	  Fire  prob
	0    0   1.0
	1    1   1.0

New List of Factors: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire  prob
	0    0   1.0
	1    1   1.0

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

Result of multiplication: 

	   Fire Alarm Tampering Leaving      prob
	0     0     0         0       0  0.998900
	1     0     0         0       1  0.001000
	2     0     1         0       0  0.000012
	3     0     1         0       1  0.000088
	4     0     0         1       0  0.149850
	5     0     0         1       1  0.000150
	6     0     1         1       0  0.102000
	7     0     1         1       1  0.748000
	8     1     0         0       0  0.009990
	9     1     0         0       1  0.000010
	10    1     1         0       0  0.118800
	11    1     1         0       1  0.871200
	12    1     0         1       0  0.499500
	13    1     0         1       1  0.000500
	14    1     1         1       0  0.060000
	15    1     1         1       1  0.440000

Sum out Alarm

	  Fire Tampering Leaving      prob
	0    0         0       0  0.998912
	1    0         0       1  0.001088
	2    0         1       0  0.251850
	3    0         1       1  0.748150
	4    1         0       0  0.128790
	5    1         0       1  0.871210
	6    1         1       0  0.559500
	7    1         1       1  0.440500

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire  prob
	0    0   1.0
	1    1   1.0

	  Fire Tampering Leaving      prob
	0    0         0       0  0.998912
	1    0         0       1  0.001088
	2    0         1       0  0.251850
	3    0         1       1  0.748150
	4    1         0       0  0.128790
	5    1         0       1  0.871210
	6    1         1       0  0.559500
	7    1         1       1  0.440500

Eliminate variable: Leaving

Factors to multiply containing variable: Leaving

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Fire Tampering Leaving      prob
	0    0         0       0  0.998912
	1    0         0       1  0.001088
	2    0         1       0  0.251850
	3    0         1       1  0.748150
	4    1         0       0  0.128790
	5    1         0       1  0.871210
	6    1         1       0  0.559500
	7    1         1       1  0.440500

Result of multiplication: 

	   Report Fire Tampering Leaving      prob
	0       0    0         0       0  0.988923
	1       0    0         1       0  0.249331
	2       0    1         0       0  0.127502
	3       0    1         1       0  0.553905
	4       1    0         0       0  0.009989
	5       1    0         1       0  0.002518
	6       1    1         0       0  0.001288
	7       1    1         1       0  0.005595
	8       0    0         0       1  0.000272
	9       0    0         1       1  0.187037
	10      0    1         0       1  0.217802
	11      0    1         1       1  0.110125
	12      1    0         0       1  0.000816
	13      1    0         1       1  0.561113
	14      1    1         0       1  0.653407
	15      1    1         1       1  0.330375

Sum out Leaving

	  Report Fire Tampering      prob
	0      0    0         0  0.989195
	1      0    0         1  0.436369
	2      0    1         0  0.345305
	3      0    1         1  0.664030
	4      1    0         0  0.010805
	5      1    0         1  0.563631
	6      1    1         0  0.654695
	7      1    1         1  0.335970

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire  prob
	0    0   1.0
	1    1   1.0

	  Report Fire Tampering      prob
	0      0    0         0  0.989195
	1      0    0         1  0.436369
	2      0    1         0  0.345305
	3      0    1         1  0.664030
	4      1    0         0  0.010805
	5      1    0         1  0.563631
	6      1    1         0  0.654695
	7      1    1         1  0.335970

Eliminate variable: Fire

Factors to multiply containing variable: Fire

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	0    0   1.0
	1    1   1.0

	  Report Fire Tampering      prob
	0      0    0         0  0.989195
	1      0    0         1  0.436369
	2      0    1         0  0.345305
	3      0    1         1  0.664030
	4      1    0         0  0.010805
	5      1    0         1  0.563631
	6      1    1         0  0.654695
	7      1    1         1  0.335970

Result of multiplication: 

	  Report Fire Tampering      prob
	0      0    0         0  0.979303
	1      0    0         1  0.432005
	2      1    0         0  0.010697
	3      1    0         1  0.557995
	4      0    1         0  0.003453
	5      0    1         1  0.006640
	6      1    1         0  0.006547
	7      1    1         1  0.003360

Sum out Fire

	  Report Tampering      prob
	0      0         0  0.982756
	1      0         1  0.438646
	2      1         0  0.017244
	3      1         1  0.561354

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Report Tampering      prob
	0      0         0  0.982756
	1      0         1  0.438646
	2      1         0  0.017244
	3      1         1  0.561354

Eliminate variable: Report

Factors to multiply containing variable: Report

	  Report Tampering      prob
	0      0         0  0.982756
	1      0         1  0.438646
	2      1         0  0.017244
	3      1         1  0.561354

Result of multiplication: 

	  Report Tampering      prob
	0      0         0  0.982756
	1      0         1  0.438646
	2      1         0  0.017244
	3      1         1  0.561354

Storing factor for backtracking to find value of Report

	  Report Tampering      prob
	0      0         0  0.982756
	1      0         1  0.438646
	2      1         0  0.017244
	3      1         1  0.561354

Maximise out Report

	  Tampering      prob
	0         0  0.982756
	1         1  0.561354

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.982756
	1         1  0.561354

Eliminate variable: Tampering

Factors to multiply containing variable: Tampering

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.982756
	1         1  0.561354

Result of multiplication: 

	  Tampering      prob
	0         0  0.963101
	1         1  0.011227

Storing factor for backtracking to find value of Tampering

	  Tampering      prob
	0         0  0.963101
	1         1  0.011227

New List of Factors: 

	  Tampering      prob
	0         0  0.963101
	1         1  0.011227

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	  Tampering      prob
	0         0  0.963101
	1         1  0.011227

Finding MAP instantiation for Tampering

MAP assignment for variable Tampering is 0

Popped this factor from the backtracking stack:

	  Report Tampering      prob
	0      0         0  0.982756
	1      0         1  0.438646
	2      1         0  0.017244
	3      1         1  0.561354

Finding MAP instantiation for Report

MAP assignment for variable Report is 0

Final Map Instantiation:

Tampering->0

Report->0

Elimination Order: ['Alarm', 'Leaving', 'Fire', 'Report', 'Tampering']

MAP Variables: ['Tampering', 'Report']

Observed Variables: {'Smoke': '1'}

Original Factors: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Factors with evidence applied: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

Result of multiplication: 

	   Fire Alarm Tampering Leaving      prob
	0     0     0         0       0  0.998900
	1     0     0         0       1  0.001000
	2     0     1         0       0  0.000012
	3     0     1         0       1  0.000088
	4     0     0         1       0  0.149850
	5     0     0         1       1  0.000150
	6     0     1         1       0  0.102000
	7     0     1         1       1  0.748000
	8     1     0         0       0  0.009990
	9     1     0         0       1  0.000010
	10    1     1         0       0  0.118800
	11    1     1         0       1  0.871200
	12    1     0         1       0  0.499500
	13    1     0         1       1  0.000500
	14    1     1         1       0  0.060000
	15    1     1         1       1  0.440000

Sum out Alarm

	  Fire Tampering Leaving      prob
	0    0         0       0  0.998912
	1    0         0       1  0.001088
	2    0         1       0  0.251850
	3    0         1       1  0.748150
	4    1         0       0  0.128790
	5    1         0       1  0.871210
	6    1         1       0  0.559500
	7    1         1       1  0.440500

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire Tampering Leaving      prob
	0    0         0       0  0.998912
	1    0         0       1  0.001088
	2    0         1       0  0.251850
	3    0         1       1  0.748150
	4    1         0       0  0.128790
	5    1         0       1  0.871210
	6    1         1       0  0.559500
	7    1         1       1  0.440500

Eliminate variable: Leaving

Factors to multiply containing variable: Leaving

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Fire Tampering Leaving      prob
	0    0         0       0  0.998912
	1    0         0       1  0.001088
	2    0         1       0  0.251850
	3    0         1       1  0.748150
	4    1         0       0  0.128790
	5    1         0       1  0.871210
	6    1         1       0  0.559500
	7    1         1       1  0.440500

Result of multiplication: 

	   Report Fire Tampering Leaving      prob
	0       0    0         0       0  0.988923
	1       0    0         1       0  0.249331
	2       0    1         0       0  0.127502
	3       0    1         1       0  0.553905
	4       1    0         0       0  0.009989
	5       1    0         1       0  0.002518
	6       1    1         0       0  0.001288
	7       1    1         1       0  0.005595
	8       0    0         0       1  0.000272
	9       0    0         1       1  0.187037
	10      0    1         0       1  0.217802
	11      0    1         1       1  0.110125
	12      1    0         0       1  0.000816
	13      1    0         1       1  0.561113
	14      1    1         0       1  0.653407
	15      1    1         1       1  0.330375

Sum out Leaving

	  Report Fire Tampering      prob
	0      0    0         0  0.989195
	1      0    0         1  0.436369
	2      0    1         0  0.345305
	3      0    1         1  0.664030
	4      1    0         0  0.010805
	5      1    0         1  0.563631
	6      1    1         0  0.654695
	7      1    1         1  0.335970

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Report Fire Tampering      prob
	0      0    0         0  0.989195
	1      0    0         1  0.436369
	2      0    1         0  0.345305
	3      0    1         1  0.664030
	4      1    0         0  0.010805
	5      1    0         1  0.563631
	6      1    1         0  0.654695
	7      1    1         1  0.335970

Eliminate variable: Fire

Factors to multiply containing variable: Fire

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Report Fire Tampering      prob
	0      0    0         0  0.989195
	1      0    0         1  0.436369
	2      0    1         0  0.345305
	3      0    1         1  0.664030
	4      1    0         0  0.010805
	5      1    0         1  0.563631
	6      1    1         0  0.654695
	7      1    1         1  0.335970

Result of multiplication: 

	  Report Fire Tampering      prob
	0      0    0         0  0.009793
	1      0    0         1  0.004320
	2      1    0         0  0.000107
	3      1    0         1  0.005580
	4      0    1         0  0.003108
	5      0    1         1  0.005976
	6      1    1         0  0.005892
	7      1    1         1  0.003024

Sum out Fire

	  Report Tampering      prob
	0      0         0  0.012901
	1      0         1  0.010296
	2      1         0  0.005999
	3      1         1  0.008604

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Report Tampering      prob
	0      0         0  0.012901
	1      0         1  0.010296
	2      1         0  0.005999
	3      1         1  0.008604

Eliminate variable: Report

Factors to multiply containing variable: Report

	  Report Tampering      prob
	0      0         0  0.012901
	1      0         1  0.010296
	2      1         0  0.005999
	3      1         1  0.008604

Result of multiplication: 

	  Report Tampering      prob
	0      0         0  0.012901
	1      0         1  0.010296
	2      1         0  0.005999
	3      1         1  0.008604

Storing factor for backtracking to find value of Report

	  Report Tampering      prob
	0      0         0  0.012901
	1      0         1  0.010296
	2      1         0  0.005999
	3      1         1  0.008604

Maximise out Report

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

Eliminate variable: Tampering

Factors to multiply containing variable: Tampering

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

Result of multiplication: 

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Storing factor for backtracking to find value of Tampering

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

New List of Factors: 

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Finding MAP instantiation for Tampering

MAP assignment for variable Tampering is 0

Popped this factor from the backtracking stack:

	  Report Tampering      prob
	0      0         0  0.012901
	1      0         1  0.010296
	2      1         0  0.005999
	3      1         1  0.008604

Finding MAP instantiation for Report

MAP assignment for variable Report is 0

Final Map Instantiation:

Tampering->0

Report->0

Elimination Order: ['JohnCalls', 'MaryCalls', 'Earthquake', 'Alarm']

MAP Variables: ['Alarm']

Observed Variables: {'Burglary': 'True'}

Original Factors: 

	  Burglary  prob
	0     True  0.01
	1    False  0.99

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Burglary Earthquake   prob
	0   True     True       True  0.950
	1  False     True       True  0.050
	2   True    False       True  0.290
	3  False    False       True  0.710
	4   True     True      False  0.940
	5  False     True      False  0.060
	6   True    False      False  0.001
	7  False    False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Factors with evidence applied: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Eliminate variable: JohnCalls

Factors to multiply containing variable: JohnCalls

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Result of multiplication: 

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Sum out JohnCalls

	   Alarm  prob
	0  False   1.0
	1   True   1.0

New List of Factors: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

	   Alarm  prob
	0  False   1.0
	1   True   1.0

Eliminate variable: MaryCalls

Factors to multiply containing variable: MaryCalls

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Result of multiplication: 

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Sum out MaryCalls

	   Alarm  prob
	0  False   1.0
	1   True   1.0

New List of Factors: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

Eliminate variable: Earthquake

Factors to multiply containing variable: Earthquake

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

Result of multiplication: 

	  Earthquake  Alarm    prob
	0       True   True  0.0190
	1       True  False  0.0010
	2      False   True  0.9212
	3      False  False  0.0588

Sum out Earthquake

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

New List of Factors: 

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Result of multiplication: 

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Storing factor for backtracking to find value of Alarm

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

New List of Factors: 

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Finding MAP instantiation for Alarm

MAP assignment for variable Alarm is True

Final Map Instantiation:

Alarm->True

Elimination Order: ['JohnCalls', 'MaryCalls', 'Alarm']

MAP Variables: ['Alarm', 'JohnCalls', 'MaryCalls']

Observed Variables: {'Burglary': 'False', 'Earthquake': 'True'}

Original Factors: 

	  Burglary  prob
	0     True  0.01
	1    False  0.99

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Burglary Earthquake   prob
	0   True     True       True  0.950
	1  False     True       True  0.050
	2   True    False       True  0.290
	3  False    False       True  0.710
	4   True     True      False  0.940
	5  False     True      False  0.060
	6   True    False      False  0.001
	7  False    False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Factors with evidence applied: 

	   Alarm  prob
	2   True  0.29
	3  False  0.71

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Eliminate variable: JohnCalls

Factors to multiply containing variable: JohnCalls

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Result of multiplication: 

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Storing factor for backtracking to find value of JohnCalls

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Maximise out JohnCalls

	   Alarm  prob
	0  False  0.95
	1   True  0.90

New List of Factors: 

	   Alarm  prob
	2   True  0.29
	3  False  0.71

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

	   Alarm  prob
	0  False  0.95
	1   True  0.90

Eliminate variable: MaryCalls

Factors to multiply containing variable: MaryCalls

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Result of multiplication: 

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Storing factor for backtracking to find value of MaryCalls

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Maximise out MaryCalls

	   Alarm  prob
	0  False  0.99
	1   True  0.70

New List of Factors: 

	   Alarm  prob
	2   True  0.29
	3  False  0.71

	   Alarm  prob
	0  False  0.95
	1   True  0.90

	   Alarm  prob
	0  False  0.99
	1   True  0.70

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	   Alarm  prob
	2   True  0.29
	3  False  0.71

	   Alarm  prob
	0  False  0.95
	1   True  0.90

	   Alarm  prob
	0  False  0.99
	1   True  0.70

Result of multiplication: 

	   Alarm      prob
	0   True  0.182700
	1  False  0.667755

Storing factor for backtracking to find value of Alarm

	   Alarm      prob
	0   True  0.182700
	1  False  0.667755

New List of Factors: 

	   Alarm      prob
	0   True  0.182700
	1  False  0.667755

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	   Alarm      prob
	0   True  0.182700
	1  False  0.667755

Finding MAP instantiation for Alarm

MAP assignment for variable Alarm is False

Popped this factor from the backtracking stack:

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Finding MAP instantiation for MaryCalls

MAP assignment for variable MaryCalls is False

Popped this factor from the backtracking stack:

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Finding MAP instantiation for JohnCalls

MAP assignment for variable JohnCalls is False

Final Map Instantiation:

Alarm->False

MaryCalls->False

JohnCalls->False

Elimination Order: ['Alarm', 'Leaving', 'Fire', 'Report', 'Tampering']

MAP Variables: ['Tampering', 'Report']

Observed Variables: {'Smoke': '1'}

Original Factors: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Factors with evidence applied: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

Result of multiplication: 

	   Alarm Tampering Fire Leaving      prob
	0      0         0    0       0  0.998900
	1      0         0    0       1  0.001000
	2      1         0    0       0  0.000012
	3      1         0    0       1  0.000088
	4      0         1    0       0  0.149850
	5      0         1    0       1  0.000150
	6      1         1    0       0  0.102000
	7      1         1    0       1  0.748000
	8      0         0    1       0  0.009990
	9      0         0    1       1  0.000010
	10     1         0    1       0  0.118800
	11     1         0    1       1  0.871200
	12     0         1    1       0  0.499500
	13     0         1    1       1  0.000500
	14     1         1    1       0  0.060000
	15     1         1    1       1  0.440000

Sum out Alarm

	  Tampering Fire Leaving      prob
	0         0    0       0  0.998912
	1         0    0       1  0.001088
	2         0    1       0  0.128790
	3         0    1       1  0.871210
	4         1    0       0  0.251850
	5         1    0       1  0.748150
	6         1    1       0  0.559500
	7         1    1       1  0.440500

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering Fire Leaving      prob
	0         0    0       0  0.998912
	1         0    0       1  0.001088
	2         0    1       0  0.128790
	3         0    1       1  0.871210
	4         1    0       0  0.251850
	5         1    0       1  0.748150
	6         1    1       0  0.559500
	7         1    1       1  0.440500

Eliminate variable: Leaving

Factors to multiply containing variable: Leaving

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Tampering Fire Leaving      prob
	0         0    0       0  0.998912
	1         0    0       1  0.001088
	2         0    1       0  0.128790
	3         0    1       1  0.871210
	4         1    0       0  0.251850
	5         1    0       1  0.748150
	6         1    1       0  0.559500
	7         1    1       1  0.440500

Result of multiplication: 

	   Tampering Fire Leaving Report      prob
	0          0    0       0      0  0.988923
	1          0    1       0      0  0.127502
	2          1    0       0      0  0.249331
	3          1    1       0      0  0.553905
	4          0    0       0      1  0.009989
	5          0    1       0      1  0.001288
	6          1    0       0      1  0.002518
	7          1    1       0      1  0.005595
	8          0    0       1      0  0.000272
	9          0    1       1      0  0.217802
	10         1    0       1      0  0.187037
	11         1    1       1      0  0.110125
	12         0    0       1      1  0.000816
	13         0    1       1      1  0.653407
	14         1    0       1      1  0.561113
	15         1    1       1      1  0.330375

Sum out Leaving

	  Tampering Fire Report      prob
	0         0    0      0  0.989195
	1         0    0      1  0.010805
	2         0    1      0  0.345305
	3         0    1      1  0.654695
	4         1    0      0  0.436369
	5         1    0      1  0.563631
	6         1    1      0  0.664030
	7         1    1      1  0.335970

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering Fire Report      prob
	0         0    0      0  0.989195
	1         0    0      1  0.010805
	2         0    1      0  0.345305
	3         0    1      1  0.654695
	4         1    0      0  0.436369
	5         1    0      1  0.563631
	6         1    1      0  0.664030
	7         1    1      1  0.335970

Eliminate variable: Fire

Factors to multiply containing variable: Fire

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering Fire Report      prob
	0         0    0      0  0.989195
	1         0    0      1  0.010805
	2         0    1      0  0.345305
	3         0    1      1  0.654695
	4         1    0      0  0.436369
	5         1    0      1  0.563631
	6         1    1      0  0.664030
	7         1    1      1  0.335970

Result of multiplication: 

	  Tampering Fire Report      prob
	0         0    0      0  0.009793
	1         0    0      1  0.000107
	2         1    0      0  0.004320
	3         1    0      1  0.005580
	4         0    1      0  0.003108
	5         0    1      1  0.005892
	6         1    1      0  0.005976
	7         1    1      1  0.003024

Sum out Fire

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Eliminate variable: Report

Factors to multiply containing variable: Report

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Result of multiplication: 

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Storing factor for backtracking to find value of Report

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Maximise out Report

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

Eliminate variable: Tampering

Factors to multiply containing variable: Tampering

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

Result of multiplication: 

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Storing factor for backtracking to find value of Tampering

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

New List of Factors: 

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Finding MAP instantiation for Tampering

MAP assignment for variable Tampering is 0

Popped this factor from the backtracking stack:

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Finding MAP instantiation for Report

MAP assignment for variable Report is 0

Final Map Instantiation:

Tampering->0

Report->0

Elimination Order: ['Smoke', 'Alarm', 'Leaving', 'Fire', 'Report', 'Tampering']

MAP Variables: ['Tampering', 'Report']

Observed Variables: {}

Original Factors: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Factors with evidence applied: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Eliminate variable: Smoke

Factors to multiply containing variable: Smoke

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

Result of multiplication: 

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

Sum out Smoke

	  Fire  prob
	0    0   1.0
	1    1   1.0

New List of Factors: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire  prob
	0    0   1.0
	1    1   1.0

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

Result of multiplication: 

	   Alarm Tampering Fire Leaving      prob
	0      0         0    0       0  0.998900
	1      0         0    0       1  0.001000
	2      1         0    0       0  0.000012
	3      1         0    0       1  0.000088
	4      0         1    0       0  0.149850
	5      0         1    0       1  0.000150
	6      1         1    0       0  0.102000
	7      1         1    0       1  0.748000
	8      0         0    1       0  0.009990
	9      0         0    1       1  0.000010
	10     1         0    1       0  0.118800
	11     1         0    1       1  0.871200
	12     0         1    1       0  0.499500
	13     0         1    1       1  0.000500
	14     1         1    1       0  0.060000
	15     1         1    1       1  0.440000

Sum out Alarm

	  Tampering Fire Leaving      prob
	0         0    0       0  0.998912
	1         0    0       1  0.001088
	2         0    1       0  0.128790
	3         0    1       1  0.871210
	4         1    0       0  0.251850
	5         1    0       1  0.748150
	6         1    1       0  0.559500
	7         1    1       1  0.440500

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire  prob
	0    0   1.0
	1    1   1.0

	  Tampering Fire Leaving      prob
	0         0    0       0  0.998912
	1         0    0       1  0.001088
	2         0    1       0  0.128790
	3         0    1       1  0.871210
	4         1    0       0  0.251850
	5         1    0       1  0.748150
	6         1    1       0  0.559500
	7         1    1       1  0.440500

Eliminate variable: Leaving

Factors to multiply containing variable: Leaving

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Tampering Fire Leaving      prob
	0         0    0       0  0.998912
	1         0    0       1  0.001088
	2         0    1       0  0.128790
	3         0    1       1  0.871210
	4         1    0       0  0.251850
	5         1    0       1  0.748150
	6         1    1       0  0.559500
	7         1    1       1  0.440500

Result of multiplication: 

	   Tampering Fire Leaving Report      prob
	0          0    0       0      0  0.988923
	1          0    1       0      0  0.127502
	2          1    0       0      0  0.249331
	3          1    1       0      0  0.553905
	4          0    0       0      1  0.009989
	5          0    1       0      1  0.001288
	6          1    0       0      1  0.002518
	7          1    1       0      1  0.005595
	8          0    0       1      0  0.000272
	9          0    1       1      0  0.217802
	10         1    0       1      0  0.187037
	11         1    1       1      0  0.110125
	12         0    0       1      1  0.000816
	13         0    1       1      1  0.653407
	14         1    0       1      1  0.561113
	15         1    1       1      1  0.330375

Sum out Leaving

	  Tampering Fire Report      prob
	0         0    0      0  0.989195
	1         0    0      1  0.010805
	2         0    1      0  0.345305
	3         0    1      1  0.654695
	4         1    0      0  0.436369
	5         1    0      1  0.563631
	6         1    1      0  0.664030
	7         1    1      1  0.335970

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Fire  prob
	0    0   1.0
	1    1   1.0

	  Tampering Fire Report      prob
	0         0    0      0  0.989195
	1         0    0      1  0.010805
	2         0    1      0  0.345305
	3         0    1      1  0.654695
	4         1    0      0  0.436369
	5         1    0      1  0.563631
	6         1    1      0  0.664030
	7         1    1      1  0.335970

Eliminate variable: Fire

Factors to multiply containing variable: Fire

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	0    0   1.0
	1    1   1.0

	  Tampering Fire Report      prob
	0         0    0      0  0.989195
	1         0    0      1  0.010805
	2         0    1      0  0.345305
	3         0    1      1  0.654695
	4         1    0      0  0.436369
	5         1    0      1  0.563631
	6         1    1      0  0.664030
	7         1    1      1  0.335970

Result of multiplication: 

	  Tampering Fire Report      prob
	0         0    0      0  0.979303
	1         0    0      1  0.010697
	2         1    0      0  0.432005
	3         1    0      1  0.557995
	4         0    1      0  0.003453
	5         0    1      1  0.006547
	6         1    1      0  0.006640
	7         1    1      1  0.003360

Sum out Fire

	  Tampering Report      prob
	0         0      0  0.982756
	1         0      1  0.017244
	2         1      0  0.438646
	3         1      1  0.561354

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering Report      prob
	0         0      0  0.982756
	1         0      1  0.017244
	2         1      0  0.438646
	3         1      1  0.561354

Eliminate variable: Report

Factors to multiply containing variable: Report

	  Tampering Report      prob
	0         0      0  0.982756
	1         0      1  0.017244
	2         1      0  0.438646
	3         1      1  0.561354

Result of multiplication: 

	  Tampering Report      prob
	0         0      0  0.982756
	1         0      1  0.017244
	2         1      0  0.438646
	3         1      1  0.561354

Storing factor for backtracking to find value of Report

	  Tampering Report      prob
	0         0      0  0.982756
	1         0      1  0.017244
	2         1      0  0.438646
	3         1      1  0.561354

Maximise out Report

	  Tampering      prob
	0         0  0.982756
	1         1  0.561354

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.982756
	1         1  0.561354

Eliminate variable: Tampering

Factors to multiply containing variable: Tampering

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.982756
	1         1  0.561354

Result of multiplication: 

	  Tampering      prob
	0         0  0.963101
	1         1  0.011227

Storing factor for backtracking to find value of Tampering

	  Tampering      prob
	0         0  0.963101
	1         1  0.011227

New List of Factors: 

	  Tampering      prob
	0         0  0.963101
	1         1  0.011227

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	  Tampering      prob
	0         0  0.963101
	1         1  0.011227

Finding MAP instantiation for Tampering

MAP assignment for variable Tampering is 0

Popped this factor from the backtracking stack:

	  Tampering Report      prob
	0         0      0  0.982756
	1         0      1  0.017244
	2         1      0  0.438646
	3         1      1  0.561354

Finding MAP instantiation for Report

MAP assignment for variable Report is 0

Final Map Instantiation:

Tampering->0

Report->0

Elimination Order: ['Alarm', 'Leaving', 'Fire', 'Report', 'Tampering']

MAP Variables: ['Tampering', 'Report']

Observed Variables: {'Smoke': '1'}

Original Factors: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Smoke Fire  prob
	0     0    0  0.99
	1     1    0  0.01
	2     0    1  0.10
	3     1    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Factors with evidence applied: 

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	  Alarm Tampering Fire    prob
	0     0         0    0  0.9999
	1     1         0    0  0.0001
	2     0         1    0  0.1500
	3     1         1    0  0.8500
	4     0         0    1  0.0100
	5     1         0    1  0.9900
	6     0         1    1  0.5000
	7     1         1    1  0.5000

	  Leaving Alarm   prob
	0       0     0  0.999
	1       1     0  0.001
	2       0     1  0.120
	3       1     1  0.880

Result of multiplication: 

	   Alarm Tampering Fire Leaving      prob
	0      0         0    0       0  0.998900
	1      0         0    0       1  0.001000
	2      1         0    0       0  0.000012
	3      1         0    0       1  0.000088
	4      0         1    0       0  0.149850
	5      0         1    0       1  0.000150
	6      1         1    0       0  0.102000
	7      1         1    0       1  0.748000
	8      0         0    1       0  0.009990
	9      0         0    1       1  0.000010
	10     1         0    1       0  0.118800
	11     1         0    1       1  0.871200
	12     0         1    1       0  0.499500
	13     0         1    1       1  0.000500
	14     1         1    1       0  0.060000
	15     1         1    1       1  0.440000

Sum out Alarm

	  Tampering Fire Leaving      prob
	0         0    0       0  0.998912
	1         0    0       1  0.001088
	2         0    1       0  0.128790
	3         0    1       1  0.871210
	4         1    0       0  0.251850
	5         1    0       1  0.748150
	6         1    1       0  0.559500
	7         1    1       1  0.440500

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering Fire Leaving      prob
	0         0    0       0  0.998912
	1         0    0       1  0.001088
	2         0    1       0  0.128790
	3         0    1       1  0.871210
	4         1    0       0  0.251850
	5         1    0       1  0.748150
	6         1    1       0  0.559500
	7         1    1       1  0.440500

Eliminate variable: Leaving

Factors to multiply containing variable: Leaving

	  Report Leaving  prob
	0      0       0  0.99
	1      1       0  0.01
	2      0       1  0.25
	3      1       1  0.75

	  Tampering Fire Leaving      prob
	0         0    0       0  0.998912
	1         0    0       1  0.001088
	2         0    1       0  0.128790
	3         0    1       1  0.871210
	4         1    0       0  0.251850
	5         1    0       1  0.748150
	6         1    1       0  0.559500
	7         1    1       1  0.440500

Result of multiplication: 

	   Tampering Fire Leaving Report      prob
	0          0    0       0      0  0.988923
	1          0    1       0      0  0.127502
	2          1    0       0      0  0.249331
	3          1    1       0      0  0.553905
	4          0    0       0      1  0.009989
	5          0    1       0      1  0.001288
	6          1    0       0      1  0.002518
	7          1    1       0      1  0.005595
	8          0    0       1      0  0.000272
	9          0    1       1      0  0.217802
	10         1    0       1      0  0.187037
	11         1    1       1      0  0.110125
	12         0    0       1      1  0.000816
	13         0    1       1      1  0.653407
	14         1    0       1      1  0.561113
	15         1    1       1      1  0.330375

Sum out Leaving

	  Tampering Fire Report      prob
	0         0    0      0  0.989195
	1         0    0      1  0.010805
	2         0    1      0  0.345305
	3         0    1      1  0.654695
	4         1    0      0  0.436369
	5         1    0      1  0.563631
	6         1    1      0  0.664030
	7         1    1      1  0.335970

New List of Factors: 

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering Fire Report      prob
	0         0    0      0  0.989195
	1         0    0      1  0.010805
	2         0    1      0  0.345305
	3         0    1      1  0.654695
	4         1    0      0  0.436369
	5         1    0      1  0.563631
	6         1    1      0  0.664030
	7         1    1      1  0.335970

Eliminate variable: Fire

Factors to multiply containing variable: Fire

	  Fire  prob
	0    0  0.99
	1    1  0.01

	  Fire  prob
	1    0  0.01
	3    1  0.90

	  Tampering Fire Report      prob
	0         0    0      0  0.989195
	1         0    0      1  0.010805
	2         0    1      0  0.345305
	3         0    1      1  0.654695
	4         1    0      0  0.436369
	5         1    0      1  0.563631
	6         1    1      0  0.664030
	7         1    1      1  0.335970

Result of multiplication: 

	  Tampering Fire Report      prob
	0         0    0      0  0.009793
	1         0    0      1  0.000107
	2         1    0      0  0.004320
	3         1    0      1  0.005580
	4         0    1      0  0.003108
	5         0    1      1  0.005892
	6         1    1      0  0.005976
	7         1    1      1  0.003024

Sum out Fire

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Eliminate variable: Report

Factors to multiply containing variable: Report

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Result of multiplication: 

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Storing factor for backtracking to find value of Report

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Maximise out Report

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

New List of Factors: 

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

Eliminate variable: Tampering

Factors to multiply containing variable: Tampering

	  Tampering  prob
	0         0  0.98
	1         1  0.02

	  Tampering      prob
	0         0  0.012901
	1         1  0.010296

Result of multiplication: 

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Storing factor for backtracking to find value of Tampering

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

New List of Factors: 

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	  Tampering      prob
	0         0  0.012643
	1         1  0.000206

Finding MAP instantiation for Tampering

MAP assignment for variable Tampering is 0

Popped this factor from the backtracking stack:

	  Tampering Report      prob
	0         0      0  0.012901
	1         0      1  0.005999
	2         1      0  0.010296
	3         1      1  0.008604

Finding MAP instantiation for Report

MAP assignment for variable Report is 0

Final Map Instantiation:

Tampering->0

Report->0

Elimination Order: ['JohnCalls', 'MaryCalls', 'Earthquake', 'Alarm']

MAP Variables: ['Alarm']

Observed Variables: {'Burglary': 'True'}

Original Factors: 

	  Burglary  prob
	0     True  0.01
	1    False  0.99

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Burglary Earthquake   prob
	0   True     True       True  0.950
	1  False     True       True  0.050
	2   True    False       True  0.290
	3  False    False       True  0.710
	4   True     True      False  0.940
	5  False     True      False  0.060
	6   True    False      False  0.001
	7  False    False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Factors with evidence applied: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Eliminate variable: JohnCalls

Factors to multiply containing variable: JohnCalls

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Result of multiplication: 

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Sum out JohnCalls

	   Alarm  prob
	0  False   1.0
	1   True   1.0

New List of Factors: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

	   Alarm  prob
	0  False   1.0
	1   True   1.0

Eliminate variable: MaryCalls

Factors to multiply containing variable: MaryCalls

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Result of multiplication: 

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Sum out MaryCalls

	   Alarm  prob
	0  False   1.0
	1   True   1.0

New List of Factors: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

Eliminate variable: Earthquake

Factors to multiply containing variable: Earthquake

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake  prob
	0   True       True  0.95
	1  False       True  0.05
	4   True      False  0.94
	5  False      False  0.06

Result of multiplication: 

	   Alarm Earthquake    prob
	0   True       True  0.0190
	1  False       True  0.0010
	2   True      False  0.9212
	3  False      False  0.0588

Sum out Earthquake

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

New List of Factors: 

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Result of multiplication: 

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Storing factor for backtracking to find value of Alarm

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

New List of Factors: 

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	   Alarm    prob
	0  False  0.0598
	1   True  0.9402

Finding MAP instantiation for Alarm

MAP assignment for variable Alarm is True

Final Map Instantiation:

Alarm->True

Elimination Order: ['JohnCalls', 'MaryCalls', 'Alarm']

MAP Variables: ['Alarm', 'JohnCalls', 'MaryCalls']

Observed Variables: {'Burglary': 'False', 'Earthquake': 'True'}

Original Factors: 

	  Burglary  prob
	0     True  0.01
	1    False  0.99

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Burglary Earthquake   prob
	0   True     True       True  0.950
	1  False     True       True  0.050
	2   True    False       True  0.290
	3  False    False       True  0.710
	4   True     True      False  0.940
	5  False     True      False  0.060
	6   True    False      False  0.001
	7  False    False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Factors with evidence applied: 

	   Alarm  prob
	2   True  0.29
	3  False  0.71

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Eliminate variable: JohnCalls

Factors to multiply containing variable: JohnCalls

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Result of multiplication: 

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Storing factor for backtracking to find value of JohnCalls

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Maximise out JohnCalls

	   Alarm  prob
	0  False  0.95
	1   True  0.90

New List of Factors: 

	   Alarm  prob
	2   True  0.29
	3  False  0.71

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

	   Alarm  prob
	0  False  0.95
	1   True  0.90

Eliminate variable: MaryCalls

Factors to multiply containing variable: MaryCalls

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Result of multiplication: 

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Storing factor for backtracking to find value of MaryCalls

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Maximise out MaryCalls

	   Alarm  prob
	0  False  0.99
	1   True  0.70

New List of Factors: 

	   Alarm  prob
	2   True  0.29
	3  False  0.71

	   Alarm  prob
	0  False  0.95
	1   True  0.90

	   Alarm  prob
	0  False  0.99
	1   True  0.70

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	   Alarm  prob
	2   True  0.29
	3  False  0.71

	   Alarm  prob
	0  False  0.95
	1   True  0.90

	   Alarm  prob
	0  False  0.99
	1   True  0.70

Result of multiplication: 

	   Alarm      prob
	0   True  0.182700
	1  False  0.667755

Storing factor for backtracking to find value of Alarm

	   Alarm      prob
	0   True  0.182700
	1  False  0.667755

New List of Factors: 

	   Alarm      prob
	0   True  0.182700
	1  False  0.667755

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	   Alarm      prob
	0   True  0.182700
	1  False  0.667755

Finding MAP instantiation for Alarm

MAP assignment for variable Alarm is False

Popped this factor from the backtracking stack:

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Finding MAP instantiation for MaryCalls

MAP assignment for variable MaryCalls is False

Popped this factor from the backtracking stack:

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Finding MAP instantiation for JohnCalls

MAP assignment for variable JohnCalls is False

Final Map Instantiation:

Alarm->False

MaryCalls->False

JohnCalls->False

Elimination Order: ['Burglary', 'Earthquake', 'JohnCalls', 'MaryCalls', 'Alarm']

MAP Variables: ['Alarm', 'JohnCalls', 'MaryCalls']

Observed Variables: {}

Original Factors: 

	  Burglary  prob
	0     True  0.01
	1    False  0.99

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Burglary Earthquake   prob
	0   True     True       True  0.950
	1  False     True       True  0.050
	2   True    False       True  0.290
	3  False    False       True  0.710
	4   True     True      False  0.940
	5  False     True      False  0.060
	6   True    False      False  0.001
	7  False    False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Factors with evidence applied: 

	  Burglary  prob
	0     True  0.01
	1    False  0.99

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Burglary Earthquake   prob
	0   True     True       True  0.950
	1  False     True       True  0.050
	2   True    False       True  0.290
	3  False    False       True  0.710
	4   True     True      False  0.940
	5  False     True      False  0.060
	6   True    False      False  0.001
	7  False    False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Eliminate variable: Burglary

Factors to multiply containing variable: Burglary

	  Burglary  prob
	0     True  0.01
	1    False  0.99

	   Alarm Burglary Earthquake   prob
	0   True     True       True  0.950
	1  False     True       True  0.050
	2   True    False       True  0.290
	3  False    False       True  0.710
	4   True     True      False  0.940
	5  False     True      False  0.060
	6   True    False      False  0.001
	7  False    False      False  0.999

Result of multiplication: 

	   Alarm Burglary Earthquake     prob
	0   True     True       True  0.00950
	1  False     True       True  0.00050
	2   True     True      False  0.00940
	3  False     True      False  0.00060
	4   True    False       True  0.28710
	5  False    False       True  0.70290
	6   True    False      False  0.00099
	7  False    False      False  0.98901

Sum out Burglary

	   Alarm Earthquake     prob
	0  False      False  0.98961
	1  False       True  0.70340
	2   True      False  0.01039
	3   True       True  0.29660

New List of Factors: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

	   Alarm Earthquake     prob
	0  False      False  0.98961
	1  False       True  0.70340
	2   True      False  0.01039
	3   True       True  0.29660

Eliminate variable: Earthquake

Factors to multiply containing variable: Earthquake

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake     prob
	0  False      False  0.98961
	1  False       True  0.70340
	2   True      False  0.01039
	3   True       True  0.29660

Result of multiplication: 

	   Alarm Earthquake      prob
	0  False       True  0.014068
	1   True       True  0.005932
	2  False      False  0.969818
	3   True      False  0.010182

Sum out Earthquake

	   Alarm      prob
	0  False  0.983886
	1   True  0.016114

New List of Factors: 

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

	   Alarm      prob
	0  False  0.983886
	1   True  0.016114

Eliminate variable: JohnCalls

Factors to multiply containing variable: JohnCalls

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Result of multiplication: 

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Storing factor for backtracking to find value of JohnCalls

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Maximise out JohnCalls

	   Alarm  prob
	0  False  0.95
	1   True  0.90

New List of Factors: 

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

	   Alarm      prob
	0  False  0.983886
	1   True  0.016114

	   Alarm  prob
	0  False  0.95
	1   True  0.90

Eliminate variable: MaryCalls

Factors to multiply containing variable: MaryCalls

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Result of multiplication: 

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Storing factor for backtracking to find value of MaryCalls

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Maximise out MaryCalls

	   Alarm  prob
	0  False  0.99
	1   True  0.70

New List of Factors: 

	   Alarm      prob
	0  False  0.983886
	1   True  0.016114

	   Alarm  prob
	0  False  0.95
	1   True  0.90

	   Alarm  prob
	0  False  0.99
	1   True  0.70

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	   Alarm      prob
	0  False  0.983886
	1   True  0.016114

	   Alarm  prob
	0  False  0.95
	1   True  0.90

	   Alarm  prob
	0  False  0.99
	1   True  0.70

Result of multiplication: 

	   Alarm      prob
	0  False  0.925345
	1   True  0.010152

Storing factor for backtracking to find value of Alarm

	   Alarm      prob
	0  False  0.925345
	1   True  0.010152

New List of Factors: 

	   Alarm      prob
	0  False  0.925345
	1   True  0.010152

Finished marginalizing/maximising variables. Start backtracking to find variable instantiations.

Popped this factor from the backtracking stack:

	   Alarm      prob
	0  False  0.925345
	1   True  0.010152

Finding MAP instantiation for Alarm

MAP assignment for variable Alarm is False

Popped this factor from the backtracking stack:

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Finding MAP instantiation for MaryCalls

MAP assignment for variable MaryCalls is False

Popped this factor from the backtracking stack:

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Finding MAP instantiation for JohnCalls

MAP assignment for variable JohnCalls is False

Final Map Instantiation:

Alarm->False

MaryCalls->False

JohnCalls->False

Elimination Order: ['JohnCalls', 'MaryCalls', 'Alarm']

MAP Variables: []

Observed Variables: {'Burglary': 'False', 'Earthquake': 'True'}

Original Factors: 

	  Burglary  prob
	0     True  0.01
	1    False  0.99

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Burglary Earthquake   prob
	0   True     True       True  0.950
	1  False     True       True  0.050
	2   True    False       True  0.290
	3  False    False       True  0.710
	4   True     True      False  0.940
	5  False     True      False  0.060
	6   True    False      False  0.001
	7  False    False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Factors with evidence applied: 

	   Alarm  prob
	2   True  0.29
	3  False  0.71

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Eliminate variable: JohnCalls

Factors to multiply containing variable: JohnCalls

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Result of multiplication: 

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Sum out JohnCalls

	   Alarm  prob
	0  False   1.0
	1   True   1.0

New List of Factors: 

	   Alarm  prob
	2   True  0.29
	3  False  0.71

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

	   Alarm  prob
	0  False   1.0
	1   True   1.0

Eliminate variable: MaryCalls

Factors to multiply containing variable: MaryCalls

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Result of multiplication: 

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Sum out MaryCalls

	   Alarm  prob
	0  False   1.0
	1   True   1.0

New List of Factors: 

	   Alarm  prob
	2   True  0.29
	3  False  0.71

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	   Alarm  prob
	2   True  0.29
	3  False  0.71

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

Result of multiplication: 

	   Alarm  prob
	0   True  0.29
	1  False  0.71

Elimination Order: ['JohnCalls', 'MaryCalls', 'Burglary', 'Earthquake', 'Alarm']

MAP Variables: []

Observed Variables: {}

Original Factors: 

	  Burglary  prob
	0     True  0.01
	1    False  0.99

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Burglary Earthquake   prob
	0   True     True       True  0.950
	1  False     True       True  0.050
	2   True    False       True  0.290
	3  False    False       True  0.710
	4   True     True      False  0.940
	5  False     True      False  0.060
	6   True    False      False  0.001
	7  False    False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Factors with evidence applied: 

	  Burglary  prob
	0     True  0.01
	1    False  0.99

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Burglary Earthquake   prob
	0   True     True       True  0.950
	1  False     True       True  0.050
	2   True    False       True  0.290
	3  False    False       True  0.710
	4   True     True      False  0.940
	5  False     True      False  0.060
	6   True    False      False  0.001
	7  False    False      False  0.999

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Eliminate variable: JohnCalls

Factors to multiply containing variable: JohnCalls

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Result of multiplication: 

	  JohnCalls  Alarm  prob
	0      True   True  0.90
	1     False   True  0.10
	2      True  False  0.05
	3     False  False  0.95

Sum out JohnCalls

	   Alarm  prob
	0  False   1.0
	1   True   1.0

New List of Factors: 

	  Burglary  prob
	0     True  0.01
	1    False  0.99

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Burglary Earthquake   prob
	0   True     True       True  0.950
	1  False     True       True  0.050
	2   True    False       True  0.290
	3  False    False       True  0.710
	4   True     True      False  0.940
	5  False     True      False  0.060
	6   True    False      False  0.001
	7  False    False      False  0.999

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

	   Alarm  prob
	0  False   1.0
	1   True   1.0

Eliminate variable: MaryCalls

Factors to multiply containing variable: MaryCalls

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Result of multiplication: 

	  MaryCalls  Alarm  prob
	0      True   True  0.70
	1     False   True  0.30
	2      True  False  0.01
	3     False  False  0.99

Sum out MaryCalls

	   Alarm  prob
	0  False   1.0
	1   True   1.0

New List of Factors: 

	  Burglary  prob
	0     True  0.01
	1    False  0.99

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Burglary Earthquake   prob
	0   True     True       True  0.950
	1  False     True       True  0.050
	2   True    False       True  0.290
	3  False    False       True  0.710
	4   True     True      False  0.940
	5  False     True      False  0.060
	6   True    False      False  0.001
	7  False    False      False  0.999

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

Eliminate variable: Burglary

Factors to multiply containing variable: Burglary

	  Burglary  prob
	0     True  0.01
	1    False  0.99

	   Alarm Burglary Earthquake   prob
	0   True     True       True  0.950
	1  False     True       True  0.050
	2   True    False       True  0.290
	3  False    False       True  0.710
	4   True     True      False  0.940
	5  False     True      False  0.060
	6   True    False      False  0.001
	7  False    False      False  0.999

Result of multiplication: 

	   Alarm Burglary Earthquake     prob
	0   True     True       True  0.00950
	1  False     True       True  0.00050
	2   True     True      False  0.00940
	3  False     True      False  0.00060
	4   True    False       True  0.28710
	5  False    False       True  0.70290
	6   True    False      False  0.00099
	7  False    False      False  0.98901

Sum out Burglary

	   Alarm Earthquake     prob
	0  False      False  0.98961
	1  False       True  0.70340
	2   True      False  0.01039
	3   True       True  0.29660

New List of Factors: 

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm Earthquake     prob
	0  False      False  0.98961
	1  False       True  0.70340
	2   True      False  0.01039
	3   True       True  0.29660

Eliminate variable: Earthquake

Factors to multiply containing variable: Earthquake

	  Earthquake  prob
	0       True  0.02
	1      False  0.98

	   Alarm Earthquake     prob
	0  False      False  0.98961
	1  False       True  0.70340
	2   True      False  0.01039
	3   True       True  0.29660

Result of multiplication: 

	   Alarm Earthquake      prob
	0  False       True  0.014068
	1   True       True  0.005932
	2  False      False  0.969818
	3   True      False  0.010182

Sum out Earthquake

	   Alarm      prob
	0  False  0.983886
	1   True  0.016114

New List of Factors: 

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm      prob
	0  False  0.983886
	1   True  0.016114

Eliminate variable: Alarm

Factors to multiply containing variable: Alarm

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm  prob
	0  False   1.0
	1   True   1.0

	   Alarm      prob
	0  False  0.983886
	1   True  0.016114

Result of multiplication: 

	   Alarm      prob
	0  False  0.983886
	1   True  0.016114
